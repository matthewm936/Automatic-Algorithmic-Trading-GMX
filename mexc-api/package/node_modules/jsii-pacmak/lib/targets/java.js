"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.JavaBuilder = void 0;
const spec = require("@jsii/spec");
const clone = require("clone");
const case_utils_1 = require("codemaker/lib/case-utils");
const fs = require("fs-extra");
const jsii_rosetta_1 = require("jsii-rosetta");
const path = require("path");
const xmlbuilder = require("xmlbuilder");
const generator_1 = require("../generator");
const logging = require("../logging");
const naming_util_1 = require("../naming-util");
const target_1 = require("../target");
const util_1 = require("../util");
const version_1 = require("../version");
const _utils_1 = require("./_utils");
const version_utils_1 = require("./version-utils");
const _1 = require(".");
// eslint-disable-next-line @typescript-eslint/no-var-requires,@typescript-eslint/no-require-imports
const spdxLicenseList = require('spdx-license-list');
const BUILDER_CLASS_NAME = 'Builder';
const ANN_NOT_NULL = '@org.jetbrains.annotations.NotNull';
const ANN_NULLABLE = '@org.jetbrains.annotations.Nullable';
const ANN_INTERNAL = '@software.amazon.jsii.Internal';
/**
 * Build Java packages all together, by generating an aggregate POM
 *
 * This will make the Java build a lot more efficient (~300%).
 *
 * Do this by copying the code into a temporary directory, generating an aggregate
 * POM there, and then copying the artifacts back into the respective output
 * directories.
 */
class JavaBuilder {
    constructor(modules, options) {
        this.modules = modules;
        this.options = options;
        this.targetName = 'java';
    }
    async buildModules() {
        if (this.modules.length === 0) {
            return;
        }
        if (this.options.codeOnly) {
            // Simple, just generate code to respective output dirs
            await Promise.all(this.modules.map((module) => this.generateModuleCode(module, this.options, this.outputDir(module.outputDirectory))));
            return;
        }
        // Otherwise make a single tempdir to hold all sources, build them together and copy them back out
        const scratchDirs = [];
        try {
            const tempSourceDir = await this.generateAggregateSourceDir(this.modules, this.options);
            scratchDirs.push(tempSourceDir);
            // Need any old module object to make a target to be able to invoke build, though none of its settings
            // will be used.
            const target = this.makeTarget(this.modules[0], this.options);
            const tempOutputDir = await util_1.Scratch.make(async (dir) => {
                logging.debug(`Building Java code to ${dir}`);
                await target.build(tempSourceDir.directory, dir);
            });
            scratchDirs.push(tempOutputDir);
            await this.copyOutArtifacts(tempOutputDir.directory, tempSourceDir.object);
            if (this.options.clean) {
                await util_1.Scratch.cleanupAll(scratchDirs);
            }
        }
        catch (e) {
            logging.warn(`Exception occurred, not cleaning up ${scratchDirs
                .map((s) => s.directory)
                .join(', ')}`);
            throw e;
        }
    }
    async generateModuleCode(module, options, where) {
        const target = this.makeTarget(module, options);
        logging.debug(`Generating Java code into ${where}`);
        await target.generateCode(where, module.tarball);
    }
    async generateAggregateSourceDir(modules, options) {
        return util_1.Scratch.make(async (tmpDir) => {
            logging.debug(`Generating aggregate Java source dir at ${tmpDir}`);
            const ret = [];
            const generatedModules = modules
                .map((module) => ({ module, relativeName: util_1.slugify(module.name) }))
                .map(({ module, relativeName }) => ({
                module,
                relativeName,
                sourceDir: path.join(tmpDir, relativeName),
            }))
                .map(({ module, relativeName, sourceDir }) => this.generateModuleCode(module, options, sourceDir).then(() => ({
                module,
                relativeName,
            })));
            for await (const { module, relativeName } of generatedModules) {
                ret.push({
                    relativeSourceDir: relativeName,
                    relativeArtifactsDir: moduleArtifactsSubdir(module),
                    outputTargetDirectory: module.outputDirectory,
                });
            }
            await this.generateAggregatePom(tmpDir, ret.map((m) => m.relativeSourceDir));
            await this.generateMavenSettingsForLocalDeps(tmpDir);
            return ret;
        });
    }
    async generateAggregatePom(where, moduleNames) {
        const aggregatePom = xmlbuilder
            .create({
            project: {
                '@xmlns': 'http://maven.apache.org/POM/4.0.0',
                '@xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance',
                '@xsi:schemaLocation': 'http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd',
                '#comment': [
                    `Generated by jsii-pacmak@${version_1.VERSION_DESC} on ${new Date().toISOString()}`,
                ],
                modelVersion: '4.0.0',
                packaging: 'pom',
                groupId: 'software.amazon.jsii',
                artifactId: 'aggregatepom',
                version: '1.0.0',
                modules: {
                    module: moduleNames,
                },
            },
        }, { encoding: 'UTF-8' })
            .end({ pretty: true });
        logging.debug(`Generated ${where}/pom.xml`);
        await fs.writeFile(path.join(where, 'pom.xml'), aggregatePom);
    }
    async copyOutArtifacts(artifactsRoot, packages) {
        logging.debug('Copying out Java artifacts');
        // The artifacts directory looks like this:
        //  /tmp/XXX/software/amazon/awscdk/something/v1.2.3
        //                                 /else/v1.2.3
        //                                 /entirely/v1.2.3
        //
        // We get the 'software/amazon/awscdk/something' path from the package, identifying
        // the files we need to copy, including Maven metadata. But we need to recreate
        // the whole path in the target directory.
        await Promise.all(packages.map(async (pkg) => {
            const artifactsSource = path.join(artifactsRoot, pkg.relativeArtifactsDir);
            const artifactsDest = path.join(this.outputDir(pkg.outputTargetDirectory), pkg.relativeArtifactsDir);
            await fs.mkdirp(artifactsDest);
            await fs.copy(artifactsSource, artifactsDest, { recursive: true });
        }));
    }
    /**
     * Decide whether or not to append 'java' to the given output directory
     */
    outputDir(declaredDir) {
        return this.options.languageSubdirectory
            ? path.join(declaredDir, this.targetName)
            : declaredDir;
    }
    /**
     * Generates maven settings file for this build.
     * @param where The generated sources directory. This is where user.xml will be placed.
     * @param currentOutputDirectory The current output directory. Will be added as a local maven repo.
     */
    async generateMavenSettingsForLocalDeps(where) {
        const filePath = path.join(where, 'user.xml');
        // traverse the dep graph of this module and find all modules that have
        // an <outdir>/java directory. we will add those as local maven
        // repositories which will resolve instead of Maven Central for those
        // module. this enables building against local modules (i.e. in lerna
        // repositories or linked modules).
        const allDepsOutputDirs = new Set();
        const resolvedModules = this.modules.map(async (mod) => ({
            module: mod,
            localBuildDirs: await target_1.findLocalBuildDirs(mod.moduleDirectory, this.targetName),
        }));
        for await (const { module, localBuildDirs } of resolvedModules) {
            util_1.setExtend(allDepsOutputDirs, localBuildDirs);
            // Also include output directory where we're building to, in case we build multiple packages into
            // the same output directory.
            allDepsOutputDirs.add(path.join(module.outputDirectory, this.options.languageSubdirectory ? this.targetName : ''));
        }
        const localRepos = Array.from(allDepsOutputDirs);
        // if java-runtime is checked-out and we can find a local repository,
        // add it to the list.
        const localJavaRuntime = await findJavaRuntimeLocalRepository();
        if (localJavaRuntime) {
            localRepos.push(localJavaRuntime);
        }
        logging.debug('local maven repos:', localRepos);
        const profileName = 'local-jsii-modules';
        const settings = xmlbuilder
            .create({
            settings: {
                '@xmlns': 'http://maven.apache.org/POM/4.0.0',
                '@xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance',
                '@xsi:schemaLocation': 'http://maven.apache.org/SETTINGS/1.0.0 https://maven.apache.org/xsd/settings-1.0.0.xsd',
                '#comment': [
                    `Generated by jsii-pacmak@${version_1.VERSION_DESC} on ${new Date().toISOString()}`,
                ],
                // Do *not* attempt to ask the user for stuff...
                interactiveMode: false,
                // Use a non-default local repository to isolate from cached artifacts...
                localRepository: path.resolve(where, '.m2', 'repository'),
                // Register locations of locally-sourced dependencies
                profiles: {
                    profile: {
                        id: profileName,
                        repositories: {
                            repository: localRepos.map((repo) => ({
                                id: repo.replace(/[\\/:"<>|?*]/g, '$'),
                                url: `file://${repo}`,
                            })),
                        },
                    },
                },
                activeProfiles: {
                    activeProfile: profileName,
                },
            },
        }, { encoding: 'UTF-8' })
            .end({ pretty: true });
        logging.debug(`Generated ${filePath}`);
        await fs.writeFile(filePath, settings);
        return filePath;
    }
    makeTarget(module, options) {
        return new Java({
            targetName: this.targetName,
            packageDir: module.moduleDirectory,
            assembly: module.assembly,
            fingerprint: options.fingerprint,
            force: options.force,
            arguments: options.arguments,
            rosetta: options.rosetta,
        });
    }
}
exports.JavaBuilder = JavaBuilder;
/**
 * Return the subdirectory of the output directory where the artifacts for this particular package are produced
 */
function moduleArtifactsSubdir(module) {
    const groupId = module.assembly.targets.java.maven.groupId;
    const artifactId = module.assembly.targets.java.maven.artifactId;
    return `${groupId.replace(/\./g, '/')}/${artifactId}`;
}
class Java extends target_1.Target {
    constructor(options) {
        super(options);
        this.generator = new JavaGenerator(options.rosetta);
    }
    static toPackageInfos(assm) {
        const groupId = assm.targets.java.maven.groupId;
        const artifactId = assm.targets.java.maven.artifactId;
        const releaseVersion = version_utils_1.toReleaseVersion(assm.version, _1.TargetName.JAVA);
        const url = `https://repo1.maven.org/maven2/${groupId.replace(/\./g, '/')}/${artifactId}/${assm.version}/`;
        return {
            java: {
                repository: 'Maven Central',
                url,
                usage: {
                    'Apache Maven': {
                        language: 'xml',
                        code: xmlbuilder
                            .create({
                            dependency: { groupId, artifactId, version: releaseVersion },
                        })
                            .end({ pretty: true })
                            .replace(/<\?\s*xml(\s[^>]+)?>\s*/m, ''),
                    },
                    'Apache Buildr': `'${groupId}:${artifactId}:jar:${releaseVersion}'`,
                    'Apache Ivy': {
                        language: 'xml',
                        code: xmlbuilder
                            .create({
                            dependency: {
                                '@groupId': groupId,
                                '@name': artifactId,
                                '@rev': releaseVersion,
                            },
                        })
                            .end({ pretty: true })
                            .replace(/<\?\s*xml(\s[^>]+)?>\s*/m, ''),
                    },
                    'Groovy Grape': `@Grapes(\n@Grab(group='${groupId}', module='${artifactId}', version='${releaseVersion}')\n)`,
                    'Gradle / Grails': `compile '${groupId}:${artifactId}:${releaseVersion}'`,
                },
            },
        };
    }
    static toNativeReference(type, options) {
        const [, ...name] = type.fqn.split('.');
        return { java: `import ${[options.package, ...name].join('.')};` };
    }
    async build(sourceDir, outDir) {
        var _a;
        const url = `file://${outDir}`;
        const mvnArguments = new Array();
        for (const arg of Object.keys(this.arguments)) {
            if (!arg.startsWith('mvn-')) {
                continue;
            }
            mvnArguments.push(`--${arg.slice(4)}`);
            mvnArguments.push(this.arguments[arg].toString());
        }
        await util_1.shell('mvn', [
            // If we don't run in verbose mode, turn on quiet mode
            ...(this.arguments.verbose ? [] : ['--quiet']),
            '--batch-mode',
            ...mvnArguments,
            'deploy',
            `-D=altDeploymentRepository=local::default::${url}`,
            '--settings=user.xml',
        ], {
            cwd: sourceDir,
            env: {
                // Twiddle the JVM settings a little for Maven. Delaying JIT compilation
                // brings down Maven execution time by about 1/3rd (15->10s, 30->20s)
                MAVEN_OPTS: `${(_a = process.env.MAVEN_OPTS) !== null && _a !== void 0 ? _a : ''} -XX:+TieredCompilation -XX:TieredStopAtLevel=1`,
            },
            retry: { maxAttempts: 5 },
        });
    }
}
exports.default = Java;
// ##################
// # CODE GENERATOR #
// ##################
const MODULE_CLASS_NAME = '$Module';
const INTERFACE_PROXY_CLASS_NAME = 'Jsii$Proxy';
const INTERFACE_DEFAULT_CLASS_NAME = 'Jsii$Default';
class JavaGenerator extends generator_1.Generator {
    constructor(rosetta) {
        super({ generateOverloadsForMethodWithOptionals: true });
        this.rosetta = rosetta;
        /**
         * A map of all the modules ever referenced during code generation. These include
         * direct dependencies but can potentially also include transitive dependencies, when,
         * for example, we need to refer to their types when flatting the class hierarchy for
         * interface proxies.
         */
        this.referencedModules = {};
    }
    /**
     * Turns a raw javascript property name (eg: 'default') into a safe Java property name (eg: 'defaultValue').
     * @param propertyName the raw JSII property Name
     */
    static safeJavaPropertyName(propertyName) {
        if (!propertyName) {
            return propertyName;
        }
        if (JavaGenerator.RESERVED_KEYWORDS.includes(propertyName)) {
            return `${propertyName}Value`;
        }
        return propertyName;
    }
    /**
     * Turns a raw javascript method name (eg: 'import') into a safe Java method name (eg: 'doImport').
     * @param methodName
     */
    static safeJavaMethodName(methodName) {
        if (!methodName) {
            return methodName;
        }
        if (JavaGenerator.RESERVED_KEYWORDS.includes(methodName)) {
            return `do${naming_util_1.jsiiToPascalCase(methodName)}`;
        }
        return methodName;
    }
    onBeginAssembly(assm, fingerprint) {
        this.emitFullGeneratorInfo = fingerprint;
        this.moduleClass = this.emitModuleFile(assm);
        this.emitAssemblyPackageInfo(assm);
    }
    onEndAssembly(assm, fingerprint) {
        this.emitMavenPom(assm, fingerprint);
        delete this.emitFullGeneratorInfo;
    }
    getAssemblyOutputDir(mod) {
        const dir = this.toNativeFqn(mod.name).replace(/\./g, '/');
        return path.join('src', 'main', 'resources', dir);
    }
    onBeginClass(cls, abstract) {
        var _a, _b;
        this.openFileIfNeeded(cls);
        this.addJavaDocs(cls, { api: 'type', fqn: cls.fqn });
        const classBase = this.getClassBase(cls);
        const extendsExpression = classBase ? ` extends ${classBase}` : '';
        let implementsExpr = '';
        if ((_b = (_a = cls.interfaces) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0 > 0) {
            implementsExpr = ` implements ${cls
                .interfaces.map((x) => this.toNativeFqn(x))
                .join(', ')}`;
        }
        const nested = this.isNested(cls);
        const inner = nested ? ' static' : '';
        const absPrefix = abstract ? ' abstract' : '';
        if (!nested) {
            this.emitGeneratedAnnotation();
        }
        this.emitStabilityAnnotations(cls);
        this.code.line(`@software.amazon.jsii.Jsii(module = ${this.moduleClass}.class, fqn = "${cls.fqn}")`);
        this.code.openBlock(`public${inner}${absPrefix} class ${cls.name}${extendsExpression}${implementsExpr}`);
        this.emitJsiiInitializers(cls);
        this.emitStaticInitializer(cls);
    }
    onEndClass(cls) {
        if (cls.abstract) {
            const type = this.reflectAssembly.findType(cls.fqn);
            this.emitProxy(type);
        }
        else {
            this.emitClassBuilder(cls);
        }
        this.code.closeBlock();
        this.closeFileIfNeeded(cls);
    }
    onInitializer(cls, method) {
        this.code.line();
        // If needed, patching up the documentation to point users at the builder pattern
        this.addJavaDocs(method, { api: 'initializer', fqn: cls.fqn });
        this.emitStabilityAnnotations(method);
        // Abstract classes should have protected initializers
        const initializerAccessLevel = cls.abstract
            ? 'protected'
            : this.renderAccessLevel(method);
        this.code.openBlock(`${initializerAccessLevel} ${cls.name}(${this.renderMethodParameters(method)})`);
        this.code.line('super(software.amazon.jsii.JsiiObject.InitializationMode.JSII);');
        this.code.line(`software.amazon.jsii.JsiiEngine.getInstance().createNewObject(this${this.renderMethodCallArguments(method)});`);
        this.code.closeBlock();
    }
    onInitializerOverload(cls, overload, _originalInitializer) {
        this.onInitializer(cls, overload);
    }
    onField(_cls, _prop, _union) {
        /* noop */
    }
    onProperty(cls, prop) {
        this.emitProperty(cls, prop, cls);
    }
    onStaticProperty(cls, prop) {
        if (prop.const) {
            this.emitConstProperty(cls, prop);
        }
        else {
            this.emitProperty(cls, prop, cls);
        }
    }
    /**
     * Since we expand the union setters, we will use this event to only emit the getter which returns an Object.
     */
    onUnionProperty(cls, prop, _union) {
        this.emitProperty(cls, prop, cls);
    }
    onMethod(cls, method) {
        this.emitMethod(cls, method);
    }
    onMethodOverload(cls, overload, _originalMethod) {
        this.onMethod(cls, overload);
    }
    onStaticMethod(cls, method) {
        this.emitMethod(cls, method);
    }
    onStaticMethodOverload(cls, overload, _originalMethod) {
        this.emitMethod(cls, overload);
    }
    onBeginEnum(enm) {
        this.openFileIfNeeded(enm);
        this.addJavaDocs(enm, { api: 'type', fqn: enm.fqn });
        if (!this.isNested(enm)) {
            this.emitGeneratedAnnotation();
        }
        this.emitStabilityAnnotations(enm);
        this.code.line(`@software.amazon.jsii.Jsii(module = ${this.moduleClass}.class, fqn = "${enm.fqn}")`);
        this.code.openBlock(`public enum ${enm.name}`);
    }
    onEndEnum(enm) {
        this.code.closeBlock();
        this.closeFileIfNeeded(enm);
    }
    onEnumMember(parentType, member) {
        this.addJavaDocs(member, {
            api: 'member',
            fqn: parentType.fqn,
            memberName: member.name,
        });
        this.emitStabilityAnnotations(member);
        this.code.line(`${member.name},`);
    }
    /**
     * Namespaces are handled implicitly by onBeginClass().
     *
     * Only emit package-info in case this is a submodule
     */
    onBeginNamespace(ns) {
        var _a;
        const submodule = (_a = this.assembly.submodules) === null || _a === void 0 ? void 0 : _a[ns];
        if (submodule) {
            this.emitSubmodulePackageInfo(this.assembly, ns);
        }
    }
    onEndNamespace(_ns) {
        /* noop */
    }
    onBeginInterface(ifc) {
        var _a;
        this.openFileIfNeeded(ifc);
        this.addJavaDocs(ifc, { api: 'type', fqn: ifc.fqn });
        // all interfaces always extend JsiiInterface so we can identify that it is a jsii interface.
        const interfaces = (_a = ifc.interfaces) !== null && _a !== void 0 ? _a : [];
        const bases = [
            'software.amazon.jsii.JsiiSerializable',
            ...interfaces.map((x) => this.toNativeFqn(x)),
        ].join(', ');
        const nested = this.isNested(ifc);
        const inner = nested ? ' static' : '';
        if (!nested) {
            this.emitGeneratedAnnotation();
        }
        this.code.line(`@software.amazon.jsii.Jsii(module = ${this.moduleClass}.class, fqn = "${ifc.fqn}")`);
        this.code.line(`@software.amazon.jsii.Jsii.Proxy(${ifc.name}.${INTERFACE_PROXY_CLASS_NAME}.class)`);
        this.emitStabilityAnnotations(ifc);
        this.code.openBlock(`public${inner} interface ${ifc.name} extends ${bases}`);
    }
    onEndInterface(ifc) {
        this.emitMultiplyInheritedOptionalProperties(ifc);
        if (ifc.datatype) {
            this.emitDataType(ifc);
        }
        else {
            const type = this.reflectAssembly.findType(ifc.fqn);
            this.emitProxy(type);
            // We don't emit Jsii$Default if the assembly opted out of it explicitly.
            // This is mostly to facilitate compatibility testing...
            if (hasDefaultInterfaces(this.reflectAssembly)) {
                this.emitDefaultImplementation(type);
            }
        }
        this.code.closeBlock();
        this.closeFileIfNeeded(ifc);
    }
    onInterfaceMethod(ifc, method) {
        this.code.line();
        const returnType = method.returns
            ? this.toDecoratedJavaType(method.returns)
            : 'void';
        this.addJavaDocs(method, {
            api: 'member',
            fqn: ifc.fqn,
            memberName: method.name,
        });
        this.emitStabilityAnnotations(method);
        this.code.line(`${returnType} ${method.name}(${this.renderMethodParameters(method)});`);
    }
    onInterfaceMethodOverload(ifc, overload, _originalMethod) {
        this.onInterfaceMethod(ifc, overload);
    }
    onInterfaceProperty(ifc, prop) {
        const getterType = this.toDecoratedJavaType(prop);
        const propName = naming_util_1.jsiiToPascalCase(JavaGenerator.safeJavaPropertyName(prop.name));
        // for unions we only generate overloads for setters, not getters.
        this.code.line();
        this.addJavaDocs(prop, {
            api: 'member',
            fqn: ifc.fqn,
            memberName: prop.name,
        });
        this.emitStabilityAnnotations(prop);
        if (prop.optional) {
            if (prop.overrides) {
                this.code.line('@Override');
            }
            this.code.openBlock(`default ${getterType} get${propName}()`);
            this.code.line('return null;');
            this.code.closeBlock();
        }
        else {
            this.code.line(`${getterType} get${propName}();`);
        }
        if (!prop.immutable) {
            const setterTypes = this.toDecoratedJavaTypes(prop);
            for (const type of setterTypes) {
                this.code.line();
                this.addJavaDocs(prop, {
                    api: 'member',
                    fqn: ifc.fqn,
                    memberName: prop.name,
                });
                if (prop.optional) {
                    if (prop.overrides) {
                        this.code.line('@Override');
                    }
                    this.code.line('@software.amazon.jsii.Optional');
                    this.code.openBlock(`default void set${propName}(final ${type} value)`);
                    this.code.line(`throw new UnsupportedOperationException("'void " + getClass().getCanonicalName() + "#set${propName}(${type})' is not implemented!");`);
                    this.code.closeBlock();
                }
                else {
                    this.code.line(`void set${propName}(final ${type} value);`);
                }
            }
        }
    }
    /**
     * Emits a local default implementation for optional properties inherited from
     * multiple distinct parent types. This remvoes the default method dispatch
     * ambiguity that would otherwise exist.
     *
     * @param ifc            the interface to be processed.
  
     *
     * @see https://github.com/aws/jsii/issues/2256
     */
    emitMultiplyInheritedOptionalProperties(ifc) {
        var _a, _b;
        if (ifc.interfaces == null || ifc.interfaces.length <= 1) {
            // Nothing to do if we don't have parent interfaces, or if we have exactly one
            return;
        }
        const inheritedOptionalProps = ifc.interfaces
            .map(allOptionalProps.bind(this))
            // Calculate how many direct parents brought a given optional property
            .reduce((histogram, entry) => {
            var _a;
            for (const [name, spec] of Object.entries(entry)) {
                histogram[name] = (_a = histogram[name]) !== null && _a !== void 0 ? _a : { spec, count: 0 };
                histogram[name].count += 1;
            }
            return histogram;
        }, {});
        const localProps = new Set((_b = (_a = ifc.properties) === null || _a === void 0 ? void 0 : _a.map((prop) => prop.name)) !== null && _b !== void 0 ? _b : []);
        for (const { spec, count } of Object.values(inheritedOptionalProps)) {
            if (count < 2 || localProps.has(spec.name)) {
                continue;
            }
            this.onInterfaceProperty(ifc, spec);
        }
        function allOptionalProps(fqn) {
            var _a, _b;
            const type = this.findType(fqn);
            const result = {};
            for (const prop of (_a = type.properties) !== null && _a !== void 0 ? _a : []) {
                // Adding artifical "overrides" here for code-gen quality's sake.
                result[prop.name] = { ...prop, overrides: type.fqn };
            }
            // Include optional properties of all super interfaces in the result
            for (const base of (_b = type.interfaces) !== null && _b !== void 0 ? _b : []) {
                for (const [name, prop] of Object.entries(allOptionalProps.call(this, base))) {
                    if (!(name in result)) {
                        result[name] = prop;
                    }
                }
            }
            return result;
        }
    }
    emitAssemblyPackageInfo(mod) {
        if (!mod.docs) {
            return;
        }
        const { packageName } = this.toNativeName(mod);
        const packageInfoFile = this.toJavaFilePath(mod, `${mod.name}.package-info`);
        this.code.openFile(packageInfoFile);
        this.code.line('/**');
        if (mod.readme) {
            for (const line of jsii_rosetta_1.markDownToJavaDoc(this.convertSamplesInMarkdown(mod.readme.markdown, {
                api: 'moduleReadme',
                moduleFqn: mod.name,
            })).split('\n')) {
                this.code.line(` * ${line.replace(/\*\//g, '*{@literal /}')}`);
            }
        }
        if (mod.docs.deprecated) {
            this.code.line(' *');
            // Javac won't allow @deprecated on packages, while @Deprecated is aaaabsolutely fine. Duh.
            this.code.line(` * Deprecated: ${mod.docs.deprecated}`);
        }
        this.code.line(' */');
        this.emitStabilityAnnotations(mod);
        this.code.line(`package ${packageName};`);
        this.code.closeFile(packageInfoFile);
    }
    emitSubmodulePackageInfo(assembly, moduleFqn) {
        var _a, _b;
        const mod = (_a = assembly.submodules) === null || _a === void 0 ? void 0 : _a[moduleFqn];
        if (!((_b = mod === null || mod === void 0 ? void 0 : mod.readme) === null || _b === void 0 ? void 0 : _b.markdown)) {
            return;
        }
        const { packageName } = translateFqn(assembly, moduleFqn);
        const packageInfoFile = this.toJavaFilePath(assembly, `${moduleFqn}.package-info`);
        this.code.openFile(packageInfoFile);
        this.code.line('/**');
        if (mod.readme) {
            for (const line of jsii_rosetta_1.markDownToJavaDoc(this.convertSamplesInMarkdown(mod.readme.markdown, {
                api: 'moduleReadme',
                moduleFqn,
            })).split('\n')) {
                this.code.line(` * ${line.replace(/\*\//g, '*{@literal /}')}`);
            }
        }
        this.code.line(' */');
        this.code.line(`package ${packageName};`);
        this.code.closeFile(packageInfoFile);
    }
    emitMavenPom(assm, fingerprint) {
        var _a;
        if (!((_a = assm.targets) === null || _a === void 0 ? void 0 : _a.java)) {
            throw new Error(`Assembly ${assm.name} does not declare a java target`);
        }
        const comment = fingerprint
            ? {
                '#comment': [
                    `Generated by jsii-pacmak@${version_1.VERSION_DESC} on ${new Date().toISOString()}`,
                    `@jsii-pacmak:meta@ ${JSON.stringify(this.metadata)}`,
                ],
            }
            : {};
        this.code.openFile('pom.xml');
        this.code.line(xmlbuilder
            .create({
            project: {
                '@xmlns': 'http://maven.apache.org/POM/4.0.0',
                '@xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance',
                '@xsi:schemaLocation': 'http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd',
                ...comment,
                modelVersion: '4.0.0',
                name: '${project.groupId}:${project.artifactId}',
                description: assm.description,
                url: assm.homepage,
                licenses: {
                    license: getLicense(),
                },
                developers: {
                    developer: mavenDevelopers(),
                },
                scm: {
                    connection: `scm:${assm.repository.type}:${assm.repository.url}`,
                    url: assm.repository.url,
                },
                groupId: assm.targets.java.maven.groupId,
                artifactId: assm.targets.java.maven.artifactId,
                version: makeVersion(assm.version, assm.targets.java.maven.versionSuffix),
                packaging: 'jar',
                properties: { 'project.build.sourceEncoding': 'UTF-8' },
                dependencies: { dependency: mavenDependencies.call(this) },
                build: {
                    plugins: {
                        plugin: [
                            {
                                groupId: 'org.apache.maven.plugins',
                                artifactId: 'maven-compiler-plugin',
                                version: '3.8.1',
                                configuration: { source: '1.8', target: '1.8' },
                            },
                            {
                                groupId: 'org.apache.maven.plugins',
                                artifactId: 'maven-jar-plugin',
                                version: '3.2.0',
                                configuration: {
                                    archive: {
                                        index: true,
                                        manifest: {
                                            addDefaultImplementationEntries: true,
                                            addDefaultSpecificationEntries: true,
                                        },
                                    },
                                },
                            },
                            {
                                groupId: 'org.apache.maven.plugins',
                                artifactId: 'maven-source-plugin',
                                version: '3.2.1',
                                executions: {
                                    execution: {
                                        id: 'attach-sources',
                                        goals: { goal: 'jar' },
                                    },
                                },
                            },
                            {
                                groupId: 'org.apache.maven.plugins',
                                artifactId: 'maven-javadoc-plugin',
                                version: '3.2.0',
                                executions: {
                                    execution: {
                                        id: 'attach-javadocs',
                                        goals: { goal: 'jar' },
                                    },
                                },
                                configuration: {
                                    failOnError: false,
                                    show: 'protected',
                                    sourceFileExcludes: {
                                        // Excluding the $Module classes so they won't pollute the docsite. They otherwise
                                        // are all collected at the top of the classlist, burrying useful information under
                                        // a lot of dry scrolling.
                                        exclude: ['**/$Module.java'],
                                    },
                                    // Adding these makes JavaDoc generation about a 3rd faster (which is far and away the most
                                    // expensive part of the build)
                                    additionalJOption: [
                                        '-J-XX:+TieredCompilation',
                                        '-J-XX:TieredStopAtLevel=1',
                                    ],
                                },
                            },
                            {
                                groupId: 'org.apache.maven.plugins',
                                artifactId: 'maven-enforcer-plugin',
                                version: '3.0.0-M3',
                                executions: {
                                    execution: {
                                        id: 'enforce-maven',
                                        goals: { goal: 'enforce' },
                                        configuration: {
                                            rules: {
                                                requireMavenVersion: { version: '3.6' },
                                            },
                                        },
                                    },
                                },
                            },
                            {
                                groupId: 'org.codehaus.mojo',
                                artifactId: 'versions-maven-plugin',
                                version: '2.8.1',
                                configuration: {
                                    generateBackupPoms: false,
                                },
                            },
                        ],
                    },
                },
            },
        }, { encoding: 'UTF-8' })
            .end({ pretty: true }));
        this.code.closeFile('pom.xml');
        /**
         * Combines a version number with an optional suffix. The suffix, when present, must begin with
         * '-' or '.', and will be concatenated as-is to the version number..
         *
         * @param version the semantic version number
         * @param suffix  the suffix, if any.
         */
        function makeVersion(version, suffix) {
            if (!suffix) {
                return version_utils_1.toReleaseVersion(version, _1.TargetName.JAVA);
            }
            if (!suffix.startsWith('-') && !suffix.startsWith('.')) {
                throw new Error(`versionSuffix must start with '-' or '.', but received ${suffix}`);
            }
            return `${version}${suffix}`;
        }
        function mavenDependencies() {
            var _a, _b, _c;
            const dependencies = new Array();
            for (const [depName, version] of Object.entries((_a = this.assembly.dependencies) !== null && _a !== void 0 ? _a : {})) {
                const dep = (_b = this.assembly.dependencyClosure) === null || _b === void 0 ? void 0 : _b[depName];
                if (!((_c = dep === null || dep === void 0 ? void 0 : dep.targets) === null || _c === void 0 ? void 0 : _c.java)) {
                    throw new Error(`Assembly ${assm.name} depends on ${depName}, which does not declare a java target`);
                }
                dependencies.push({
                    groupId: dep.targets.java.maven.groupId,
                    artifactId: dep.targets.java.maven.artifactId,
                    version: version_utils_1.toMavenVersionRange(version, dep.targets.java.maven.versionSuffix),
                });
            }
            // The JSII java runtime base classes
            dependencies.push({
                groupId: 'software.amazon.jsii',
                artifactId: 'jsii-runtime',
                version: version_utils_1.toMavenVersionRange(`^${version_1.VERSION}`),
            });
            // Provides @org.jetbrains.*
            dependencies.push({
                groupId: 'org.jetbrains',
                artifactId: 'annotations',
                version: '[16.0.3,20.0.0)',
            });
            // Provides @javax.annotation.Generated for JDKs >= 9
            dependencies.push({
                '#comment': 'Provides @javax.annotation.Generated for JDKs >= 9',
                groupId: 'javax.annotation',
                artifactId: 'javax.annotation-api',
                version: '[1.3.2,1.4.0)',
                scope: 'compile',
            });
            return dependencies;
        }
        function mavenDevelopers() {
            var _a;
            return [assm.author, ...((_a = assm.contributors) !== null && _a !== void 0 ? _a : [])].map(toDeveloper);
            function toDeveloper(person) {
                const developer = {
                    [person.organization ? 'organization' : 'name']: person.name,
                    roles: { role: person.roles },
                };
                // We cannot set "undefined" or "null" to a field - this causes invalid XML to be emitted (per POM schema).
                if (person.email) {
                    developer.email = person.email;
                }
                if (person.url) {
                    developer[person.organization ? 'organizationUrl' : 'url'] =
                        person.url;
                }
                return developer;
            }
        }
        /**
         * Get the maven-style license block for a the assembly.
         * @see https://maven.apache.org/pom.html#Licenses
         */
        function getLicense() {
            const spdx = spdxLicenseList[assm.license];
            return (spdx && {
                name: spdx.name,
                url: spdx.url,
                distribution: 'repo',
                comments: spdx.osiApproved ? 'An OSI-approved license' : undefined,
            });
        }
    }
    emitStaticInitializer(cls) {
        var _a;
        const consts = ((_a = cls.properties) !== null && _a !== void 0 ? _a : []).filter((x) => x.const);
        if (consts.length === 0) {
            return;
        }
        const javaClass = this.toJavaType(cls);
        this.code.line();
        this.code.openBlock('static');
        for (const prop of consts) {
            const constName = this.renderConstName(prop);
            const propType = this.toNativeType(prop.type, { forMarshalling: true });
            const statement = `software.amazon.jsii.JsiiObject.jsiiStaticGet(${javaClass}.class, "${prop.name}", ${propType})`;
            this.code.line(`${constName} = ${this.wrapCollection(statement, prop.type, prop.optional)};`);
        }
        this.code.closeBlock();
    }
    renderConstName(prop) {
        return this.code.toSnakeCase(prop.name).toLocaleUpperCase(); // java consts are SNAKE_UPPER_CASE
    }
    emitConstProperty(parentType, prop) {
        const propType = this.toJavaType(prop.type);
        const propName = this.renderConstName(prop);
        const access = this.renderAccessLevel(prop);
        this.code.line();
        this.addJavaDocs(prop, {
            api: 'member',
            fqn: parentType.fqn,
            memberName: prop.name,
        });
        this.emitStabilityAnnotations(prop);
        this.code.line(`${access} final static ${propType} ${propName};`);
    }
    emitProperty(cls, prop, definingType, { defaultImpl = false, final = false, includeGetter = true, overrides = !!prop.overrides, } = {}) {
        const getterType = this.toDecoratedJavaType(prop);
        const setterTypes = this.toDecoratedJavaTypes(prop, {
            covariant: prop.static,
        });
        const propName = naming_util_1.jsiiToPascalCase(JavaGenerator.safeJavaPropertyName(prop.name));
        const modifiers = [defaultImpl ? 'default' : this.renderAccessLevel(prop)];
        if (prop.static)
            modifiers.push('static');
        if (prop.abstract && !defaultImpl)
            modifiers.push('abstract');
        if (final && !prop.abstract && !defaultImpl)
            modifiers.push('final');
        const javaClass = this.toJavaType(cls);
        // for unions we only generate overloads for setters, not getters.
        if (includeGetter) {
            this.code.line();
            this.addJavaDocs(prop, {
                api: 'member',
                fqn: definingType.fqn,
                memberName: prop.name,
            });
            if (overrides && !prop.static) {
                this.code.line('@Override');
            }
            this.emitStabilityAnnotations(prop);
            const signature = `${modifiers.join(' ')} ${getterType} get${propName}()`;
            if (prop.abstract && !defaultImpl) {
                this.code.line(`${signature};`);
            }
            else {
                this.code.openBlock(signature);
                let statement;
                if (prop.static) {
                    statement = `software.amazon.jsii.JsiiObject.jsiiStaticGet(${this.toJavaType(cls)}.class, `;
                }
                else {
                    statement = 'software.amazon.jsii.Kernel.get(this, ';
                }
                statement += `"${prop.name}", ${this.toNativeType(prop.type, {
                    forMarshalling: true,
                })})`;
                this.code.line(`return ${this.wrapCollection(statement, prop.type, prop.optional)};`);
                this.code.closeBlock();
            }
        }
        if (!prop.immutable) {
            for (const type of setterTypes) {
                this.code.line();
                this.addJavaDocs(prop, {
                    api: 'member',
                    fqn: cls.fqn,
                    memberName: prop.name,
                });
                if (overrides && !prop.static) {
                    this.code.line('@Override');
                }
                this.emitStabilityAnnotations(prop);
                const signature = `${modifiers.join(' ')} void set${propName}(final ${type} value)`;
                if (prop.abstract && !defaultImpl) {
                    this.code.line(`${signature};`);
                }
                else {
                    this.code.openBlock(signature);
                    let statement = '';
                    if (prop.static) {
                        statement += `software.amazon.jsii.JsiiObject.jsiiStaticSet(${javaClass}.class, `;
                    }
                    else {
                        statement += 'software.amazon.jsii.Kernel.set(this, ';
                    }
                    const value = prop.optional
                        ? 'value'
                        : `java.util.Objects.requireNonNull(value, "${prop.name} is required")`;
                    statement += `"${prop.name}", ${value});`;
                    this.code.line(statement);
                    this.code.closeBlock();
                }
            }
        }
    }
    emitMethod(cls, method, { defaultImpl = false, final = false, overrides = !!method.overrides, } = {}) {
        const returnType = method.returns
            ? this.toDecoratedJavaType(method.returns)
            : 'void';
        const modifiers = [
            defaultImpl ? 'default' : this.renderAccessLevel(method),
        ];
        if (method.static)
            modifiers.push('static');
        if (method.abstract && !defaultImpl)
            modifiers.push('abstract');
        if (final && !method.abstract && !defaultImpl)
            modifiers.push('final');
        const async = !!method.async;
        const methodName = JavaGenerator.safeJavaMethodName(method.name);
        const signature = `${returnType} ${methodName}(${this.renderMethodParameters(method)})`;
        this.code.line();
        this.addJavaDocs(method, {
            api: 'member',
            fqn: cls.fqn,
            memberName: method.name,
        });
        this.emitStabilityAnnotations(method);
        if (overrides && !method.static) {
            this.code.line('@Override');
        }
        if (method.abstract && !defaultImpl) {
            this.code.line(`${modifiers.join(' ')} ${signature};`);
        }
        else {
            this.code.openBlock(`${modifiers.join(' ')} ${signature}`);
            this.code.line(this.renderMethodCall(cls, method, async));
            this.code.closeBlock();
        }
    }
    /**
     * We are now going to build a class that can be used as a proxy for untyped
     * javascript objects that implement this interface. we want java code to be
     * able to interact with them, so we will create a proxy class which
     * implements this interface and has the same methods.
     *
     * These proxies are also used to extend abstract classes to allow the JSII
     * engine to instantiate an abstract class in Java.
     */
    emitProxy(type) {
        const name = INTERFACE_PROXY_CLASS_NAME;
        this.code.line();
        this.code.line('/**');
        this.code.line(' * A proxy class which represents a concrete javascript instance of this type.');
        this.code.line(' */');
        const baseInterfaces = this.defaultInterfacesFor(type, {
            includeThisType: true,
        });
        if (type.isInterfaceType() && !hasDefaultInterfaces(type.assembly)) {
            // Extend this interface directly since this module does not have the Jsii$Default
            baseInterfaces.push(this.toNativeFqn(type.fqn));
        }
        const suffix = type.isInterfaceType()
            ? `extends software.amazon.jsii.JsiiObject implements ${baseInterfaces.join(', ')}`
            : `extends ${this.toNativeFqn(type.fqn)}${baseInterfaces.length > 0
                ? ` implements ${baseInterfaces.join(', ')}`
                : ''}`;
        const modifiers = type.isInterfaceType() ? 'final' : 'private static final';
        this.code.line(ANN_INTERNAL);
        this.code.openBlock(`${modifiers} class ${name} ${suffix}`);
        this.code.openBlock(`protected ${name}(final software.amazon.jsii.JsiiObjectRef objRef)`);
        this.code.line('super(objRef);');
        this.code.closeBlock();
        // emit all properties
        for (const reflectProp of type.allProperties.filter((prop) => prop.abstract &&
            (prop.parentType.fqn === type.fqn ||
                prop.parentType.isClassType() ||
                !hasDefaultInterfaces(prop.assembly)))) {
            const prop = clone(reflectProp.spec);
            prop.abstract = false;
            // Emitting "final" since this is a proxy and nothing will/should override this
            this.emitProperty(type.spec, prop, reflectProp.definingType.spec, {
                final: true,
                overrides: true,
            });
        }
        // emit all the methods
        for (const reflectMethod of type.allMethods.filter((method) => method.abstract &&
            (method.parentType.fqn === type.fqn ||
                method.parentType.isClassType() ||
                !hasDefaultInterfaces(method.assembly)))) {
            const method = clone(reflectMethod.spec);
            method.abstract = false;
            // Emitting "final" since this is a proxy and nothing will/should override this
            this.emitMethod(type.spec, method, { final: true, overrides: true });
            for (const overloadedMethod of this.createOverloadsForOptionals(method)) {
                overloadedMethod.abstract = false;
                this.emitMethod(type.spec, overloadedMethod, {
                    final: true,
                    overrides: true,
                });
            }
        }
        this.code.closeBlock();
    }
    emitDefaultImplementation(type) {
        const baseInterfaces = [type.name, ...this.defaultInterfacesFor(type)];
        this.code.line();
        this.code.line('/**');
        this.code.line(` * Internal default implementation for {@link ${type.name}}.`);
        this.code.line(' */');
        this.code.line(ANN_INTERNAL);
        this.code.openBlock(`interface ${INTERFACE_DEFAULT_CLASS_NAME} extends ${baseInterfaces
            .sort()
            .join(', ')}`);
        for (const property of type.allProperties.filter((prop) => prop.abstract &&
            // Only checking the getter - java.lang.Object has no setters.
            !isJavaLangObjectMethodName(`get${naming_util_1.jsiiToPascalCase(prop.name)}`) &&
            (prop.parentType.fqn === type.fqn ||
                !hasDefaultInterfaces(prop.assembly)))) {
            this.emitProperty(type.spec, property.spec, property.definingType.spec, {
                defaultImpl: true,
                overrides: type.isInterfaceType(),
            });
        }
        for (const method of type.allMethods.filter((method) => method.abstract &&
            !isJavaLangObjectMethodName(method.name) &&
            (method.parentType.fqn === type.fqn ||
                !hasDefaultInterfaces(method.assembly)))) {
            this.emitMethod(type.spec, method.spec, {
                defaultImpl: true,
                overrides: type.isInterfaceType(),
            });
        }
        this.code.closeBlock();
    }
    emitStabilityAnnotations(entity) {
        if (!entity.docs) {
            return;
        }
        if (entity.docs.stability) {
            this.code.line(`@software.amazon.jsii.Stability(software.amazon.jsii.Stability.Level.${_level(entity.docs.stability)})`);
        }
        if (entity.docs.stability === spec.Stability.Deprecated ||
            entity.docs.deprecated) {
            this.code.line('@Deprecated');
        }
        function _level(stability) {
            switch (stability) {
                case spec.Stability.Deprecated:
                    return 'Deprecated';
                case spec.Stability.Experimental:
                    return 'Experimental';
                case spec.Stability.External:
                    // Rendering 'External' out as publicly visible state is confusing. As far
                    // as users are concerned we just advertise this as stable.
                    return 'Stable';
                case spec.Stability.Stable:
                    return 'Stable';
                default:
                    throw new Error(`Unexpected stability: ${stability}`);
            }
        }
    }
    toJavaProp(property, definingType, inherited) {
        var _a;
        const safeName = JavaGenerator.safeJavaPropertyName(property.name);
        const propName = naming_util_1.jsiiToPascalCase(safeName);
        return {
            docs: property.docs,
            spec: property,
            definingType,
            propName,
            jsiiName: property.name,
            nullable: !!property.optional,
            fieldName: this.code.toCamelCase(safeName),
            fieldJavaType: this.toJavaType(property.type),
            paramJavaType: this.toJavaType(property.type, { covariant: true }),
            fieldNativeType: this.toNativeType(property.type),
            fieldJavaClass: `${this.toJavaType(property.type, {
                forMarshalling: true,
            })}.class`,
            javaTypes: this.toJavaTypes(property.type, { covariant: true }),
            immutable: (_a = property.immutable) !== null && _a !== void 0 ? _a : false,
            inherited,
        };
    }
    emitClassBuilder(cls) {
        var _a, _b, _c, _d;
        // Not rendering if there is no initializer, or if the initializer is protected or variadic
        if (cls.initializer == null || cls.initializer.protected) {
            return;
        }
        // Not rendering if the initializer has no parameters
        if (cls.initializer.parameters == null) {
            return;
        }
        // Not rendering if there is a nested "Builder" class
        if (this.reflectAssembly.tryFindType(`${cls.fqn}.${BUILDER_CLASS_NAME}`) !=
            null) {
            return;
        }
        // Find the first struct parameter of the constructor (if any)
        const firstStruct = cls.initializer.parameters.find((param) => {
            if (!spec.isNamedTypeReference(param.type)) {
                return false;
            }
            const paramType = this.reflectAssembly.tryFindType(param.type.fqn);
            return paramType === null || paramType === void 0 ? void 0 : paramType.isDataType();
        });
        // Not rendering if there is no struct parameter
        if (firstStruct == null) {
            return;
        }
        const structType = this.reflectAssembly.findType(firstStruct.type.fqn);
        const structParamName = this.code.toCamelCase(JavaGenerator.safeJavaPropertyName(firstStruct.name));
        const structBuilder = `${this.toJavaType(firstStruct.type)}.${BUILDER_CLASS_NAME}`;
        const positionalParams = cls.initializer.parameters
            .filter((p) => p !== firstStruct)
            .map((param) => ({
            param,
            fieldName: this.code.toCamelCase(JavaGenerator.safeJavaPropertyName(param.name)),
            javaType: this.toJavaType(param.type),
        }));
        const builtType = this.toJavaType(cls);
        this.code.line();
        this.code.line('/**');
        // eslint-disable-next-line prettier/prettier
        this.code.line(` * ${_utils_1.stabilityPrefixFor(cls.initializer)}A fluent builder for {@link ${builtType}}.`);
        this.code.line(' */');
        this.emitStabilityAnnotations(cls.initializer);
        this.code.openBlock(`public static final class ${BUILDER_CLASS_NAME} implements software.amazon.jsii.Builder<${builtType}>`);
        // Static factory method(s)
        for (const params of computeOverrides(positionalParams)) {
            const dummyMethod = {
                docs: {
                    stability: (_b = (_a = cls.initializer.docs) === null || _a === void 0 ? void 0 : _a.stability) !== null && _b !== void 0 ? _b : (_c = cls.docs) === null || _c === void 0 ? void 0 : _c.stability,
                    returns: `a new instance of {@link ${BUILDER_CLASS_NAME}}.`,
                },
                name: 'create',
                parameters: params.map((param) => param.param),
            };
            this.addJavaDocs(dummyMethod, {
                api: 'member',
                fqn: cls.fqn,
                memberName: dummyMethod.name,
            });
            this.emitStabilityAnnotations(cls.initializer);
            this.code.openBlock(`public static ${BUILDER_CLASS_NAME} create(${params
                .map((param) => `final ${param.javaType}${param.param.variadic ? '...' : ''} ${param.fieldName}`)
                .join(', ')})`);
            this.code.line(`return new ${BUILDER_CLASS_NAME}(${positionalParams
                .map((param, idx) => (idx < params.length ? param.fieldName : 'null'))
                .join(', ')});`);
            this.code.closeBlock();
        }
        // Private properties
        this.code.line();
        for (const param of positionalParams) {
            this.code.line(`private final ${param.javaType}${param.param.variadic ? '[]' : ''} ${param.fieldName};`);
        }
        this.code.line(`private ${firstStruct.optional ? '' : 'final '}${structBuilder} ${structParamName};`);
        // Private constructor
        this.code.line();
        this.code.openBlock(`private ${BUILDER_CLASS_NAME}(${positionalParams
            .map((param) => `final ${param.javaType}${param.param.variadic ? '...' : ''} ${param.fieldName}`)
            .join(', ')})`);
        for (const param of positionalParams) {
            this.code.line(`this.${param.fieldName} = ${param.fieldName};`);
        }
        if (!firstStruct.optional) {
            this.code.line(`this.${structParamName} = new ${structBuilder}();`);
        }
        this.code.closeBlock();
        // Fields
        for (const prop of structType.allProperties) {
            const fieldName = this.code.toCamelCase(JavaGenerator.safeJavaPropertyName(prop.name));
            this.code.line();
            const setter = {
                name: fieldName,
                docs: {
                    ...prop.spec.docs,
                    stability: (_d = prop.spec.docs) === null || _d === void 0 ? void 0 : _d.stability,
                    returns: '{@code this}',
                },
                parameters: [
                    {
                        name: fieldName,
                        type: spec.CANONICAL_ANY,
                        docs: prop.spec.docs,
                    },
                ],
            };
            for (const javaType of this.toJavaTypes(prop.type.spec, {
                covariant: true,
            })) {
                this.addJavaDocs(setter, {
                    api: 'member',
                    fqn: prop.definingType.fqn,
                    memberName: prop.name,
                });
                this.emitStabilityAnnotations(prop.spec);
                this.code.openBlock(`public ${BUILDER_CLASS_NAME} ${fieldName}(final ${javaType} ${fieldName})`);
                this.code.line(`this.${structParamName}${firstStruct.optional ? '()' : ''}.${fieldName}(${fieldName});`);
                this.code.line('return this;');
                this.code.closeBlock();
            }
        }
        // Final build method
        this.code.line();
        this.code.line('/**');
        this.code.line(` * @returns a newly built instance of {@link ${builtType}}.`);
        this.code.line(' */');
        this.emitStabilityAnnotations(cls.initializer);
        this.code.line('@Override');
        this.code.openBlock(`public ${builtType} build()`);
        const params = cls.initializer.parameters.map((param) => {
            if (param === firstStruct) {
                return firstStruct.optional
                    ? `this.${structParamName} != null ? this.${structParamName}.build() : null`
                    : `this.${structParamName}.build()`;
            }
            return `this.${positionalParams.find((p) => param === p.param).fieldName}`;
        });
        this.code.indent(`return new ${builtType}(`);
        params.forEach((param, idx) => this.code.line(`${param}${idx < params.length - 1 ? ',' : ''}`));
        this.code.unindent(');');
        this.code.closeBlock();
        // Optional builder initialization
        if (firstStruct.optional) {
            this.code.line();
            this.code.openBlock(`private ${structBuilder} ${structParamName}()`);
            this.code.openBlock(`if (this.${structParamName} == null)`);
            this.code.line(`this.${structParamName} = new ${structBuilder}();`);
            this.code.closeBlock();
            this.code.line(`return this.${structParamName};`);
            this.code.closeBlock();
        }
        this.code.closeBlock();
    }
    emitBuilderSetter(prop, builderName, parentType) {
        var _a, _b, _c, _d;
        for (const type of prop.javaTypes) {
            this.code.line();
            this.code.line('/**');
            this.code.line(` * Sets the value of {@link ${parentType.name}#${getterFor(prop.fieldName)}}`);
            const summary = (_b = (_a = prop.docs) === null || _a === void 0 ? void 0 : _a.summary) !== null && _b !== void 0 ? _b : 'the value to be set';
            this.code.line(` * ${paramJavadoc(prop.fieldName, prop.nullable, summary)}`);
            if (((_c = prop.docs) === null || _c === void 0 ? void 0 : _c.remarks) != null) {
                const indent = ' '.repeat(7 + prop.fieldName.length);
                const remarks = jsii_rosetta_1.markDownToJavaDoc(this.convertSamplesInMarkdown(prop.docs.remarks, {
                    api: 'member',
                    fqn: prop.definingType.fqn,
                    memberName: prop.jsiiName,
                })).trimRight();
                for (const line of remarks.split('\n')) {
                    this.code.line(` * ${indent} ${line}`);
                }
            }
            this.code.line(' * @return {@code this}');
            if ((_d = prop.docs) === null || _d === void 0 ? void 0 : _d.deprecated) {
                this.code.line(` * @deprecated ${prop.docs.deprecated}`);
            }
            this.code.line(' */');
            this.emitStabilityAnnotations(prop.spec);
            // We add an explicit cast if both types are generic but they are not identical (one is covariant, the other isn't)
            const explicitCast = type.includes('<') &&
                prop.fieldJavaType.includes('<') &&
                type !== prop.fieldJavaType
                ? `(${prop.fieldJavaType})`
                : '';
            if (explicitCast !== '') {
                // We'll be doing a safe, but unchecked cast, so suppress that warning
                this.code.line('@SuppressWarnings("unchecked")');
            }
            this.code.openBlock(`public ${builderName} ${prop.fieldName}(${type} ${prop.fieldName})`);
            this.code.line(`this.${prop.fieldName} = ${explicitCast}${prop.fieldName};`);
            this.code.line('return this;');
            this.code.closeBlock();
        }
        function getterFor(fieldName) {
            const [first, ...rest] = fieldName;
            return `get${first.toUpperCase()}${rest.join('')}`;
        }
    }
    emitInterfaceBuilder(classSpec, constructorName, props) {
        // Start builder()
        this.code.line();
        this.code.line('/**');
        this.code.line(` * @return a {@link ${BUILDER_CLASS_NAME}} of {@link ${classSpec.name}}`);
        this.code.line(' */');
        this.emitStabilityAnnotations(classSpec);
        this.code.openBlock(`static ${BUILDER_CLASS_NAME} builder()`);
        this.code.line(`return new ${BUILDER_CLASS_NAME}();`);
        this.code.closeBlock();
        // End builder()
        // Start Builder
        this.code.line('/**');
        this.code.line(` * A builder for {@link ${classSpec.name}}`);
        this.code.line(' */');
        this.emitStabilityAnnotations(classSpec);
        this.code.openBlock(`public static final class ${BUILDER_CLASS_NAME} implements software.amazon.jsii.Builder<${classSpec.name}>`);
        props.forEach((prop) => this.code.line(`${prop.fieldJavaType} ${prop.fieldName};`));
        props.forEach((prop) => this.emitBuilderSetter(prop, BUILDER_CLASS_NAME, classSpec));
        // Start build()
        this.code.line();
        this.code.line('/**');
        this.code.line(' * Builds the configured instance.');
        this.code.line(` * @return a new instance of {@link ${classSpec.name}}`);
        this.code.line(' * @throws NullPointerException if any required attribute was not provided');
        this.code.line(' */');
        this.emitStabilityAnnotations(classSpec);
        this.code.line('@Override');
        this.code.openBlock(`public ${classSpec.name} build()`);
        this.code.line(`return new ${constructorName}(this);`);
        this.code.closeBlock();
        // End build()
        this.code.closeBlock();
        // End Builder
    }
    emitDataType(ifc) {
        // collect all properties from all base structs and dedupe by name. It is assumed that the generation of the
        // assembly will not permit multiple overloaded inherited properties with the same name and that this will be
        // enforced by Typescript constraints.
        const propsByName = {};
        function collectProps(currentIfc, isBaseClass = false) {
            var _a, _b;
            for (const property of (_a = currentIfc.properties) !== null && _a !== void 0 ? _a : []) {
                const javaProp = this.toJavaProp(property, currentIfc, isBaseClass);
                propsByName[javaProp.propName] = javaProp;
            }
            // add props of base struct
            for (const base of (_b = currentIfc.interfaces) !== null && _b !== void 0 ? _b : []) {
                collectProps.call(this, this.findType(base), true);
            }
        }
        collectProps.call(this, ifc);
        const props = Object.values(propsByName);
        this.emitInterfaceBuilder(ifc, INTERFACE_PROXY_CLASS_NAME, props);
        // Start implementation class
        this.code.line();
        this.code.line('/**');
        this.code.line(` * An implementation for {@link ${ifc.name}}`);
        this.code.line(' */');
        this.emitStabilityAnnotations(ifc);
        this.code.line(ANN_INTERNAL);
        this.code.openBlock(`final class ${INTERFACE_PROXY_CLASS_NAME} extends software.amazon.jsii.JsiiObject implements ${ifc.name}`);
        // Immutable properties
        props.forEach((prop) => this.code.line(`private final ${prop.fieldJavaType} ${prop.fieldName};`));
        // Start JSII reference constructor
        this.code.line();
        this.code.line('/**');
        this.code.line(' * Constructor that initializes the object based on values retrieved from the JsiiObject.');
        this.code.line(' * @param objRef Reference to the JSII managed object.');
        this.code.line(' */');
        this.code.openBlock(`protected ${INTERFACE_PROXY_CLASS_NAME}(final software.amazon.jsii.JsiiObjectRef objRef)`);
        this.code.line('super(objRef);');
        props.forEach((prop) => this.code.line(`this.${prop.fieldName} = software.amazon.jsii.Kernel.get(this, "${prop.jsiiName}", ${prop.fieldNativeType});`));
        this.code.closeBlock();
        // End JSII reference constructor
        // Start builder constructor
        this.code.line();
        this.code.line('/**');
        this.code.line(' * Constructor that initializes the object based on literal property values passed by the {@link Builder}.');
        this.code.line(' */');
        if (props.some((prop) => prop.fieldJavaType !== prop.paramJavaType)) {
            this.code.line('@SuppressWarnings("unchecked")');
        }
        this.code.openBlock(`protected ${INTERFACE_PROXY_CLASS_NAME}(final ${BUILDER_CLASS_NAME} builder)`);
        this.code.line('super(software.amazon.jsii.JsiiObject.InitializationMode.JSII);');
        props.forEach((prop) => {
            const explicitCast = prop.fieldJavaType !== prop.paramJavaType
                ? `(${prop.fieldJavaType})`
                : '';
            this.code.line(`this.${prop.fieldName} = ${explicitCast}${_validateIfNonOptional(`builder.${prop.fieldName}`, prop)};`);
        });
        this.code.closeBlock();
        // End literal constructor
        // Getters
        props.forEach((prop) => {
            this.code.line();
            this.code.line('@Override');
            this.code.openBlock(`public final ${prop.fieldJavaType} get${prop.propName}()`);
            this.code.line(`return this.${prop.fieldName};`);
            this.code.closeBlock();
        });
        // emit $jsii$toJson which will be called to serialize this object when sent to JS
        this.code.line();
        this.code.line('@Override');
        this.code.line(ANN_INTERNAL);
        this.code.openBlock('public com.fasterxml.jackson.databind.JsonNode $jsii$toJson()');
        this.code.line('final com.fasterxml.jackson.databind.ObjectMapper om = software.amazon.jsii.JsiiObjectMapper.INSTANCE;');
        this.code.line(`final com.fasterxml.jackson.databind.node.ObjectNode data = com.fasterxml.jackson.databind.node.JsonNodeFactory.instance.objectNode();`);
        this.code.line();
        for (const prop of props) {
            if (prop.nullable) {
                this.code.openBlock(`if (this.get${prop.propName}() != null)`);
            }
            this.code.line(`data.set("${prop.spec.name}", om.valueToTree(this.get${prop.propName}()));`);
            if (prop.nullable) {
                this.code.closeBlock();
            }
        }
        this.code.line();
        this.code.line('final com.fasterxml.jackson.databind.node.ObjectNode struct = com.fasterxml.jackson.databind.node.JsonNodeFactory.instance.objectNode();');
        this.code.line(`struct.set("fqn", om.valueToTree("${ifc.fqn}"));`);
        this.code.line('struct.set("data", data);');
        this.code.line();
        this.code.line('final com.fasterxml.jackson.databind.node.ObjectNode obj = com.fasterxml.jackson.databind.node.JsonNodeFactory.instance.objectNode();');
        this.code.line('obj.set("$jsii.struct", struct);');
        this.code.line();
        this.code.line('return obj;');
        this.code.closeBlock();
        // End $jsii$toJson
        // Generate equals() override
        this.emitEqualsOverride(ifc.name, props);
        // Generate hashCode() override
        this.emitHashCodeOverride(props);
        this.code.closeBlock();
        // End implementation class
        function _validateIfNonOptional(variable, prop) {
            if (prop.nullable) {
                return variable;
            }
            return `java.util.Objects.requireNonNull(${variable}, "${prop.fieldName} is required")`;
        }
    }
    emitEqualsOverride(className, props) {
        // A class without properties does not need to override equals()
        if (props.length === 0) {
            return;
        }
        this.code.line();
        this.code.line('@Override');
        this.code.openBlock('public final boolean equals(final Object o)');
        this.code.line('if (this == o) return true;');
        // This was already checked by `super.equals(o)`, so we skip it here...
        this.code.line('if (o == null || getClass() != o.getClass()) return false;');
        this.code.line();
        this.code.line(`${className}.${INTERFACE_PROXY_CLASS_NAME} that = (${className}.${INTERFACE_PROXY_CLASS_NAME}) o;`);
        this.code.line();
        const initialProps = props.slice(0, props.length - 1);
        const finalProp = props[props.length - 1];
        initialProps.forEach((prop) => {
            const predicate = prop.nullable
                ? `this.${prop.fieldName} != null ? !this.${prop.fieldName}.equals(that.${prop.fieldName}) : that.${prop.fieldName} != null`
                : `!${prop.fieldName}.equals(that.${prop.fieldName})`;
            this.code.line(`if (${predicate}) return false;`);
        });
        // The final (returned predicate) is the inverse of the other ones
        const finalPredicate = finalProp.nullable
            ? `this.${finalProp.fieldName} != null ? this.${finalProp.fieldName}.equals(that.${finalProp.fieldName}) : ` +
                `that.${finalProp.fieldName} == null`
            : `this.${finalProp.fieldName}.equals(that.${finalProp.fieldName})`;
        this.code.line(`return ${finalPredicate};`);
        this.code.closeBlock();
    }
    emitHashCodeOverride(props) {
        // A class without properties does not need to override hashCode()
        if (props.length === 0) {
            return;
        }
        this.code.line();
        this.code.line('@Override');
        this.code.openBlock('public final int hashCode()');
        const firstProp = props[0];
        const remainingProps = props.slice(1);
        this.code.line(`int result = ${_hashCodeForProp(firstProp)};`);
        remainingProps.forEach((prop) => this.code.line(`result = 31 * result + (${_hashCodeForProp(prop)});`));
        this.code.line('return result;');
        this.code.closeBlock();
        function _hashCodeForProp(prop) {
            return prop.nullable
                ? `this.${prop.fieldName} != null ? this.${prop.fieldName}.hashCode() : 0`
                : `this.${prop.fieldName}.hashCode()`;
        }
    }
    openFileIfNeeded(type) {
        if (this.isNested(type)) {
            return;
        }
        this.code.openFile(this.toJavaFilePath(this.assembly, type));
        this.code.line(`package ${this.toNativeName(this.assembly, type).packageName};`);
        this.code.line();
    }
    closeFileIfNeeded(type) {
        if (this.isNested(type)) {
            return;
        }
        this.code.closeFile(this.toJavaFilePath(this.assembly, type));
    }
    isNested(type) {
        if (!this.assembly.types || !type.namespace) {
            return false;
        }
        const parent = `${type.assembly}.${type.namespace}`;
        return parent in this.assembly.types;
    }
    toJavaFilePath(assm, what) {
        const fqn = typeof what === 'string' ? what : what.fqn;
        const { packageName, typeNames } = translateFqn(assm, fqn);
        if (typeNames.length === 0) {
            throw new Error(`toJavaFilePath: ${fqn} must indicate a type, but doesn't: ${JSON.stringify({ packageName, typeNames })}`);
        }
        return `${path.join('src', 'main', 'java', ...packageName.split('.'), typeNames[0])}.java`;
    }
    toJavaResourcePath(assm, fqn, ext = '.txt') {
        const { packageName, typeName } = this.toNativeName(assm, {
            fqn,
            kind: spec.TypeKind.Class,
            assembly: assm.name,
            name: fqn.replace(/.*\.([^.]+)$/, '$1'),
        });
        const parts = [
            ...packageName.split('.'),
            `${typeName.split('.')[0]}${ext}`,
        ];
        // Resource names are /-delimited paths (even on Windows *wink wink*)
        const name = parts.join('/');
        const filePath = path.join('src', 'main', 'resources', ...parts);
        return { filePath, name };
    }
    // eslint-disable-next-line complexity
    addJavaDocs(doc, apiLoc, defaultText) {
        var _a, _b, _c, _d;
        if (!defaultText &&
            Object.keys((_a = doc.docs) !== null && _a !== void 0 ? _a : {}).length === 0 &&
            !((_b = doc.parameters) !== null && _b !== void 0 ? _b : []).some((p) => { var _a; return Object.keys((_a = p.docs) !== null && _a !== void 0 ? _a : {}).length !== 0; })) {
            return;
        }
        const docs = (doc.docs = (_c = doc.docs) !== null && _c !== void 0 ? _c : {});
        const paras = [];
        if (docs.summary) {
            paras.push(_utils_1.renderSummary(docs));
        }
        else if (defaultText) {
            paras.push(defaultText);
        }
        if (docs.remarks) {
            paras.push(jsii_rosetta_1.markDownToJavaDoc(this.convertSamplesInMarkdown(docs.remarks, apiLoc)).trimRight());
        }
        if (docs.default) {
            paras.push(`Default: ${docs.default}`); // NOTE: there is no annotation in JavaDoc for this
        }
        if (docs.example) {
            paras.push('Example:');
            const convertedExample = this.convertExample(docs.example, apiLoc);
            // We used to use the slightly nicer `<pre>{@code ...}</pre>`, which doesn't
            // require (and therefore also doesn't allow) escaping special characters.
            //
            // However, code samples may contain block quotes of their own ('*/') that
            // would terminate the block comment from the PoV of the Java tokenizer, and
            // since `{@code ... }` doesn't allow any escaping, there's also no way to encode
            // '*/' in a way that would (a) hide it from the tokenizer and (b) give '*/' back
            // after processing JavaDocs.
            //
            // Hence, we just resort to HTML-encoding everything (same as we do for code
            // examples that have been translated from MarkDown).
            paras.push(jsii_rosetta_1.markDownToJavaDoc(['```', convertedExample, '```'].join('\n')));
        }
        const tagLines = [];
        if (docs.returns) {
            tagLines.push(`@return ${docs.returns}`);
        }
        if (docs.see) {
            tagLines.push(`@see ${docs.see}`);
        }
        if (docs.deprecated) {
            tagLines.push(`@deprecated ${docs.deprecated}`);
        }
        // Params
        if (doc.parameters) {
            const method = doc;
            if (method.parameters) {
                for (const param of method.parameters) {
                    const summary = (_d = param.docs) === null || _d === void 0 ? void 0 : _d.summary;
                    tagLines.push(paramJavadoc(param.name, param.optional, summary));
                }
            }
        }
        if (tagLines.length > 0) {
            paras.push(tagLines.join('\n'));
        }
        const lines = new Array();
        for (const para of paras) {
            if (lines.length > 0) {
                lines.push('<p>');
            }
            lines.push(...para.split('\n').filter((l) => l !== ''));
        }
        this.code.line('/**');
        for (const line of lines) {
            this.code.line(` * ${line}`);
        }
        this.code.line(' */');
    }
    getClassBase(cls) {
        if (!cls.base) {
            return 'software.amazon.jsii.JsiiObject';
        }
        return this.toJavaType({ fqn: cls.base });
    }
    toDecoratedJavaType(optionalValue, { covariant = false } = {}) {
        const result = this.toDecoratedJavaTypes(optionalValue, { covariant });
        if (result.length > 1) {
            return `${optionalValue.optional ? ANN_NULLABLE : ANN_NOT_NULL} java.lang.Object`;
        }
        return result[0];
    }
    toDecoratedJavaTypes(optionalValue, { covariant = false } = {}) {
        return this.toJavaTypes(optionalValue.type, { covariant }).map((nakedType) => `${optionalValue.optional ? ANN_NULLABLE : ANN_NOT_NULL} ${nakedType}`);
    }
    toJavaType(type, opts) {
        const types = this.toJavaTypes(type, opts);
        if (types.length > 1) {
            return 'java.lang.Object';
        }
        return types[0];
    }
    toNativeType(type, { forMarshalling = false, covariant = false } = {}) {
        if (spec.isCollectionTypeReference(type)) {
            const nativeElementType = this.toNativeType(type.collection.elementtype, {
                forMarshalling,
                covariant,
            });
            switch (type.collection.kind) {
                case spec.CollectionKind.Array:
                    return `software.amazon.jsii.NativeType.listOf(${nativeElementType})`;
                case spec.CollectionKind.Map:
                    return `software.amazon.jsii.NativeType.mapOf(${nativeElementType})`;
                default:
                    throw new Error(`Unsupported collection kind: ${type.collection.kind}`);
            }
        }
        return `software.amazon.jsii.NativeType.forClass(${this.toJavaType(type, {
            forMarshalling,
            covariant,
        })}.class)`;
    }
    toJavaTypes(typeref, { forMarshalling = false, covariant = false } = {}) {
        if (spec.isPrimitiveTypeReference(typeref)) {
            return [this.toJavaPrimitive(typeref.primitive)];
        }
        else if (spec.isCollectionTypeReference(typeref)) {
            return [this.toJavaCollection(typeref, { forMarshalling, covariant })];
        }
        else if (spec.isNamedTypeReference(typeref)) {
            return [this.toNativeFqn(typeref.fqn)];
        }
        else if (typeref.union) {
            const types = new Array();
            for (const subtype of typeref.union.types) {
                for (const t of this.toJavaTypes(subtype, {
                    forMarshalling,
                    covariant,
                })) {
                    types.push(t);
                }
            }
            return types;
        }
        throw new Error(`Invalid type reference: ${JSON.stringify(typeref)}`);
    }
    toJavaCollection(ref, { forMarshalling, covariant, }) {
        const elementJavaType = this.toJavaType(ref.collection.elementtype, {
            covariant,
        });
        const typeConstraint = covariant
            ? makeCovariant(elementJavaType)
            : elementJavaType;
        switch (ref.collection.kind) {
            case spec.CollectionKind.Array:
                return forMarshalling
                    ? 'java.util.List'
                    : `java.util.List<${typeConstraint}>`;
            case spec.CollectionKind.Map:
                return forMarshalling
                    ? 'java.util.Map'
                    : `java.util.Map<java.lang.String, ${typeConstraint}>`;
            default:
                throw new Error(`Unsupported collection kind: ${ref.collection.kind}`);
        }
        function makeCovariant(javaType) {
            // Don't emit a covariant expression for String (it's `final` in Java)
            if (javaType === 'java.lang.String') {
                return javaType;
            }
            return `? extends ${javaType}`;
        }
    }
    toJavaPrimitive(primitive) {
        switch (primitive) {
            case spec.PrimitiveType.Boolean:
                return 'java.lang.Boolean';
            case spec.PrimitiveType.Date:
                return 'java.time.Instant';
            case spec.PrimitiveType.Json:
                return 'com.fasterxml.jackson.databind.node.ObjectNode';
            case spec.PrimitiveType.Number:
                return 'java.lang.Number';
            case spec.PrimitiveType.String:
                return 'java.lang.String';
            case spec.PrimitiveType.Any:
                return 'java.lang.Object';
            default:
                throw new Error(`Unknown primitive type: ${primitive}`);
        }
    }
    renderMethodCallArguments(method) {
        if (!method.parameters || method.parameters.length === 0) {
            return '';
        }
        const regularParams = method.parameters.filter((p) => !p.variadic);
        const values = regularParams.map(_renderParameter);
        const valueStr = `new Object[] { ${values.join(', ')} }`;
        if (method.variadic) {
            const valuesStream = `java.util.Arrays.<Object>stream(${valueStr})`;
            const lastParam = method.parameters[method.parameters.length - 1];
            const restStream = `java.util.Arrays.<Object>stream(${lastParam.name})`;
            const fullStream = regularParams.length > 0
                ? `java.util.stream.Stream.concat(${valuesStream}, ${restStream})`
                : restStream;
            return `, ${fullStream}.toArray(Object[]::new)`;
        }
        return `, ${valueStr}`;
        function _renderParameter(param) {
            const safeName = JavaGenerator.safeJavaPropertyName(param.name);
            return isNullable(param)
                ? safeName
                : `java.util.Objects.requireNonNull(${safeName}, "${safeName} is required")`;
        }
    }
    renderMethodCall(cls, method, async) {
        let statement = '';
        if (method.static) {
            const javaClass = this.toJavaType(cls);
            statement += `software.amazon.jsii.JsiiObject.jsiiStaticCall(${javaClass}.class, `;
        }
        else {
            statement += `software.amazon.jsii.Kernel.${async ? 'asyncCall' : 'call'}(this, `;
        }
        statement += `"${method.name}"`;
        if (method.returns) {
            statement += `, ${this.toNativeType(method.returns.type, {
                forMarshalling: true,
            })}`;
        }
        else {
            statement += ', software.amazon.jsii.NativeType.VOID';
        }
        statement += `${this.renderMethodCallArguments(method)})`;
        if (method.returns) {
            statement = this.wrapCollection(statement, method.returns.type, method.returns.optional);
        }
        if (method.returns) {
            return `return ${statement};`;
        }
        return `${statement};`;
    }
    /**
     * Wraps a collection into an unmodifiable collection else returns the existing statement.
     * @param statement The statement to wrap if necessary.
     * @param type The type of the object to wrap.
     * @param optional Whether the value is optional (can be null/undefined) or not.
     * @returns The modified or original statement.
     */
    wrapCollection(statement, type, optional) {
        if (spec.isCollectionTypeReference(type)) {
            let wrapper;
            switch (type.collection.kind) {
                case spec.CollectionKind.Array:
                    wrapper = 'unmodifiableList';
                    break;
                case spec.CollectionKind.Map:
                    wrapper = 'unmodifiableMap';
                    break;
                default:
                    throw new Error(`Unsupported collection kind: ${type.collection.kind}`);
            }
            // In the case of "optional", the value needs ot be explicitly cast to allow for cases where the raw type was returned.
            return optional
                ? `java.util.Optional.ofNullable((${this.toJavaType(type)})(${statement})).map(java.util.Collections::${wrapper}).orElse(null)`
                : `java.util.Collections.${wrapper}(${statement})`;
        }
        return statement;
    }
    renderMethodParameters(method) {
        const params = [];
        if (method.parameters) {
            for (const p of method.parameters) {
                // We can render covariant parameters only for methods that aren't overridable... so only for static methods currently.
                params.push(`final ${this.toDecoratedJavaType(p, {
                    covariant: method.static,
                })}${p.variadic ? '...' : ''} ${JavaGenerator.safeJavaPropertyName(p.name)}`);
            }
        }
        return params.join(', ');
    }
    renderAccessLevel(method) {
        return method.protected ? 'protected' : 'public';
    }
    makeModuleClass(moduleName) {
        return `${this.toNativeFqn(moduleName)}.${MODULE_CLASS_NAME}`;
    }
    emitModuleFile(mod) {
        var _a, _b, _c;
        const moduleName = mod.name;
        const moduleClass = this.makeModuleClass(moduleName);
        const { filePath: moduleResFile, name: moduleResName } = this.toJavaResourcePath(mod, `${mod.name}.${MODULE_CLASS_NAME}`);
        this.code.openFile(moduleResFile);
        for (const fqn of Object.keys((_a = this.assembly.types) !== null && _a !== void 0 ? _a : {})) {
            this.code.line(`${fqn}=${this.toNativeFqn(fqn, { binaryName: true })}`);
        }
        this.code.closeFile(moduleResFile);
        const moduleFile = this.toJavaFilePath(mod, {
            assembly: mod.name,
            fqn: `${mod.name}.${MODULE_CLASS_NAME}`,
            kind: spec.TypeKind.Class,
            name: MODULE_CLASS_NAME,
        });
        this.code.openFile(moduleFile);
        this.code.line(`package ${this.toNativeName(mod).packageName};`);
        this.code.line();
        if (Object.keys((_b = mod.dependencies) !== null && _b !== void 0 ? _b : {}).length > 0) {
            this.code.line('import static java.util.Arrays.asList;');
            this.code.line();
        }
        this.code.line('import java.io.BufferedReader;');
        this.code.line('import java.io.InputStream;');
        this.code.line('import java.io.InputStreamReader;');
        this.code.line('import java.io.IOException;');
        this.code.line('import java.io.Reader;');
        this.code.line('import java.io.UncheckedIOException;');
        this.code.line();
        this.code.line('import java.nio.charset.StandardCharsets;');
        this.code.line();
        this.code.line('import java.util.HashMap;');
        if (Object.keys((_c = mod.dependencies) !== null && _c !== void 0 ? _c : {}).length > 0) {
            this.code.line('import java.util.List;');
        }
        this.code.line('import java.util.Map;');
        this.code.line();
        this.code.line('import software.amazon.jsii.JsiiModule;');
        this.code.line();
        this.code.line(ANN_INTERNAL);
        this.code.openBlock(`public final class ${MODULE_CLASS_NAME} extends JsiiModule`);
        this.code.line('private static final Map<String, String> MODULE_TYPES = load();');
        this.code.line();
        this.code.openBlock('private static Map<String, String> load()');
        this.code.line('final Map<String, String> result = new HashMap<>();');
        this.code.line(`final ClassLoader cl = ${MODULE_CLASS_NAME}.class.getClassLoader();`);
        this.code.line(`try (final InputStream is = cl.getResourceAsStream("${moduleResName}");`);
        this.code.line('     final Reader rd = new InputStreamReader(is, StandardCharsets.UTF_8);');
        this.code.openBlock('     final BufferedReader br = new BufferedReader(rd))');
        this.code.line('br.lines()');
        this.code.line('  .filter(line -> !line.trim().isEmpty())');
        this.code.openBlock('  .forEach(line -> ');
        this.code.line('final String[] parts = line.split("=", 2);');
        this.code.line('final String fqn = parts[0];');
        this.code.line('final String className = parts[1];');
        this.code.line('result.put(fqn, className);');
        this.code.unindent('});'); // Proxy for closeBlock
        this.code.closeBlock();
        this.code.openBlock('catch (final IOException exception)');
        this.code.line('throw new UncheckedIOException(exception);');
        this.code.closeBlock();
        this.code.line('return result;');
        this.code.closeBlock();
        this.code.line();
        this.code.line('private final Map<String, Class<?>> cache = new HashMap<>();');
        this.code.line();
        // ctor
        this.code.openBlock(`public ${MODULE_CLASS_NAME}()`);
        this.code.line(`super("${moduleName}", "${mod.version}", ${MODULE_CLASS_NAME}.class, "${this.getAssemblyFileName()}");`);
        this.code.closeBlock(); // ctor
        // dependencies
        if (mod.dependencies && Object.keys(mod.dependencies).length > 0) {
            const deps = [];
            for (const dep of Object.keys(mod.dependencies)) {
                deps.push(`${this.makeModuleClass(dep)}.class`);
            }
            this.code.line();
            this.code.line('@Override');
            this.code.openBlock('public List<Class<? extends JsiiModule>> getDependencies()');
            this.code.line(`return asList(${deps.join(', ')});`);
            this.code.closeBlock();
        }
        this.code.line();
        this.code.line('@Override');
        this.code.openBlock('protected Class<?> resolveClass(final String fqn) throws ClassNotFoundException');
        this.code.openBlock('if (!MODULE_TYPES.containsKey(fqn))');
        this.code.line('throw new ClassNotFoundException("Unknown JSII type: " + fqn);');
        this.code.closeBlock();
        this.code.line('String className = MODULE_TYPES.get(fqn);');
        this.code.openBlock('if (!this.cache.containsKey(className))');
        this.code.line('this.cache.put(className, this.findClass(className));');
        this.code.closeBlock();
        this.code.line('return this.cache.get(className);');
        this.code.closeBlock();
        this.code.line();
        this.code.openBlock('private Class<?> findClass(final String binaryName)');
        this.code.openBlock('try');
        this.code.line('return Class.forName(binaryName);');
        this.code.closeBlock();
        this.code.openBlock('catch (final ClassNotFoundException exception)');
        this.code.line('throw new RuntimeException(exception);');
        this.code.closeBlock();
        this.code.closeBlock();
        this.code.closeBlock();
        this.code.closeFile(moduleFile);
        return moduleClass;
    }
    emitJsiiInitializers(cls) {
        this.code.line();
        this.code.openBlock(`protected ${cls.name}(final software.amazon.jsii.JsiiObjectRef objRef)`);
        this.code.line('super(objRef);');
        this.code.closeBlock();
        this.code.line();
        this.code.openBlock(`protected ${cls.name}(final software.amazon.jsii.JsiiObject.InitializationMode initializationMode)`);
        this.code.line('super(initializationMode);');
        this.code.closeBlock();
    }
    /**
     * Computes the java FQN for a JSII FQN:
     * 1. Determine which assembly the FQN belongs to (first component of the FQN)
     * 2. Locate the `targets.java.package` value for that assembly (this assembly, or one of the dependencies)
     * 3. Return the java FQN: ``<module.targets.java.package>.<FQN stipped of first component>``
     *
     * Records an assembly reference if the referenced FQN comes from a different assembly.
     *
     * @param fqn the JSII FQN to be used.
     *
     * @returns the corresponding Java FQN.
     *
     * @throws if the assembly the FQN belongs to does not have a `targets.java.package` set.
     */
    toNativeFqn(fqn, { binaryName } = { binaryName: false }) {
        const [mod] = fqn.split('.');
        const depMod = this.findModule(mod);
        // Make sure any dependency (direct or transitive) of which any type is explicitly referenced by the generated
        // code is included in the generated POM's dependencies section (protecting the artifact from changes in the
        // dependencies' dependency structure).
        if (mod !== this.assembly.name) {
            this.referencedModules[mod] = depMod;
            const translated = translateFqn({ ...depMod, name: mod }, fqn);
            return [translated.packageName, ...translated.typeNames].join('.');
        }
        const { packageName, typeName } = fqn === this.assembly.name
            ? this.toNativeName(this.assembly)
            : this.toNativeName(this.assembly, this.assembly.types[fqn]);
        const className = typeName && binaryName ? typeName.replace('.', '$') : typeName;
        return `${packageName}${className ? `.${className}` : ''}`;
    }
    toNativeName(assm, type) {
        if (!type) {
            return { packageName: packageNameFromAssembly(assm) };
        }
        const translated = translateFqn(assm, type.fqn);
        return {
            packageName: translated.packageName,
            typeName: translated.typeNames.join('.'),
        };
    }
    /**
     * Emits an ``@Generated`` annotation honoring the ``this.emitFullGeneratorInfo`` setting.
     */
    emitGeneratedAnnotation() {
        const date = this.emitFullGeneratorInfo
            ? `, date = "${new Date().toISOString()}"`
            : '';
        const generator = this.emitFullGeneratorInfo
            ? `jsii-pacmak/${version_1.VERSION_DESC}`
            : 'jsii-pacmak';
        this.code.line(`@javax.annotation.Generated(value = "${generator}"${date})`);
    }
    convertExample(example, api) {
        const translated = this.rosetta.translateExample(api, example, jsii_rosetta_1.TargetLanguage.JAVA, jsii_rosetta_1.enforcesStrictMode(this.assembly));
        return this.prefixDisclaimer(translated);
    }
    convertSamplesInMarkdown(markdown, api) {
        return this.rosetta.translateSnippetsInMarkdown(api, markdown, jsii_rosetta_1.TargetLanguage.JAVA, jsii_rosetta_1.enforcesStrictMode(this.assembly), (trans) => ({
            language: trans.language,
            source: this.prefixDisclaimer(trans),
        }));
    }
    prefixDisclaimer(translated) {
        if (!translated.didCompile && _1.INCOMPLETE_DISCLAIMER_NONCOMPILING) {
            return `// ${_1.INCOMPLETE_DISCLAIMER_NONCOMPILING}\n${translated.source}`;
        }
        return translated.source;
    }
    /**
     * Fins the Java FQN of the default implementation interfaces that should be implemented when a new
     * default interface or proxy class is being emitted.
     *
     * @param type the type for which a default interface or proxy is emitted.
     * @param includeThisType whether this class's default interface should be included or not.
     *
     * @returns a list of Java fully qualified class names.
     */
    defaultInterfacesFor(type, { includeThisType = false } = {}) {
        const result = new Set();
        if (includeThisType &&
            hasDefaultInterfaces(type.assembly) &&
            type.isInterfaceType()) {
            result.add(`${this.toNativeFqn(type.fqn)}.${INTERFACE_DEFAULT_CLASS_NAME}`);
        }
        else {
            for (const iface of type.interfaces) {
                if (hasDefaultInterfaces(iface.assembly)) {
                    result.add(`${this.toNativeFqn(iface.fqn)}.${INTERFACE_DEFAULT_CLASS_NAME}`);
                }
                else {
                    for (const item of this.defaultInterfacesFor(iface)) {
                        result.add(item);
                    }
                }
            }
            if (type.isClassType() && type.base != null) {
                for (const item of this.defaultInterfacesFor(type.base)) {
                    result.add(item);
                }
            }
        }
        return Array.from(result);
    }
}
// When the code-generator needs to generate code for a property or method that has the same name as a member of this list, the name will
// be automatically modified to avoid compile errors. Most of these are java language reserved keywords. In addition to those, any keywords that
// are likely to conflict with auto-generated methods or properties (eg: 'build') are also considered reserved.
JavaGenerator.RESERVED_KEYWORDS = [
    'abstract',
    'assert',
    'boolean',
    'break',
    'build',
    'byte',
    'case',
    'catch',
    'char',
    'class',
    'const',
    'continue',
    'default',
    'double',
    'do',
    'else',
    'enum',
    'extends',
    'false',
    'final',
    'finally',
    'float',
    'for',
    'goto',
    'if',
    'implements',
    'import',
    'instanceof',
    'int',
    'interface',
    'long',
    'native',
    'new',
    'null',
    'package',
    'private',
    'protected',
    'public',
    'return',
    'short',
    'static',
    'strictfp',
    'super',
    'switch',
    'synchronized',
    'this',
    'throw',
    'throws',
    'transient',
    'true',
    'try',
    'void',
    'volatile',
    'while',
];
/**
 * Looks up the `@jsii/java-runtime` package from the local repository.
 * If it contains a "maven-repo" directory, it will be added as a local maven repo
 * so when we build locally, we build against it and not against the one published
 * to Maven Central.
 */
function findJavaRuntimeLocalRepository() {
    try {
        // eslint-disable-next-line @typescript-eslint/no-var-requires,@typescript-eslint/no-require-imports,import/no-extraneous-dependencies
        const javaRuntime = require('@jsii/java-runtime');
        logging.info(`Using local version of the Java jsii runtime package at: ${javaRuntime.repository}`);
        return javaRuntime.repository;
    }
    catch {
        return undefined;
    }
}
function isNullable(optionalValue) {
    if (!optionalValue) {
        return false;
    }
    return (optionalValue.optional ||
        (spec.isPrimitiveTypeReference(optionalValue.type) &&
            optionalValue.type.primitive === spec.PrimitiveType.Any));
}
function paramJavadoc(name, optional, summary) {
    const parts = ['@param', name];
    if (summary) {
        parts.push(endWithPeriod(summary));
    }
    if (!optional) {
        parts.push('This parameter is required.');
    }
    return parts.join(' ');
}
function endWithPeriod(s) {
    s = s.trimRight();
    if (!s.endsWith('.')) {
        return `${s}.`;
    }
    return s;
}
function computeOverrides(allParams) {
    return {
        [Symbol.iterator]: function* () {
            yield allParams;
            while (allParams.length > 0) {
                const lastParam = allParams[allParams.length - 1];
                if (!lastParam.param.variadic && !lastParam.param.optional) {
                    // Neither variadic nor optional -- we're done here!
                    return;
                }
                allParams = allParams.slice(0, allParams.length - 1);
                // If the lastParam was variadic, we shouldn't generate an override without it only.
                if (lastParam.param.optional) {
                    yield allParams;
                }
            }
        },
    };
}
/**
 * Return the native package name from an assembly
 */
function packageNameFromAssembly(assm) {
    var _a, _b;
    const javaPackage = (_b = (_a = assm.targets) === null || _a === void 0 ? void 0 : _a.java) === null || _b === void 0 ? void 0 : _b.package;
    if (!javaPackage) {
        throw new Error(`The module ${assm.name} does not have a java.package setting`);
    }
    return javaPackage;
}
/**
 * Analyzes and translates a jsii FQN to Java components
 *
 * The FQN can be of the assembly, a submodule, or a type.
 *
 * Any type can have the following characteristics:
 *
 * - Located in zero or more nested submodules. Any of these can have a Java
 *   package name assigned--if none, the name is automatically determined by
 *   snake casing. At least the assembly must have a Java package name assigned.
 * - Located in zero or more nested types (classes).
 *
 * Find up the set of namespaces until we find a submodule (or the assembly
 * itself) that has an explicit Java package name defined.
 *
 * Append all the namespaces that we crossed that didn't have a package name defined.
 *
 * Returns the Java package name determined this way, as well as the hierarchy of type
 * names inside the package. `typeNames` may be missing or empty if the FQN indicated
 * the assembly or a submodule, contains 1 element if the FQN indicated a top-level type,
 * multiple elements if the FQN indicated a nested type.
 */
function translateFqn(assm, originalFqn) {
    var _a, _b, _c;
    const implicitPackageNames = new Array();
    const typeNames = new Array();
    // We work ourselves upward through the FQN until we've found an explicit package
    let packageName = packageNameFromAssembly(assm);
    let fqn = originalFqn;
    while (fqn !== '' && fqn !== assm.name) {
        const [parentFqn, lastPart] = splitNamespace(fqn);
        const submodule = (_a = assm.submodules) === null || _a === void 0 ? void 0 : _a[fqn];
        if (submodule) {
            const explicitPackage = (_c = (_b = submodule.targets) === null || _b === void 0 ? void 0 : _b.java) === null || _c === void 0 ? void 0 : _c.package;
            if (explicitPackage) {
                packageName = explicitPackage;
                // We can stop recursing, types cannot be the parent of a module and nothing upwards can change
                // the package name anymore
                break;
            }
            implicitPackageNames.unshift(`.${case_utils_1.toSnakeCase(lastPart)}`);
        }
        else {
            // If it's not a submodule, it must be a type.
            typeNames.unshift(lastPart);
        }
        fqn = parentFqn;
    }
    if (fqn === '') {
        throw new Error(`Could not find '${originalFqn}' inside '${assm.name}'`);
    }
    return {
        packageName: `${packageName}${implicitPackageNames.join('')}`,
        typeNames,
    };
}
/**
 * Determines whether the provided assembly exposes the "hasDefaultInterfaces"
 * jsii-pacmak feature flag.
 *
 * @param assembly the assembly that is tested
 *
 * @returns true if the Jsii$Default interfaces can be used
 */
function hasDefaultInterfaces(assembly) {
    var _a, _b, _c;
    return !!((_c = (_b = (_a = assembly.metadata) === null || _a === void 0 ? void 0 : _a.jsii) === null || _b === void 0 ? void 0 : _b.pacmak) === null || _c === void 0 ? void 0 : _c.hasDefaultInterfaces);
}
/**
 * Whecks whether a name corresponds to a method on `java.lang.Object`. It is not
 * possible to emit default interface implementation for those names because
 * these would always be replaced by the implementations on `Object`.
 *
 * @param name the checked name
 *
 * @returns `true` if a default implementation cannot be generated for this name.
 */
function isJavaLangObjectMethodName(name) {
    return JAVA_LANG_OBJECT_METHOD_NAMES.has(name);
}
const JAVA_LANG_OBJECT_METHOD_NAMES = new Set([
    'clone',
    'equals',
    'finalize',
    'getClass',
    'hashCode',
    'notify',
    'notifyAll',
    'toString',
    'wait',
]);
/**
 * In a dotted string, strip off the last dotted component
 */
function splitNamespace(ns) {
    const dot = ns.lastIndexOf('.');
    if (dot === -1) {
        return ['', ns];
    }
    return [ns.substr(0, dot), ns.substr(dot + 1)];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamF2YS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImphdmEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsbUNBQW1DO0FBQ25DLCtCQUErQjtBQUMvQix5REFBdUQ7QUFDdkQsK0JBQStCO0FBRS9CLCtDQU9zQjtBQUN0Qiw2QkFBNkI7QUFDN0IseUNBQXlDO0FBR3pDLDRDQUF5QztBQUN6QyxzQ0FBc0M7QUFDdEMsZ0RBQWtEO0FBRWxELHNDQUttQjtBQUNuQixrQ0FBNkQ7QUFDN0Qsd0NBQW1EO0FBQ25ELHFDQUE2RDtBQUM3RCxtREFBd0U7QUFFeEUsd0JBQW1FO0FBRW5FLG9HQUFvRztBQUNwRyxNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQztBQUVyRCxNQUFNLGtCQUFrQixHQUFHLFNBQVMsQ0FBQztBQUVyQyxNQUFNLFlBQVksR0FBRyxvQ0FBb0MsQ0FBQztBQUMxRCxNQUFNLFlBQVksR0FBRyxxQ0FBcUMsQ0FBQztBQUMzRCxNQUFNLFlBQVksR0FBRyxnQ0FBZ0MsQ0FBQztBQUV0RDs7Ozs7Ozs7R0FRRztBQUNILE1BQWEsV0FBVztJQUd0QixZQUNtQixPQUE4QixFQUM5QixPQUFxQjtRQURyQixZQUFPLEdBQVAsT0FBTyxDQUF1QjtRQUM5QixZQUFPLEdBQVAsT0FBTyxDQUFjO1FBSnZCLGVBQVUsR0FBRyxNQUFNLENBQUM7SUFLbEMsQ0FBQztJQUVHLEtBQUssQ0FBQyxZQUFZO1FBQ3ZCLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzdCLE9BQU87U0FDUjtRQUVELElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUU7WUFDekIsdURBQXVEO1lBQ3ZELE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FDZixJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQzFCLElBQUksQ0FBQyxrQkFBa0IsQ0FDckIsTUFB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VyxFQUFFLEdBQUcsV0FBVyxHQUFHLG9CQUFvQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRTtRQUM3RCxTQUFTO0tBQ1YsQ0FBQztBQUNKLENBQUM7QUFFRDs7Ozs7OztHQU9HO0FBQ0gsU0FBUyxvQkFBb0IsQ0FBQyxRQUEwQjs7SUFDdEQsT0FBTyxDQUFDLG9CQUFDLFFBQVEsQ0FBQyxRQUFRLDBDQUFFLElBQUksMENBQUUsTUFBTSwwQ0FBRSxvQkFBb0IsQ0FBQSxDQUFDO0FBQ2pFLENBQUM7QUFFRDs7Ozs7Ozs7R0FRRztBQUNILFNBQVMsMEJBQTBCLENBQUMsSUFBWTtJQUM5QyxPQUFPLDZCQUE2QixDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqRCxDQUFDO0FBQ0QsTUFBTSw2QkFBNkIsR0FBRyxJQUFJLEdBQUcsQ0FBQztJQUM1QyxPQUFPO0lBQ1AsUUFBUTtJQUNSLFVBQVU7SUFDVixVQUFVO0lBQ1YsVUFBVTtJQUNWLFFBQVE7SUFDUixXQUFXO0lBQ1gsVUFBVTtJQUNWLE1BQU07Q0FDUCxDQUFDLENBQUM7QUFFSDs7R0FFRztBQUNILFNBQVMsY0FBYyxDQUFDLEVBQVU7SUFDaEMsTUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNoQyxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsRUFBRTtRQUNkLE9BQU8sQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDakI7SUFDRCxPQUFPLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgc3BlYyBmcm9tICdAanNpaS9zcGVjJztcbmltcG9ydCAqIGFzIGNsb25lIGZyb20gJ2Nsb25lJztcbmltcG9ydCB7IHRvU25ha2VDYXNlIH0gZnJvbSAnY29kZW1ha2VyL2xpYi9jYXNlLXV0aWxzJztcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzLWV4dHJhJztcbmltcG9ydCAqIGFzIHJlZmxlY3QgZnJvbSAnanNpaS1yZWZsZWN0JztcbmltcG9ydCB7XG4gIFJvc2V0dGEsXG4gIFRhcmdldExhbmd1YWdlLFxuICBUcmFuc2xhdGlvbixcbiAgZW5mb3JjZXNTdHJpY3RNb2RlLFxuICBtYXJrRG93blRvSmF2YURvYyxcbiAgQXBpTG9jYXRpb24sXG59IGZyb20gJ2pzaWktcm9zZXR0YSc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgeG1sYnVpbGRlciBmcm9tICd4bWxidWlsZGVyJztcblxuaW1wb3J0IHsgVGFyZ2V0QnVpbGRlciwgQnVpbGRPcHRpb25zIH0gZnJvbSAnLi4vYnVpbGRlcic7XG5pbXBvcnQgeyBHZW5lcmF0b3IgfSBmcm9tICcuLi9nZW5lcmF0b3InO1xuaW1wb3J0ICogYXMgbG9nZ2luZyBmcm9tICcuLi9sb2dnaW5nJztcbmltcG9ydCB7IGpzaWlUb1Bhc2NhbENhc2UgfSBmcm9tICcuLi9uYW1pbmctdXRpbCc7XG5pbXBvcnQgeyBKc2lpTW9kdWxlIH0gZnJvbSAnLi4vcGFja2FnaW5nJztcbmltcG9ydCB7XG4gIFBhY2thZ2VJbmZvLFxuICBUYXJnZXQsXG4gIGZpbmRMb2NhbEJ1aWxkRGlycyxcbiAgVGFyZ2V0T3B0aW9ucyxcbn0gZnJvbSAnLi4vdGFyZ2V0JztcbmltcG9ydCB7IHNoZWxsLCBTY3JhdGNoLCBzbHVnaWZ5LCBzZXRFeHRlbmQgfSBmcm9tICcuLi91dGlsJztcbmltcG9ydCB7IFZFUlNJT04sIFZFUlNJT05fREVTQyB9IGZyb20gJy4uL3ZlcnNpb24nO1xuaW1wb3J0IHsgc3RhYmlsaXR5UHJlZml4Rm9yLCByZW5kZXJTdW1tYXJ5IH0gZnJvbSAnLi9fdXRpbHMnO1xuaW1wb3J0IHsgdG9NYXZlblZlcnNpb25SYW5nZSwgdG9SZWxlYXNlVmVyc2lvbiB9IGZyb20gJy4vdmVyc2lvbi11dGlscyc7XG5cbmltcG9ydCB7IElOQ09NUExFVEVfRElTQ0xBSU1FUl9OT05DT01QSUxJTkcsIFRhcmdldE5hbWUgfSBmcm9tICcuJztcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby12YXItcmVxdWlyZXMsQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0c1xuY29uc3Qgc3BkeExpY2Vuc2VMaXN0ID0gcmVxdWlyZSgnc3BkeC1saWNlbnNlLWxpc3QnKTtcblxuY29uc3QgQlVJTERFUl9DTEFTU19OQU1FID0gJ0J1aWxkZXInO1xuXG5jb25zdCBBTk5fTk9UX05VTEwgPSAnQG9yZy5qZXRicmFpbnMuYW5ub3RhdGlvbnMuTm90TnVsbCc7XG5jb25zdCBBTk5fTlVMTEFCTEUgPSAnQG9yZy5qZXRicmFpbnMuYW5ub3RhdGlvbnMuTnVsbGFibGUnO1xuY29uc3QgQU5OX0lOVEVSTkFMID0gJ0Bzb2Z0d2FyZS5hbWF6b24uanNpaS5JbnRlcm5hbCc7XG5cbi8qKlxuICogQnVpbGQgSmF2YSBwYWNrYWdlcyBhbGwgdG9nZXRoZXIsIGJ5IGdlbmVyYXRpbmcgYW4gYWdncmVnYXRlIFBPTVxuICpcbiAqIFRoaXMgd2lsbCBtYWtlIHRoZSBKYXZhIGJ1aWxkIGEgbG90IG1vcmUgZWZmaWNpZW50ICh+MzAwJSkuXG4gKlxuICogRG8gdGhpcyBieSBjb3B5aW5nIHRoZSBjb2RlIGludG8gYSB0ZW1wb3JhcnkgZGlyZWN0b3J5LCBnZW5lcmF0aW5nIGFuIGFnZ3JlZ2F0ZVxuICogUE9NIHRoZXJlLCBhbmQgdGhlbiBjb3B5aW5nIHRoZSBhcnRpZmFjdHMgYmFjayBpbnRvIHRoZSByZXNwZWN0aXZlIG91dHB1dFxuICogZGlyZWN0b3JpZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBKYXZhQnVpbGRlciBpbXBsZW1lbnRzIFRhcmdldEJ1aWxkZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IHRhcmdldE5hbWUgPSAnamF2YSc7XG5cbiAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgbW9kdWxlczogcmVhZG9ubHkgSnNpaU1vZHVsZVtdLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgb3B0aW9uczogQnVpbGRPcHRpb25zLFxuICApIHt9XG5cbiAgcHVibGljIGFzeW5jIGJ1aWxkTW9kdWxlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5tb2R1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdGlvbnMuY29kZU9ubHkpIHtcbiAgICAgIC8vIFNpbXBsZSwganVzdCBnZW5lcmF0ZSBjb2RlIHRvIHJlc3BlY3RpdmUgb3V0cHV0IGRpcnNcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICB0aGlzLm1vZHVsZXMubWFwKChtb2R1bGUpID0+XG4gICAgICAgICAgdGhpcy5nZW5lcmF0ZU1vZHVsZUNvZGUoXG4gICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgICB0aGlzLm91dHB1dERpcihtb2R1bGUub3V0cHV0RGlyZWN0b3J5KSxcbiAgICAgICAgICApLFxuICAgICAgICApLFxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2UgbWFrZSBhIHNpbmdsZSB0ZW1wZGlyIHRvIGhvbGQgYWxsIHNvdXJjZXMsIGJ1aWxkIHRoZW0gdG9nZXRoZXIgYW5kIGNvcHkgdGhlbSBiYWNrIG91dFxuICAgIGNvbnN0IHNjcmF0Y2hEaXJzOiBBcnJheTxTY3JhdGNoPGFueT4+ID0gW107XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlbXBTb3VyY2VEaXIgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQWdncmVnYXRlU291cmNlRGlyKFxuICAgICAgICB0aGlzLm1vZHVsZXMsXG4gICAgICAgIHRoaXMub3B0aW9ucyxcbiAgICAgICk7XG4gICAgICBzY3JhdGNoRGlycy5wdXNoKHRlbXBTb3VyY2VEaXIpO1xuXG4gICAgICAvLyBOZWVkIGFueSBvbGQgbW9kdWxlIG9iamVjdCB0byBtYWtlIGEgdGFyZ2V0IHRvIGJlIGFibGUgdG8gaW52b2tlIGJ1aWxkLCB0aG91Z2ggbm9uZSBvZiBpdHMgc2V0dGluZ3NcbiAgICAgIC8vIHdpbGwgYmUgdXNlZC5cbiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMubWFrZVRhcmdldCh0aGlzLm1vZHVsZXNbMF0sIHRoaXMub3B0aW9ucyk7XG4gICAgICBjb25zdCB0ZW1wT3V0cHV0RGlyID0gYXdhaXQgU2NyYXRjaC5tYWtlKGFzeW5jIChkaXIpID0+IHtcbiAgICAgICAgbG9nZ2luZy5kZWJ1ZyhgQnVpbGRpbmcgSmF2YSBjb2RlIHRvICR7ZGlyfWApO1xuICAgICAgICBhd2FpdCB0YXJnZXQuYnVpbGQodGVtcFNvdXJjZURpci5kaXJlY3RvcnksIGRpcik7XG4gICAgICB9KTtcbiAgICAgIHNjcmF0Y2hEaXJzLnB1c2godGVtcE91dHB1dERpcik7XG5cbiAgICAgIGF3YWl0IHRoaXMuY29weU91dEFydGlmYWN0cyhcbiAgICAgICAgdGVtcE91dHB1dERpci5kaXJlY3RvcnksXG4gICAgICAgIHRlbXBTb3VyY2VEaXIub2JqZWN0LFxuICAgICAgKTtcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5jbGVhbikge1xuICAgICAgICBhd2FpdCBTY3JhdGNoLmNsZWFudXBBbGwoc2NyYXRjaERpcnMpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dpbmcud2FybihcbiAgICAgICAgYEV4Y2VwdGlvbiBvY2N1cnJlZCwgbm90IGNsZWFuaW5nIHVwICR7c2NyYXRjaERpcnNcbiAgICAgICAgICAubWFwKChzKSA9PiBzLmRpcmVjdG9yeSlcbiAgICAgICAgICAuam9pbignLCAnKX1gLFxuICAgICAgKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU1vZHVsZUNvZGUoXG4gICAgbW9kdWxlOiBKc2lpTW9kdWxlLFxuICAgIG9wdGlvbnM6IEJ1aWxkT3B0aW9ucyxcbiAgICB3aGVyZTogc3RyaW5nLFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzLm1ha2VUYXJnZXQobW9kdWxlLCBvcHRpb25zKTtcbiAgICBsb2dnaW5nLmRlYnVnKGBHZW5lcmF0aW5nIEphdmEgY29kZSBpbnRvICR7d2hlcmV9YCk7XG4gICAgYXdhaXQgdGFyZ2V0LmdlbmVyYXRlQ29kZSh3aGVyZSwgbW9kdWxlLnRhcmJhbGwpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUFnZ3JlZ2F0ZVNvdXJjZURpcihcbiAgICBtb2R1bGVzOiByZWFkb25seSBKc2lpTW9kdWxlW10sXG4gICAgb3B0aW9uczogQnVpbGRPcHRpb25zLFxuICApOiBQcm9taXNlPFNjcmF0Y2g8VGVtcG9yYXJ5SmF2YVBhY2thZ2VbXT4+IHtcbiAgICByZXR1cm4gU2NyYXRjaC5tYWtlKGFzeW5jICh0bXBEaXI6IHN0cmluZykgPT4ge1xuICAgICAgbG9nZ2luZy5kZWJ1ZyhgR2VuZXJhdGluZyBhZ2dyZWdhdGUgSmF2YSBzb3VyY2UgZGlyIGF0ICR7dG1wRGlyfWApO1xuICAgICAgY29uc3QgcmV0OiBUZW1wb3JhcnlKYXZhUGFja2FnZVtdID0gW107XG5cbiAgICAgIGNvbnN0IGdlbmVyYXRlZE1vZHVsZXMgPSBtb2R1bGVzXG4gICAgICAgIC5tYXAoKG1vZHVsZSkgPT4gKHsgbW9kdWxlLCByZWxhdGl2ZU5hbWU6IHNsdWdpZnkobW9kdWxlLm5hbWUpIH0pKVxuICAgICAgICAubWFwKCh7IG1vZHVsZSwgcmVsYXRpdmVOYW1lIH0pID0+ICh7XG4gICAgICAgICAgbW9kdWxlLFxuICAgICAgICAgIHJlbGF0aXZlTmFtZSxcbiAgICAgICAgICBzb3VyY2VEaXI6IHBhdGguam9pbih0bXBEaXIsIHJlbGF0aXZlTmFtZSksXG4gICAgICAgIH0pKVxuICAgICAgICAubWFwKCh7IG1vZHVsZSwgcmVsYXRpdmVOYW1lLCBzb3VyY2VEaXIgfSkgPT5cbiAgICAgICAgICB0aGlzLmdlbmVyYXRlTW9kdWxlQ29kZShtb2R1bGUsIG9wdGlvbnMsIHNvdXJjZURpcikudGhlbigoKSA9PiAoe1xuICAgICAgICAgICAgbW9kdWxlLFxuICAgICAgICAgICAgcmVsYXRpdmVOYW1lLFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgKTtcblxuICAgICAgZm9yIGF3YWl0IChjb25zdCB7IG1vZHVsZSwgcmVsYXRpdmVOYW1lIH0gb2YgZ2VuZXJhdGVkTW9kdWxlcykge1xuICAgICAgICByZXQucHVzaCh7XG4gICAgICAgICAgcmVsYXRpdmVTb3VyY2VEaXI6IHJlbGF0aXZlTmFtZSxcbiAgICAgICAgICByZWxhdGl2ZUFydGlmYWN0c0RpcjogbW9kdWxlQXJ0aWZhY3RzU3ViZGlyKG1vZHVsZSksXG4gICAgICAgICAgb3V0cHV0VGFyZ2V0RGlyZWN0b3J5OiBtb2R1bGUub3V0cHV0RGlyZWN0b3J5LFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5nZW5lcmF0ZUFnZ3JlZ2F0ZVBvbShcbiAgICAgICAgdG1wRGlyLFxuICAgICAgICByZXQubWFwKChtKSA9PiBtLnJlbGF0aXZlU291cmNlRGlyKSxcbiAgICAgICk7XG4gICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlTWF2ZW5TZXR0aW5nc0ZvckxvY2FsRGVwcyh0bXBEaXIpO1xuXG4gICAgICByZXR1cm4gcmV0O1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUFnZ3JlZ2F0ZVBvbSh3aGVyZTogc3RyaW5nLCBtb2R1bGVOYW1lczogc3RyaW5nW10pIHtcbiAgICBjb25zdCBhZ2dyZWdhdGVQb20gPSB4bWxidWlsZGVyXG4gICAgICAuY3JlYXRlKFxuICAgICAgICB7XG4gICAgICAgICAgcHJvamVjdDoge1xuICAgICAgICAgICAgJ0B4bWxucyc6ICdodHRwOi8vbWF2ZW4uYXBhY2hlLm9yZy9QT00vNC4wLjAnLFxuICAgICAgICAgICAgJ0B4bWxuczp4c2knOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UnLFxuICAgICAgICAgICAgJ0B4c2k6c2NoZW1hTG9jYXRpb24nOlxuICAgICAgICAgICAgICAnaHR0cDovL21hdmVuLmFwYWNoZS5vcmcvUE9NLzQuMC4wIGh0dHBzOi8vbWF2ZW4uYXBhY2hlLm9yZy94c2QvbWF2ZW4tNC4wLjAueHNkJyxcbiAgICAgICAgICAgICcjY29tbWVudCc6IFtcbiAgICAgICAgICAgICAgYEdlbmVyYXRlZCBieSBqc2lpLXBhY21ha0Ake1ZFUlNJT05fREVTQ30gb24gJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9YCxcbiAgICAgICAgICAgIF0sXG5cbiAgICAgICAgICAgIG1vZGVsVmVyc2lvbjogJzQuMC4wJyxcbiAgICAgICAgICAgIHBhY2thZ2luZzogJ3BvbScsXG5cbiAgICAgICAgICAgIGdyb3VwSWQ6ICdzb2Z0d2FyZS5hbWF6b24uanNpaScsXG4gICAgICAgICAgICBhcnRpZmFjdElkOiAnYWdncmVnYXRlcG9tJyxcbiAgICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG5cbiAgICAgICAgICAgIG1vZHVsZXM6IHtcbiAgICAgICAgICAgICAgbW9kdWxlOiBtb2R1bGVOYW1lcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBlbmNvZGluZzogJ1VURi04JyB9LFxuICAgICAgKVxuICAgICAgLmVuZCh7IHByZXR0eTogdHJ1ZSB9KTtcblxuICAgIGxvZ2dpbmcuZGVidWcoYEdlbmVyYXRlZCAke3doZXJlfS9wb20ueG1sYCk7XG4gICAgYXdhaXQgZnMud3JpdGVGaWxlKHBhdGguam9pbih3aGVyZSwgJ3BvbS54bWwnKSwgYWdncmVnYXRlUG9tKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY29weU91dEFydGlmYWN0cyhcbiAgICBhcnRpZmFjdHNSb290OiBzdHJpbmcsXG4gICAgcGFja2FnZXM6IFRlbXBvcmFyeUphdmFQYWNrYWdlW10sXG4gICkge1xuICAgIGxvZ2dpbmcuZGVidWcoJ0NvcHlpbmcgb3V0IEphdmEgYXJ0aWZhY3RzJyk7XG4gICAgLy8gVGhlIGFydGlmYWN0cyBkaXJlY3RvcnkgbG9va3MgbGlrZSB0aGlzOlxuICAgIC8vICAvdG1wL1hYWC9zb2Z0d2FyZS9hbWF6b24vYXdzY2RrL3NvbWV0aGluZy92MS4yLjNcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9lbHNlL3YxLjIuM1xuICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL2VudGlyZWx5L3YxLjIuM1xuICAgIC8vXG4gICAgLy8gV2UgZ2V0IHRoZSAnc29mdHdhcmUvYW1hem9uL2F3c2Nkay9zb21ldGhpbmcnIHBhdGggZnJvbSB0aGUgcGFja2FnZSwgaWRlbnRpZnlpbmdcbiAgICAvLyB0aGUgZmlsZXMgd2UgbmVlZCB0byBjb3B5LCBpbmNsdWRpbmcgTWF2ZW4gbWV0YWRhdGEuIEJ1dCB3ZSBuZWVkIHRvIHJlY3JlYXRlXG4gICAgLy8gdGhlIHdob2xlIHBhdGggaW4gdGhlIHRhcmdldCBkaXJlY3RvcnkuXG5cbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIHBhY2thZ2VzLm1hcChhc3luYyAocGtnKSA9PiB7XG4gICAgICAgIGNvbnN0IGFydGlmYWN0c1NvdXJjZSA9IHBhdGguam9pbihcbiAgICAgICAgICBhcnRpZmFjdHNSb290LFxuICAgICAgICAgIHBrZy5yZWxhdGl2ZUFydGlmYWN0c0RpcixcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgYXJ0aWZhY3RzRGVzdCA9IHBhdGguam9pbihcbiAgICAgICAgICB0aGlzLm91dHB1dERpcihwa2cub3V0cHV0VGFyZ2V0RGlyZWN0b3J5KSxcbiAgICAgICAgICBwa2cucmVsYXRpdmVBcnRpZmFjdHNEaXIsXG4gICAgICAgICk7XG5cbiAgICAgICAgYXdhaXQgZnMubWtkaXJwKGFydGlmYWN0c0Rlc3QpO1xuICAgICAgICBhd2FpdCBmcy5jb3B5KGFydGlmYWN0c1NvdXJjZSwgYXJ0aWZhY3RzRGVzdCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIERlY2lkZSB3aGV0aGVyIG9yIG5vdCB0byBhcHBlbmQgJ2phdmEnIHRvIHRoZSBnaXZlbiBvdXRwdXQgZGlyZWN0b3J5XG4gICAqL1xuICBwcml2YXRlIG91dHB1dERpcihkZWNsYXJlZERpcjogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMub3B0aW9ucy5sYW5ndWFnZVN1YmRpcmVjdG9yeVxuICAgICAgPyBwYXRoLmpvaW4oZGVjbGFyZWREaXIsIHRoaXMudGFyZ2V0TmFtZSlcbiAgICAgIDogZGVjbGFyZWREaXI7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIG1hdmVuIHNldHRpbmdzIGZpbGUgZm9yIHRoaXMgYnVpbGQuXG4gICAqIEBwYXJhbSB3aGVyZSBUaGUgZ2VuZXJhdGVkIHNvdXJjZXMgZGlyZWN0b3J5LiBUaGlzIGlzIHdoZXJlIHVzZXIueG1sIHdpbGwgYmUgcGxhY2VkLlxuICAgKiBAcGFyYW0gY3VycmVudE91dHB1dERpcmVjdG9yeSBUaGUgY3VycmVudCBvdXRwdXQgZGlyZWN0b3J5LiBXaWxsIGJlIGFkZGVkIGFzIGEgbG9jYWwgbWF2ZW4gcmVwby5cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVNYXZlblNldHRpbmdzRm9yTG9jYWxEZXBzKHdoZXJlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih3aGVyZSwgJ3VzZXIueG1sJyk7XG5cbiAgICAvLyB0cmF2ZXJzZSB0aGUgZGVwIGdyYXBoIG9mIHRoaXMgbW9kdWxlIGFuZCBmaW5kIGFsbCBtb2R1bGVzIHRoYXQgaGF2ZVxuICAgIC8vIGFuIDxvdXRkaXI+L2phdmEgZGlyZWN0b3J5LiB3ZSB3aWxsIGFkZCB0aG9zZSBhcyBsb2NhbCBtYXZlblxuICAgIC8vIHJlcG9zaXRvcmllcyB3aGljaCB3aWxsIHJlc29sdmUgaW5zdGVhZCBvZiBNYXZlbiBDZW50cmFsIGZvciB0aG9zZVxuICAgIC8vIG1vZHVsZS4gdGhpcyBlbmFibGVzIGJ1aWxkaW5nIGFnYWluc3QgbG9jYWwgbW9kdWxlcyAoaS5lLiBpbiBsZXJuYVxuICAgIC8vIHJlcG9zaXRvcmllcyBvciBsaW5rZWQgbW9kdWxlcykuXG4gICAgY29uc3QgYWxsRGVwc091dHB1dERpcnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAgIGNvbnN0IHJlc29sdmVkTW9kdWxlcyA9IHRoaXMubW9kdWxlcy5tYXAoYXN5bmMgKG1vZCkgPT4gKHtcbiAgICAgIG1vZHVsZTogbW9kLFxuICAgICAgbG9jYWxCdWlsZERpcnM6IGF3YWl0IGZpbmRMb2NhbEJ1aWxkRGlycyhcbiAgICAgICAgbW9kLm1vZHVsZURpcmVjdG9yeSxcbiAgICAgICAgdGhpcy50YXJnZXROYW1lLFxuICAgICAgKSxcbiAgICB9KSk7XG4gICAgZm9yIGF3YWl0IChjb25zdCB7IG1vZHVsZSwgbG9jYWxCdWlsZERpcnMgfSBvZiByZXNvbHZlZE1vZHVsZXMpIHtcbiAgICAgIHNldEV4dGVuZChhbGxEZXBzT3V0cHV0RGlycywgbG9jYWxCdWlsZERpcnMpO1xuXG4gICAgICAvLyBBbHNvIGluY2x1ZGUgb3V0cHV0IGRpcmVjdG9yeSB3aGVyZSB3ZSdyZSBidWlsZGluZyB0bywgaW4gY2FzZSB3ZSBidWlsZCBtdWx0aXBsZSBwYWNrYWdlcyBpbnRvXG4gICAgICAvLyB0aGUgc2FtZSBvdXRwdXQgZGlyZWN0b3J5LlxuICAgICAgYWxsRGVwc091dHB1dERpcnMuYWRkKFxuICAgICAgICBwYXRoLmpvaW4oXG4gICAgICAgICAgbW9kdWxlLm91dHB1dERpcmVjdG9yeSxcbiAgICAgICAgICB0aGlzLm9wdGlvbnMubGFuZ3VhZ2VTdWJkaXJlY3RvcnkgPyB0aGlzLnRhcmdldE5hbWUgOiAnJyxcbiAgICAgICAgKSxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYWxSZXBvcyA9IEFycmF5LmZyb20oYWxsRGVwc091dHB1dERpcnMpO1xuXG4gICAgLy8gaWYgamF2YS1ydW50aW1lIGlzIGNoZWNrZWQtb3V0IGFuZCB3ZSBjYW4gZmluZCBhIGxvY2FsIHJlcG9zaXRvcnksXG4gICAgLy8gYWRkIGl0IHRvIHRoZSBsaXN0LlxuICAgIGNvbnN0IGxvY2FsSmF2YVJ1bnRpbWUgPSBhd2FpdCBmaW5kSmF2YVJ1bnRpbWVMb2NhbFJlcG9zaXRvcnkoKTtcbiAgICBpZiAobG9jYWxKYXZhUnVudGltZSkge1xuICAgICAgbG9jYWxSZXBvcy5wdXNoKGxvY2FsSmF2YVJ1bnRpbWUpO1xuICAgIH1cblxuICAgIGxvZ2dpbmcuZGVidWcoJ2xvY2FsIG1hdmVuIHJlcG9zOicsIGxvY2FsUmVwb3MpO1xuXG4gICAgY29uc3QgcHJvZmlsZU5hbWUgPSAnbG9jYWwtanNpaS1tb2R1bGVzJztcbiAgICBjb25zdCBzZXR0aW5ncyA9IHhtbGJ1aWxkZXJcbiAgICAgIC5jcmVhdGUoXG4gICAgICAgIHtcbiAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgJ0B4bWxucyc6ICdodHRwOi8vbWF2ZW4uYXBhY2hlLm9yZy9QT00vNC4wLjAnLFxuICAgICAgICAgICAgJ0B4bWxuczp4c2knOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UnLFxuICAgICAgICAgICAgJ0B4c2k6c2NoZW1hTG9jYXRpb24nOlxuICAgICAgICAgICAgICAnaHR0cDovL21hdmVuLmFwYWNoZS5vcmcvU0VUVElOR1MvMS4wLjAgaHR0cHM6Ly9tYXZlbi5hcGFjaGUub3JnL3hzZC9zZXR0aW5ncy0xLjAuMC54c2QnLFxuICAgICAgICAgICAgJyNjb21tZW50JzogW1xuICAgICAgICAgICAgICBgR2VuZXJhdGVkIGJ5IGpzaWktcGFjbWFrQCR7VkVSU0lPTl9ERVNDfSBvbiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1gLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIC8vIERvICpub3QqIGF0dGVtcHQgdG8gYXNrIHRoZSB1c2VyIGZvciBzdHVmZi4uLlxuICAgICAgICAgICAgaW50ZXJhY3RpdmVNb2RlOiBmYWxzZSxcbiAgICAgICAgICAgIC8vIFVzZSBhIG5vbi1kZWZhdWx0IGxvY2FsIHJlcG9zaXRvcnkgdG8gaXNvbGF0ZSBmcm9tIGNhY2hlZCBhcnRpZmFjdHMuLi5cbiAgICAgICAgICAgIGxvY2FsUmVwb3NpdG9yeTogcGF0aC5yZXNvbHZlKHdoZXJlLCAnLm0yJywgJ3JlcG9zaXRvcnknKSxcbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGxvY2F0aW9ucyBvZiBsb2NhbGx5LXNvdXJjZWQgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICBwcm9maWxlczoge1xuICAgICAgICAgICAgICBwcm9maWxlOiB7XG4gICAgICAgICAgICAgICAgaWQ6IHByb2ZpbGVOYW1lLFxuICAgICAgICAgICAgICAgIHJlcG9zaXRvcmllczoge1xuICAgICAgICAgICAgICAgICAgcmVwb3NpdG9yeTogbG9jYWxSZXBvcy5tYXAoKHJlcG8pID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiByZXBvLnJlcGxhY2UoL1tcXFxcLzpcIjw+fD8qXS9nLCAnJCcpLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IGBmaWxlOi8vJHtyZXBvfWAsXG4gICAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhY3RpdmVQcm9maWxlczoge1xuICAgICAgICAgICAgICBhY3RpdmVQcm9maWxlOiBwcm9maWxlTmFtZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBlbmNvZGluZzogJ1VURi04JyB9LFxuICAgICAgKVxuICAgICAgLmVuZCh7IHByZXR0eTogdHJ1ZSB9KTtcblxuICAgIGxvZ2dpbmcuZGVidWcoYEdlbmVyYXRlZCAke2ZpbGVQYXRofWApO1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZShmaWxlUGF0aCwgc2V0dGluZ3MpO1xuICAgIHJldHVybiBmaWxlUGF0aDtcbiAgfVxuXG4gIHByaXZhdGUgbWFrZVRhcmdldChtb2R1bGU6IEpzaWlNb2R1bGUsIG9wdGlvbnM6IEJ1aWxkT3B0aW9ucyk6IFRhcmdldCB7XG4gICAgcmV0dXJuIG5ldyBKYXZhKHtcbiAgICAgIHRhcmdldE5hbWU6IHRoaXMudGFyZ2V0TmFtZSxcbiAgICAgIHBhY2thZ2VEaXI6IG1vZHVsZS5tb2R1bGVEaXJlY3RvcnksXG4gICAgICBhc3NlbWJseTogbW9kdWxlLmFzc2VtYmx5LFxuICAgICAgZmluZ2VycHJpbnQ6IG9wdGlvbnMuZmluZ2VycHJpbnQsXG4gICAgICBmb3JjZTogb3B0aW9ucy5mb3JjZSxcbiAgICAgIGFyZ3VtZW50czogb3B0aW9ucy5hcmd1bWVudHMsXG4gICAgICByb3NldHRhOiBvcHRpb25zLnJvc2V0dGEsXG4gICAgfSk7XG4gIH1cbn1cblxuaW50ZXJmYWNlIFRlbXBvcmFyeUphdmFQYWNrYWdlIHtcbiAgLyoqXG4gICAqIFdoZXJlIHRoZSBzb3VyY2VzIGFyZSAocmVsYXRpdmUgdG8gdGhlIHNvdXJjZSByb290KVxuICAgKi9cbiAgcmVsYXRpdmVTb3VyY2VEaXI6IHN0cmluZztcblxuICAvKipcbiAgICogV2hlcmUgdGhlIGFydGlmYWN0cyB3aWxsIGJlIHN0b3JlZCBhZnRlciBidWlsZCAocmVsYXRpdmUgdG8gYnVpbGQgZGlyKVxuICAgKi9cbiAgcmVsYXRpdmVBcnRpZmFjdHNEaXI6IHN0cmluZztcblxuICAvKipcbiAgICogV2hlcmUgdGhlIGFydGlmYWN0cyBvdWdodCB0byBnbyBmb3IgdGhpcyBwYXJ0aWN1bGFyIG1vZHVsZVxuICAgKi9cbiAgb3V0cHV0VGFyZ2V0RGlyZWN0b3J5OiBzdHJpbmc7XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSBzdWJkaXJlY3Rvcnkgb2YgdGhlIG91dHB1dCBkaXJlY3Rvcnkgd2hlcmUgdGhlIGFydGlmYWN0cyBmb3IgdGhpcyBwYXJ0aWN1bGFyIHBhY2thZ2UgYXJlIHByb2R1Y2VkXG4gKi9cbmZ1bmN0aW9uIG1vZHVsZUFydGlmYWN0c1N1YmRpcihtb2R1bGU6IEpzaWlNb2R1bGUpIHtcbiAgY29uc3QgZ3JvdXBJZCA9IG1vZHVsZS5hc3NlbWJseS50YXJnZXRzIS5qYXZhIS5tYXZlbi5ncm91cElkO1xuICBjb25zdCBhcnRpZmFjdElkID0gbW9kdWxlLmFzc2VtYmx5LnRhcmdldHMhLmphdmEhLm1hdmVuLmFydGlmYWN0SWQ7XG4gIHJldHVybiBgJHtncm91cElkLnJlcGxhY2UoL1xcLi9nLCAnLycpfS8ke2FydGlmYWN0SWR9YDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSmF2YSBleHRlbmRzIFRhcmdldCB7XG4gIHB1YmxpYyBzdGF0aWMgdG9QYWNrYWdlSW5mb3MoYXNzbTogc3BlYy5Bc3NlbWJseSk6IHtcbiAgICBbbGFuZ3VhZ2U6IHN0cmluZ106IFBhY2thZ2VJbmZvO1xuICB9IHtcbiAgICBjb25zdCBncm91cElkID0gYXNzbS50YXJnZXRzIS5qYXZhIS5tYXZlbi5ncm91cElkO1xuICAgIGNvbnN0IGFydGlmYWN0SWQgPSBhc3NtLnRhcmdldHMhLmphdmEhLm1hdmVuLmFydGlmYWN0SWQ7XG4gICAgY29uc3QgcmVsZWFzZVZlcnNpb24gPSB0b1JlbGVhc2VWZXJzaW9uKGFzc20udmVyc2lvbiwgVGFyZ2V0TmFtZS5KQVZBKTtcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9yZXBvMS5tYXZlbi5vcmcvbWF2ZW4yLyR7Z3JvdXBJZC5yZXBsYWNlKFxuICAgICAgL1xcLi9nLFxuICAgICAgJy8nLFxuICAgICl9LyR7YXJ0aWZhY3RJZH0vJHthc3NtLnZlcnNpb259L2A7XG4gICAgcmV0dXJuIHtcbiAgICAgIGphdmE6IHtcbiAgICAgICAgcmVwb3NpdG9yeTogJ01hdmVuIENlbnRyYWwnLFxuICAgICAgICB1cmwsXG4gICAgICAgIHVzYWdlOiB7XG4gICAgICAgICAgJ0FwYWNoZSBNYXZlbic6IHtcbiAgICAgICAgICAgIGxhbmd1YWdlOiAneG1sJyxcbiAgICAgICAgICAgIGNvZGU6IHhtbGJ1aWxkZXJcbiAgICAgICAgICAgICAgLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgZGVwZW5kZW5jeTogeyBncm91cElkLCBhcnRpZmFjdElkLCB2ZXJzaW9uOiByZWxlYXNlVmVyc2lvbiB9LFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuZW5kKHsgcHJldHR5OiB0cnVlIH0pXG4gICAgICAgICAgICAgIC5yZXBsYWNlKC88XFw/XFxzKnhtbChcXHNbXj5dKyk/PlxccyovbSwgJycpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ0FwYWNoZSBCdWlsZHInOiBgJyR7Z3JvdXBJZH06JHthcnRpZmFjdElkfTpqYXI6JHtyZWxlYXNlVmVyc2lvbn0nYCxcbiAgICAgICAgICAnQXBhY2hlIEl2eSc6IHtcbiAgICAgICAgICAgIGxhbmd1YWdlOiAneG1sJyxcbiAgICAgICAgICAgIGNvZGU6IHhtbGJ1aWxkZXJcbiAgICAgICAgICAgICAgLmNyZWF0ZSh7XG4gICAgICAgICAgICAgICAgZGVwZW5kZW5jeToge1xuICAgICAgICAgICAgICAgICAgJ0Bncm91cElkJzogZ3JvdXBJZCxcbiAgICAgICAgICAgICAgICAgICdAbmFtZSc6IGFydGlmYWN0SWQsXG4gICAgICAgICAgICAgICAgICAnQHJldic6IHJlbGVhc2VWZXJzaW9uLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5lbmQoeyBwcmV0dHk6IHRydWUgfSlcbiAgICAgICAgICAgICAgLnJlcGxhY2UoLzxcXD9cXHMqeG1sKFxcc1tePl0rKT8+XFxzKi9tLCAnJyksXG4gICAgICAgICAgfSxcbiAgICAgICAgICAnR3Jvb3Z5IEdyYXBlJzogYEBHcmFwZXMoXFxuQEdyYWIoZ3JvdXA9JyR7Z3JvdXBJZH0nLCBtb2R1bGU9JyR7YXJ0aWZhY3RJZH0nLCB2ZXJzaW9uPScke3JlbGVhc2VWZXJzaW9ufScpXFxuKWAsXG4gICAgICAgICAgJ0dyYWRsZSAvIEdyYWlscyc6IGBjb21waWxlICcke2dyb3VwSWR9OiR7YXJ0aWZhY3RJZH06JHtyZWxlYXNlVmVyc2lvbn0nYCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgdG9OYXRpdmVSZWZlcmVuY2UodHlwZTogc3BlYy5UeXBlLCBvcHRpb25zOiBhbnkpIHtcbiAgICBjb25zdCBbLCAuLi5uYW1lXSA9IHR5cGUuZnFuLnNwbGl0KCcuJyk7XG4gICAgcmV0dXJuIHsgamF2YTogYGltcG9ydCAke1tvcHRpb25zLnBhY2thZ2UsIC4uLm5hbWVdLmpvaW4oJy4nKX07YCB9O1xuICB9XG5cbiAgcHJvdGVjdGVkIHJlYWRvbmx5IGdlbmVyYXRvcjogSmF2YUdlbmVyYXRvcjtcblxuICBwdWJsaWMgY29uc3RydWN0b3Iob3B0aW9uczogVGFyZ2V0T3B0aW9ucykge1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgdGhpcy5nZW5lcmF0b3IgPSBuZXcgSmF2YUdlbmVyYXRvcihvcHRpb25zLnJvc2V0dGEpO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGJ1aWxkKHNvdXJjZURpcjogc3RyaW5nLCBvdXREaXI6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHVybCA9IGBmaWxlOi8vJHtvdXREaXJ9YDtcbiAgICBjb25zdCBtdm5Bcmd1bWVudHMgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xuICAgIGZvciAoY29uc3QgYXJnIG9mIE9iamVjdC5rZXlzKHRoaXMuYXJndW1lbnRzKSkge1xuICAgICAgaWYgKCFhcmcuc3RhcnRzV2l0aCgnbXZuLScpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgbXZuQXJndW1lbnRzLnB1c2goYC0tJHthcmcuc2xpY2UoNCl9YCk7XG4gICAgICBtdm5Bcmd1bWVudHMucHVzaCh0aGlzLmFyZ3VtZW50c1thcmddLnRvU3RyaW5nKCkpO1xuICAgIH1cblxuICAgIGF3YWl0IHNoZWxsKFxuICAgICAgJ212bicsXG4gICAgICBbXG4gICAgICAgIC8vIElmIHdlIGRvbid0IHJ1biBpbiB2ZXJib3NlIG1vZGUsIHR1cm4gb24gcXVpZXQgbW9kZVxuICAgICAgICAuLi4odGhpcy5hcmd1bWVudHMudmVyYm9zZSA/IFtdIDogWyctLXF1aWV0J10pLFxuICAgICAgICAnLS1iYXRjaC1tb2RlJyxcbiAgICAgICAgLi4ubXZuQXJndW1lbnRzLFxuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAgYC1EPWFsdERlcGxveW1lbnRSZXBvc2l0b3J5PWxvY2FsOjpkZWZhdWx0Ojoke3VybH1gLFxuICAgICAgICAnLS1zZXR0aW5ncz11c2VyLnhtbCcsXG4gICAgICBdLFxuICAgICAge1xuICAgICAgICBjd2Q6IHNvdXJjZURpcixcbiAgICAgICAgZW52OiB7XG4gICAgICAgICAgLy8gVHdpZGRsZSB0aGUgSlZNIHNldHRpbmdzIGEgbGl0dGxlIGZvciBNYXZlbi4gRGVsYXlpbmcgSklUIGNvbXBpbGF0aW9uXG4gICAgICAgICAgLy8gYnJpbmdzIGRvd24gTWF2ZW4gZXhlY3V0aW9uIHRpbWUgYnkgYWJvdXQgMS8zcmQgKDE1LT4xMHMsIDMwLT4yMHMpXG4gICAgICAgICAgTUFWRU5fT1BUUzogYCR7XG4gICAgICAgICAgICBwcm9jZXNzLmVudi5NQVZFTl9PUFRTID8/ICcnXG4gICAgICAgICAgfSAtWFg6K1RpZXJlZENvbXBpbGF0aW9uIC1YWDpUaWVyZWRTdG9wQXRMZXZlbD0xYCxcbiAgICAgICAgfSxcbiAgICAgICAgcmV0cnk6IHsgbWF4QXR0ZW1wdHM6IDUgfSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfVxufVxuXG4vLyAjIyMjIyMjIyMjIyMjIyMjIyNcbi8vICMgQ09ERSBHRU5FUkFUT1IgI1xuLy8gIyMjIyMjIyMjIyMjIyMjIyMjXG5cbmNvbnN0IE1PRFVMRV9DTEFTU19OQU1FID0gJyRNb2R1bGUnO1xuY29uc3QgSU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUUgPSAnSnNpaSRQcm94eSc7XG5jb25zdCBJTlRFUkZBQ0VfREVGQVVMVF9DTEFTU19OQU1FID0gJ0pzaWkkRGVmYXVsdCc7XG5cbi8vIFN0cnVjdCB0aGF0IHN0b3JlcyBtZXRhZGF0YSBhYm91dCBhIHByb3BlcnR5IHRoYXQgY2FuIGJlIHVzZWQgaW4gSmF2YSBjb2RlIGdlbmVyYXRpb24uXG5pbnRlcmZhY2UgSmF2YVByb3Age1xuICAvLyBEb2N1bWVudGF0aW9uIGZvciB0aGUgcHJvcGVydHlcbiAgZG9jcz86IHNwZWMuRG9jcztcblxuICAvLyBUaGUgb3JpZ2luYWwgSlNJSSBwcm9wZXJ0eSBzcGVjIHRoaXMgc3RydWN0IHdhcyBkZXJpdmVkIGZyb21cbiAgc3BlYzogc3BlYy5Qcm9wZXJ0eTtcblxuICAvLyBUaGUgb3JpZ2luYWwgSlNJSSB0eXBlIHRoaXMgcHJvcGVydHkgd2FzIGRlZmluZWQgb25cbiAgZGVmaW5pbmdUeXBlOiBzcGVjLlR5cGU7XG5cbiAgLy8gQ2Fub25pY2FsIG5hbWUgb2YgdGhlIEphdmEgcHJvcGVydHkgKGVnOiAnTXlQcm9wZXJ0eScpXG4gIHByb3BOYW1lOiBzdHJpbmc7XG5cbiAgLy8gVGhlIG9yaWdpbmFsIGNhbm9uaWNhbCBuYW1lIG9mIHRoZSBKU0lJIHByb3BlcnR5XG4gIGpzaWlOYW1lOiBzdHJpbmc7XG5cbiAgLy8gRmllbGQgbmFtZSBvZiB0aGUgSmF2YSBwcm9wZXJ0eSAoZWc6ICdteVByb3BlcnR5JylcbiAgZmllbGROYW1lOiBzdHJpbmc7XG5cbiAgLy8gVGhlIGphdmEgdHlwZSBmb3IgdGhlIHByb3BlcnR5IChlZzogJ0xpc3Q8U3RyaW5nPicpXG4gIGZpZWxkSmF2YVR5cGU6IHN0cmluZztcblxuICAvLyBUaGUgamF2YSB0eXBlIGZvciB0aGUgcGFyYW1ldGVyIChlLmc6ICdMaXN0PD8gZXh0ZW5kcyBTb21lVHlwZT4nKVxuICBwYXJhbUphdmFUeXBlOiBzdHJpbmc7XG5cbiAgLy8gVGhlIE5hdGl2ZVR5cGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIHByb3BlcnR5J3MgdHlwZVxuICBmaWVsZE5hdGl2ZVR5cGU6IHN0cmluZztcblxuICAvLyBUaGUgcmF3IGNsYXNzIHR5cGUgb2YgdGhlIHByb3BlcnR5IHRoYXQgY2FuIGJlIHVzZWQgZm9yIG1hcnNoYWxsaW5nIChlZzogJ0xpc3QuY2xhc3MnKVxuICBmaWVsZEphdmFDbGFzczogc3RyaW5nO1xuXG4gIC8vIExpc3Qgb2YgdHlwZXMgdGhhdCB0aGUgcHJvcGVydHkgaXMgYXNzaWduYWJsZSBmcm9tLiBVc2VkIHRvIG92ZXJsb2FkIHNldHRlcnMuXG4gIGphdmFUeXBlczogc3RyaW5nW107XG5cbiAgLy8gVHJ1ZSBpZiB0aGUgcHJvcGVydHkgaXMgb3B0aW9uYWwuXG4gIG51bGxhYmxlOiBib29sZWFuO1xuXG4gIC8vIFRydWUgaWYgdGhlIHByb3BlcnR5IGhhcyBiZWVuIHRyYW5zaXRpdmVseSBpbmhlcml0ZWQgZnJvbSBhIGJhc2UgY2xhc3MuXG4gIGluaGVyaXRlZDogYm9vbGVhbjtcblxuICAvLyBUcnVlIGlmIHRoZSBwcm9wZXJ0eSBpcyByZWFkLW9ubHkgb25jZSBpbml0aWFsaXplZC5cbiAgaW1tdXRhYmxlOiBib29sZWFuO1xufVxuXG5jbGFzcyBKYXZhR2VuZXJhdG9yIGV4dGVuZHMgR2VuZXJhdG9yIHtcbiAgLy8gV2hlbiB0aGUgY29kZS1nZW5lcmF0b3IgbmVlZHMgdG8gZ2VuZXJhdGUgY29kZSBmb3IgYSBwcm9wZXJ0eSBvciBtZXRob2QgdGhhdCBoYXMgdGhlIHNhbWUgbmFtZSBhcyBhIG1lbWJlciBvZiB0aGlzIGxpc3QsIHRoZSBuYW1lIHdpbGxcbiAgLy8gYmUgYXV0b21hdGljYWxseSBtb2RpZmllZCB0byBhdm9pZCBjb21waWxlIGVycm9ycy4gTW9zdCBvZiB0aGVzZSBhcmUgamF2YSBsYW5ndWFnZSByZXNlcnZlZCBrZXl3b3Jkcy4gSW4gYWRkaXRpb24gdG8gdGhvc2UsIGFueSBrZXl3b3JkcyB0aGF0XG4gIC8vIGFyZSBsaWtlbHkgdG8gY29uZmxpY3Qgd2l0aCBhdXRvLWdlbmVyYXRlZCBtZXRob2RzIG9yIHByb3BlcnRpZXMgKGVnOiAnYnVpbGQnKSBhcmUgYWxzbyBjb25zaWRlcmVkIHJlc2VydmVkLlxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBSRVNFUlZFRF9LRVlXT1JEUyA9IFtcbiAgICAnYWJzdHJhY3QnLFxuICAgICdhc3NlcnQnLFxuICAgICdib29sZWFuJyxcbiAgICAnYnJlYWsnLFxuICAgICdidWlsZCcsXG4gICAgJ2J5dGUnLFxuICAgICdjYXNlJyxcbiAgICAnY2F0Y2gnLFxuICAgICdjaGFyJyxcbiAgICAnY2xhc3MnLFxuICAgICdjb25zdCcsXG4gICAgJ2NvbnRpbnVlJyxcbiAgICAnZGVmYXVsdCcsXG4gICAgJ2RvdWJsZScsXG4gICAgJ2RvJyxcbiAgICAnZWxzZScsXG4gICAgJ2VudW0nLFxuICAgICdleHRlbmRzJyxcbiAgICAnZmFsc2UnLFxuICAgICdmaW5hbCcsXG4gICAgJ2ZpbmFsbHknLFxuICAgICdmbG9hdCcsXG4gICAgJ2ZvcicsXG4gICAgJ2dvdG8nLFxuICAgICdpZicsXG4gICAgJ2ltcGxlbWVudHMnLFxuICAgICdpbXBvcnQnLFxuICAgICdpbnN0YW5jZW9mJyxcbiAgICAnaW50JyxcbiAgICAnaW50ZXJmYWNlJyxcbiAgICAnbG9uZycsXG4gICAgJ25hdGl2ZScsXG4gICAgJ25ldycsXG4gICAgJ251bGwnLFxuICAgICdwYWNrYWdlJyxcbiAgICAncHJpdmF0ZScsXG4gICAgJ3Byb3RlY3RlZCcsXG4gICAgJ3B1YmxpYycsXG4gICAgJ3JldHVybicsXG4gICAgJ3Nob3J0JyxcbiAgICAnc3RhdGljJyxcbiAgICAnc3RyaWN0ZnAnLFxuICAgICdzdXBlcicsXG4gICAgJ3N3aXRjaCcsXG4gICAgJ3N5bmNocm9uaXplZCcsXG4gICAgJ3RoaXMnLFxuICAgICd0aHJvdycsXG4gICAgJ3Rocm93cycsXG4gICAgJ3RyYW5zaWVudCcsXG4gICAgJ3RydWUnLFxuICAgICd0cnknLFxuICAgICd2b2lkJyxcbiAgICAndm9sYXRpbGUnLFxuICAgICd3aGlsZScsXG4gIF07XG5cbiAgLyoqXG4gICAqIFR1cm5zIGEgcmF3IGphdmFzY3JpcHQgcHJvcGVydHkgbmFtZSAoZWc6ICdkZWZhdWx0JykgaW50byBhIHNhZmUgSmF2YSBwcm9wZXJ0eSBuYW1lIChlZzogJ2RlZmF1bHRWYWx1ZScpLlxuICAgKiBAcGFyYW0gcHJvcGVydHlOYW1lIHRoZSByYXcgSlNJSSBwcm9wZXJ0eSBOYW1lXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBzYWZlSmF2YVByb3BlcnR5TmFtZShwcm9wZXJ0eU5hbWU6IHN0cmluZykge1xuICAgIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgICByZXR1cm4gcHJvcGVydHlOYW1lO1xuICAgIH1cblxuICAgIGlmIChKYXZhR2VuZXJhdG9yLlJFU0VSVkVEX0tFWVdPUkRTLmluY2x1ZGVzKHByb3BlcnR5TmFtZSkpIHtcbiAgICAgIHJldHVybiBgJHtwcm9wZXJ0eU5hbWV9VmFsdWVgO1xuICAgIH1cbiAgICByZXR1cm4gcHJvcGVydHlOYW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIFR1cm5zIGEgcmF3IGphdmFzY3JpcHQgbWV0aG9kIG5hbWUgKGVnOiAnaW1wb3J0JykgaW50byBhIHNhZmUgSmF2YSBtZXRob2QgbmFtZSAoZWc6ICdkb0ltcG9ydCcpLlxuICAgKiBAcGFyYW0gbWV0aG9kTmFtZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgc2FmZUphdmFNZXRob2ROYW1lKG1ldGhvZE5hbWU6IHN0cmluZykge1xuICAgIGlmICghbWV0aG9kTmFtZSkge1xuICAgICAgcmV0dXJuIG1ldGhvZE5hbWU7XG4gICAgfVxuXG4gICAgaWYgKEphdmFHZW5lcmF0b3IuUkVTRVJWRURfS0VZV09SRFMuaW5jbHVkZXMobWV0aG9kTmFtZSkpIHtcbiAgICAgIHJldHVybiBgZG8ke2pzaWlUb1Bhc2NhbENhc2UobWV0aG9kTmFtZSl9YDtcbiAgICB9XG4gICAgcmV0dXJuIG1ldGhvZE5hbWU7XG4gIH1cblxuICAvKiogSWYgZmFsc2UsIEBHZW5lcmF0ZWQgd2lsbCBub3QgaW5jbHVkZSBnZW5lcmF0b3IgdmVyc2lvbiBub3IgdGltZXN0YW1wICovXG4gIHByaXZhdGUgZW1pdEZ1bGxHZW5lcmF0b3JJbmZvPzogYm9vbGVhbjtcbiAgcHJpdmF0ZSBtb2R1bGVDbGFzcyE6IHN0cmluZztcblxuICAvKipcbiAgICogQSBtYXAgb2YgYWxsIHRoZSBtb2R1bGVzIGV2ZXIgcmVmZXJlbmNlZCBkdXJpbmcgY29kZSBnZW5lcmF0aW9uLiBUaGVzZSBpbmNsdWRlXG4gICAqIGRpcmVjdCBkZXBlbmRlbmNpZXMgYnV0IGNhbiBwb3RlbnRpYWxseSBhbHNvIGluY2x1ZGUgdHJhbnNpdGl2ZSBkZXBlbmRlbmNpZXMsIHdoZW4sXG4gICAqIGZvciBleGFtcGxlLCB3ZSBuZWVkIHRvIHJlZmVyIHRvIHRoZWlyIHR5cGVzIHdoZW4gZmxhdHRpbmcgdGhlIGNsYXNzIGhpZXJhcmNoeSBmb3JcbiAgICogaW50ZXJmYWNlIHByb3hpZXMuXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IHJlZmVyZW5jZWRNb2R1bGVzOiB7XG4gICAgW25hbWU6IHN0cmluZ106IHNwZWMuQXNzZW1ibHlDb25maWd1cmF0aW9uO1xuICB9ID0ge307XG5cbiAgcHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgcm9zZXR0YTogUm9zZXR0YSkge1xuICAgIHN1cGVyKHsgZ2VuZXJhdGVPdmVybG9hZHNGb3JNZXRob2RXaXRoT3B0aW9uYWxzOiB0cnVlIH0pO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uQmVnaW5Bc3NlbWJseShhc3NtOiBzcGVjLkFzc2VtYmx5LCBmaW5nZXJwcmludDogYm9vbGVhbikge1xuICAgIHRoaXMuZW1pdEZ1bGxHZW5lcmF0b3JJbmZvID0gZmluZ2VycHJpbnQ7XG4gICAgdGhpcy5tb2R1bGVDbGFzcyA9IHRoaXMuZW1pdE1vZHVsZUZpbGUoYXNzbSk7XG5cbiAgICB0aGlzLmVtaXRBc3NlbWJseVBhY2thZ2VJbmZvKGFzc20pO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uRW5kQXNzZW1ibHkoYXNzbTogc3BlYy5Bc3NlbWJseSwgZmluZ2VycHJpbnQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmVtaXRNYXZlblBvbShhc3NtLCBmaW5nZXJwcmludCk7XG4gICAgZGVsZXRlIHRoaXMuZW1pdEZ1bGxHZW5lcmF0b3JJbmZvO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldEFzc2VtYmx5T3V0cHV0RGlyKG1vZDogc3BlYy5Bc3NlbWJseSkge1xuICAgIGNvbnN0IGRpciA9IHRoaXMudG9OYXRpdmVGcW4obW9kLm5hbWUpLnJlcGxhY2UoL1xcLi9nLCAnLycpO1xuICAgIHJldHVybiBwYXRoLmpvaW4oJ3NyYycsICdtYWluJywgJ3Jlc291cmNlcycsIGRpcik7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25CZWdpbkNsYXNzKGNsczogc3BlYy5DbGFzc1R5cGUsIGFic3RyYWN0OiBib29sZWFuKSB7XG4gICAgdGhpcy5vcGVuRmlsZUlmTmVlZGVkKGNscyk7XG4gICAgdGhpcy5hZGRKYXZhRG9jcyhjbHMsIHsgYXBpOiAndHlwZScsIGZxbjogY2xzLmZxbiB9KTtcblxuICAgIGNvbnN0IGNsYXNzQmFzZSA9IHRoaXMuZ2V0Q2xhc3NCYXNlKGNscyk7XG4gICAgY29uc3QgZXh0ZW5kc0V4cHJlc3Npb24gPSBjbGFzc0Jhc2UgPyBgIGV4dGVuZHMgJHtjbGFzc0Jhc2V9YCA6ICcnO1xuXG4gICAgbGV0IGltcGxlbWVudHNFeHByID0gJyc7XG4gICAgaWYgKGNscy5pbnRlcmZhY2VzPy5sZW5ndGggPz8gMCA+IDApIHtcbiAgICAgIGltcGxlbWVudHNFeHByID0gYCBpbXBsZW1lbnRzICR7Y2xzXG4gICAgICAgIC5pbnRlcmZhY2VzIS5tYXAoKHgpID0+IHRoaXMudG9OYXRpdmVGcW4oeCkpXG4gICAgICAgIC5qb2luKCcsICcpfWA7XG4gICAgfVxuXG4gICAgY29uc3QgbmVzdGVkID0gdGhpcy5pc05lc3RlZChjbHMpO1xuICAgIGNvbnN0IGlubmVyID0gbmVzdGVkID8gJyBzdGF0aWMnIDogJyc7XG4gICAgY29uc3QgYWJzUHJlZml4ID0gYWJzdHJhY3QgPyAnIGFic3RyYWN0JyA6ICcnO1xuXG4gICAgaWYgKCFuZXN0ZWQpIHtcbiAgICAgIHRoaXMuZW1pdEdlbmVyYXRlZEFubm90YXRpb24oKTtcbiAgICB9XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMoY2xzKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGBAc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaShtb2R1bGUgPSAke3RoaXMubW9kdWxlQ2xhc3N9LmNsYXNzLCBmcW4gPSBcIiR7Y2xzLmZxbn1cIilgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwdWJsaWMke2lubmVyfSR7YWJzUHJlZml4fSBjbGFzcyAke2Nscy5uYW1lfSR7ZXh0ZW5kc0V4cHJlc3Npb259JHtpbXBsZW1lbnRzRXhwcn1gLFxuICAgICk7XG5cbiAgICB0aGlzLmVtaXRKc2lpSW5pdGlhbGl6ZXJzKGNscyk7XG4gICAgdGhpcy5lbWl0U3RhdGljSW5pdGlhbGl6ZXIoY2xzKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvbkVuZENsYXNzKGNsczogc3BlYy5DbGFzc1R5cGUpIHtcbiAgICBpZiAoY2xzLmFic3RyYWN0KSB7XG4gICAgICBjb25zdCB0eXBlID0gdGhpcy5yZWZsZWN0QXNzZW1ibHkuZmluZFR5cGUoY2xzLmZxbikgYXMgcmVmbGVjdC5DbGFzc1R5cGU7XG4gICAgICB0aGlzLmVtaXRQcm94eSh0eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbWl0Q2xhc3NCdWlsZGVyKGNscyk7XG4gICAgfVxuXG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB0aGlzLmNsb3NlRmlsZUlmTmVlZGVkKGNscyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25Jbml0aWFsaXplcihjbHM6IHNwZWMuQ2xhc3NUeXBlLCBtZXRob2Q6IHNwZWMuSW5pdGlhbGl6ZXIpIHtcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuXG4gICAgLy8gSWYgbmVlZGVkLCBwYXRjaGluZyB1cCB0aGUgZG9jdW1lbnRhdGlvbiB0byBwb2ludCB1c2VycyBhdCB0aGUgYnVpbGRlciBwYXR0ZXJuXG4gICAgdGhpcy5hZGRKYXZhRG9jcyhtZXRob2QsIHsgYXBpOiAnaW5pdGlhbGl6ZXInLCBmcW46IGNscy5mcW4gfSk7XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMobWV0aG9kKTtcblxuICAgIC8vIEFic3RyYWN0IGNsYXNzZXMgc2hvdWxkIGhhdmUgcHJvdGVjdGVkIGluaXRpYWxpemVyc1xuICAgIGNvbnN0IGluaXRpYWxpemVyQWNjZXNzTGV2ZWwgPSBjbHMuYWJzdHJhY3RcbiAgICAgID8gJ3Byb3RlY3RlZCdcbiAgICAgIDogdGhpcy5yZW5kZXJBY2Nlc3NMZXZlbChtZXRob2QpO1xuXG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGAke2luaXRpYWxpemVyQWNjZXNzTGV2ZWx9ICR7Y2xzLm5hbWV9KCR7dGhpcy5yZW5kZXJNZXRob2RQYXJhbWV0ZXJzKFxuICAgICAgICBtZXRob2QsXG4gICAgICApfSlgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnc3VwZXIoc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdC5Jbml0aWFsaXphdGlvbk1vZGUuSlNJSSk7JyxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlFbmdpbmUuZ2V0SW5zdGFuY2UoKS5jcmVhdGVOZXdPYmplY3QodGhpcyR7dGhpcy5yZW5kZXJNZXRob2RDYWxsQXJndW1lbnRzKFxuICAgICAgICBtZXRob2QsXG4gICAgICApfSk7YCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25Jbml0aWFsaXplck92ZXJsb2FkKFxuICAgIGNsczogc3BlYy5DbGFzc1R5cGUsXG4gICAgb3ZlcmxvYWQ6IHNwZWMuTWV0aG9kLFxuICAgIF9vcmlnaW5hbEluaXRpYWxpemVyOiBzcGVjLk1ldGhvZCxcbiAgKSB7XG4gICAgdGhpcy5vbkluaXRpYWxpemVyKGNscywgb3ZlcmxvYWQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uRmllbGQoXG4gICAgX2Nsczogc3BlYy5DbGFzc1R5cGUsXG4gICAgX3Byb3A6IHNwZWMuUHJvcGVydHksXG4gICAgX3VuaW9uPzogc3BlYy5VbmlvblR5cGVSZWZlcmVuY2UsXG4gICkge1xuICAgIC8qIG5vb3AgKi9cbiAgfVxuXG4gIHByb3RlY3RlZCBvblByb3BlcnR5KGNsczogc3BlYy5DbGFzc1R5cGUsIHByb3A6IHNwZWMuUHJvcGVydHkpIHtcbiAgICB0aGlzLmVtaXRQcm9wZXJ0eShjbHMsIHByb3AsIGNscyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25TdGF0aWNQcm9wZXJ0eShjbHM6IHNwZWMuQ2xhc3NUeXBlLCBwcm9wOiBzcGVjLlByb3BlcnR5KSB7XG4gICAgaWYgKHByb3AuY29uc3QpIHtcbiAgICAgIHRoaXMuZW1pdENvbnN0UHJvcGVydHkoY2xzLCBwcm9wKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbWl0UHJvcGVydHkoY2xzLCBwcm9wLCBjbHMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTaW5jZSB3ZSBleHBhbmQgdGhlIHVuaW9uIHNldHRlcnMsIHdlIHdpbGwgdXNlIHRoaXMgZXZlbnQgdG8gb25seSBlbWl0IHRoZSBnZXR0ZXIgd2hpY2ggcmV0dXJucyBhbiBPYmplY3QuXG4gICAqL1xuICBwcm90ZWN0ZWQgb25VbmlvblByb3BlcnR5KFxuICAgIGNsczogc3BlYy5DbGFzc1R5cGUsXG4gICAgcHJvcDogc3BlYy5Qcm9wZXJ0eSxcbiAgICBfdW5pb246IHNwZWMuVW5pb25UeXBlUmVmZXJlbmNlLFxuICApIHtcbiAgICB0aGlzLmVtaXRQcm9wZXJ0eShjbHMsIHByb3AsIGNscyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25NZXRob2QoY2xzOiBzcGVjLkNsYXNzVHlwZSwgbWV0aG9kOiBzcGVjLk1ldGhvZCkge1xuICAgIHRoaXMuZW1pdE1ldGhvZChjbHMsIG1ldGhvZCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25NZXRob2RPdmVybG9hZChcbiAgICBjbHM6IHNwZWMuQ2xhc3NUeXBlLFxuICAgIG92ZXJsb2FkOiBzcGVjLk1ldGhvZCxcbiAgICBfb3JpZ2luYWxNZXRob2Q6IHNwZWMuTWV0aG9kLFxuICApIHtcbiAgICB0aGlzLm9uTWV0aG9kKGNscywgb3ZlcmxvYWQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uU3RhdGljTWV0aG9kKGNsczogc3BlYy5DbGFzc1R5cGUsIG1ldGhvZDogc3BlYy5NZXRob2QpIHtcbiAgICB0aGlzLmVtaXRNZXRob2QoY2xzLCBtZXRob2QpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uU3RhdGljTWV0aG9kT3ZlcmxvYWQoXG4gICAgY2xzOiBzcGVjLkNsYXNzVHlwZSxcbiAgICBvdmVybG9hZDogc3BlYy5NZXRob2QsXG4gICAgX29yaWdpbmFsTWV0aG9kOiBzcGVjLk1ldGhvZCxcbiAgKSB7XG4gICAgdGhpcy5lbWl0TWV0aG9kKGNscywgb3ZlcmxvYWQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uQmVnaW5FbnVtKGVubTogc3BlYy5FbnVtVHlwZSkge1xuICAgIHRoaXMub3BlbkZpbGVJZk5lZWRlZChlbm0pO1xuICAgIHRoaXMuYWRkSmF2YURvY3MoZW5tLCB7IGFwaTogJ3R5cGUnLCBmcW46IGVubS5mcW4gfSk7XG4gICAgaWYgKCF0aGlzLmlzTmVzdGVkKGVubSkpIHtcbiAgICAgIHRoaXMuZW1pdEdlbmVyYXRlZEFubm90YXRpb24oKTtcbiAgICB9XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMoZW5tKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGBAc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaShtb2R1bGUgPSAke3RoaXMubW9kdWxlQ2xhc3N9LmNsYXNzLCBmcW4gPSBcIiR7ZW5tLmZxbn1cIilgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhgcHVibGljIGVudW0gJHtlbm0ubmFtZX1gKTtcbiAgfVxuICBwcm90ZWN0ZWQgb25FbmRFbnVtKGVubTogc3BlYy5FbnVtVHlwZSkge1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgdGhpcy5jbG9zZUZpbGVJZk5lZWRlZChlbm0pO1xuICB9XG4gIHByb3RlY3RlZCBvbkVudW1NZW1iZXIocGFyZW50VHlwZTogc3BlYy5FbnVtVHlwZSwgbWVtYmVyOiBzcGVjLkVudW1NZW1iZXIpIHtcbiAgICB0aGlzLmFkZEphdmFEb2NzKG1lbWJlciwge1xuICAgICAgYXBpOiAnbWVtYmVyJyxcbiAgICAgIGZxbjogcGFyZW50VHlwZS5mcW4sXG4gICAgICBtZW1iZXJOYW1lOiBtZW1iZXIubmFtZSxcbiAgICB9KTtcbiAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhtZW1iZXIpO1xuICAgIHRoaXMuY29kZS5saW5lKGAke21lbWJlci5uYW1lfSxgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBOYW1lc3BhY2VzIGFyZSBoYW5kbGVkIGltcGxpY2l0bHkgYnkgb25CZWdpbkNsYXNzKCkuXG4gICAqXG4gICAqIE9ubHkgZW1pdCBwYWNrYWdlLWluZm8gaW4gY2FzZSB0aGlzIGlzIGEgc3VibW9kdWxlXG4gICAqL1xuICBwcm90ZWN0ZWQgb25CZWdpbk5hbWVzcGFjZShuczogc3RyaW5nKSB7XG4gICAgY29uc3Qgc3VibW9kdWxlID0gdGhpcy5hc3NlbWJseS5zdWJtb2R1bGVzPy5bbnNdO1xuICAgIGlmIChzdWJtb2R1bGUpIHtcbiAgICAgIHRoaXMuZW1pdFN1Ym1vZHVsZVBhY2thZ2VJbmZvKHRoaXMuYXNzZW1ibHksIG5zKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgb25FbmROYW1lc3BhY2UoX25zOiBzdHJpbmcpIHtcbiAgICAvKiBub29wICovXG4gIH1cblxuICBwcm90ZWN0ZWQgb25CZWdpbkludGVyZmFjZShpZmM6IHNwZWMuSW50ZXJmYWNlVHlwZSkge1xuICAgIHRoaXMub3BlbkZpbGVJZk5lZWRlZChpZmMpO1xuICAgIHRoaXMuYWRkSmF2YURvY3MoaWZjLCB7IGFwaTogJ3R5cGUnLCBmcW46IGlmYy5mcW4gfSk7XG5cbiAgICAvLyBhbGwgaW50ZXJmYWNlcyBhbHdheXMgZXh0ZW5kIEpzaWlJbnRlcmZhY2Ugc28gd2UgY2FuIGlkZW50aWZ5IHRoYXQgaXQgaXMgYSBqc2lpIGludGVyZmFjZS5cbiAgICBjb25zdCBpbnRlcmZhY2VzID0gaWZjLmludGVyZmFjZXMgPz8gW107XG4gICAgY29uc3QgYmFzZXMgPSBbXG4gICAgICAnc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaVNlcmlhbGl6YWJsZScsXG4gICAgICAuLi5pbnRlcmZhY2VzLm1hcCgoeCkgPT4gdGhpcy50b05hdGl2ZUZxbih4KSksXG4gICAgXS5qb2luKCcsICcpO1xuXG4gICAgY29uc3QgbmVzdGVkID0gdGhpcy5pc05lc3RlZChpZmMpO1xuICAgIGNvbnN0IGlubmVyID0gbmVzdGVkID8gJyBzdGF0aWMnIDogJyc7XG4gICAgaWYgKCFuZXN0ZWQpIHtcbiAgICAgIHRoaXMuZW1pdEdlbmVyYXRlZEFubm90YXRpb24oKTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgQHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWkobW9kdWxlID0gJHt0aGlzLm1vZHVsZUNsYXNzfS5jbGFzcywgZnFuID0gXCIke2lmYy5mcW59XCIpYCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYEBzb2Z0d2FyZS5hbWF6b24uanNpaS5Kc2lpLlByb3h5KCR7aWZjLm5hbWV9LiR7SU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUV9LmNsYXNzKWAsXG4gICAgKTtcbiAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhpZmMpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICBgcHVibGljJHtpbm5lcn0gaW50ZXJmYWNlICR7aWZjLm5hbWV9IGV4dGVuZHMgJHtiYXNlc31gLFxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb25FbmRJbnRlcmZhY2UoaWZjOiBzcGVjLkludGVyZmFjZVR5cGUpIHtcbiAgICB0aGlzLmVtaXRNdWx0aXBseUluaGVyaXRlZE9wdGlvbmFsUHJvcGVydGllcyhpZmMpO1xuXG4gICAgaWYgKGlmYy5kYXRhdHlwZSkge1xuICAgICAgdGhpcy5lbWl0RGF0YVR5cGUoaWZjKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdHlwZSA9IHRoaXMucmVmbGVjdEFzc2VtYmx5LmZpbmRUeXBlKFxuICAgICAgICBpZmMuZnFuLFxuICAgICAgKSBhcyByZWZsZWN0LkludGVyZmFjZVR5cGU7XG5cbiAgICAgIHRoaXMuZW1pdFByb3h5KHR5cGUpO1xuICAgICAgLy8gV2UgZG9uJ3QgZW1pdCBKc2lpJERlZmF1bHQgaWYgdGhlIGFzc2VtYmx5IG9wdGVkIG91dCBvZiBpdCBleHBsaWNpdGx5LlxuICAgICAgLy8gVGhpcyBpcyBtb3N0bHkgdG8gZmFjaWxpdGF0ZSBjb21wYXRpYmlsaXR5IHRlc3RpbmcuLi5cbiAgICAgIGlmIChoYXNEZWZhdWx0SW50ZXJmYWNlcyh0aGlzLnJlZmxlY3RBc3NlbWJseSkpIHtcbiAgICAgICAgdGhpcy5lbWl0RGVmYXVsdEltcGxlbWVudGF0aW9uKHR5cGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgdGhpcy5jbG9zZUZpbGVJZk5lZWRlZChpZmMpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uSW50ZXJmYWNlTWV0aG9kKGlmYzogc3BlYy5JbnRlcmZhY2VUeXBlLCBtZXRob2Q6IHNwZWMuTWV0aG9kKSB7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICBjb25zdCByZXR1cm5UeXBlID0gbWV0aG9kLnJldHVybnNcbiAgICAgID8gdGhpcy50b0RlY29yYXRlZEphdmFUeXBlKG1ldGhvZC5yZXR1cm5zKVxuICAgICAgOiAndm9pZCc7XG4gICAgdGhpcy5hZGRKYXZhRG9jcyhtZXRob2QsIHtcbiAgICAgIGFwaTogJ21lbWJlcicsXG4gICAgICBmcW46IGlmYy5mcW4sXG4gICAgICBtZW1iZXJOYW1lOiBtZXRob2QubmFtZSxcbiAgICB9KTtcbiAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhtZXRob2QpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYCR7cmV0dXJuVHlwZX0gJHttZXRob2QubmFtZX0oJHt0aGlzLnJlbmRlck1ldGhvZFBhcmFtZXRlcnMobWV0aG9kKX0pO2AsXG4gICAgKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBvbkludGVyZmFjZU1ldGhvZE92ZXJsb2FkKFxuICAgIGlmYzogc3BlYy5JbnRlcmZhY2VUeXBlLFxuICAgIG92ZXJsb2FkOiBzcGVjLk1ldGhvZCxcbiAgICBfb3JpZ2luYWxNZXRob2Q6IHNwZWMuTWV0aG9kLFxuICApIHtcbiAgICB0aGlzLm9uSW50ZXJmYWNlTWV0aG9kKGlmYywgb3ZlcmxvYWQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIG9uSW50ZXJmYWNlUHJvcGVydHkoaWZjOiBzcGVjLkludGVyZmFjZVR5cGUsIHByb3A6IHNwZWMuUHJvcGVydHkpIHtcbiAgICBjb25zdCBnZXR0ZXJUeXBlID0gdGhpcy50b0RlY29yYXRlZEphdmFUeXBlKHByb3ApO1xuICAgIGNvbnN0IHByb3BOYW1lID0ganNpaVRvUGFzY2FsQ2FzZShcbiAgICAgIEphdmFHZW5lcmF0b3Iuc2FmZUphdmFQcm9wZXJ0eU5hbWUocHJvcC5uYW1lKSxcbiAgICApO1xuXG4gICAgLy8gZm9yIHVuaW9ucyB3ZSBvbmx5IGdlbmVyYXRlIG92ZXJsb2FkcyBmb3Igc2V0dGVycywgbm90IGdldHRlcnMuXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmFkZEphdmFEb2NzKHByb3AsIHtcbiAgICAgIGFwaTogJ21lbWJlcicsXG4gICAgICBmcW46IGlmYy5mcW4sXG4gICAgICBtZW1iZXJOYW1lOiBwcm9wLm5hbWUsXG4gICAgfSk7XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMocHJvcCk7XG4gICAgaWYgKHByb3Aub3B0aW9uYWwpIHtcbiAgICAgIGlmIChwcm9wLm92ZXJyaWRlcykge1xuICAgICAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKGBkZWZhdWx0ICR7Z2V0dGVyVHlwZX0gZ2V0JHtwcm9wTmFtZX0oKWApO1xuICAgICAgdGhpcy5jb2RlLmxpbmUoJ3JldHVybiBudWxsOycpO1xuICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoYCR7Z2V0dGVyVHlwZX0gZ2V0JHtwcm9wTmFtZX0oKTtgKTtcbiAgICB9XG5cbiAgICBpZiAoIXByb3AuaW1tdXRhYmxlKSB7XG4gICAgICBjb25zdCBzZXR0ZXJUeXBlcyA9IHRoaXMudG9EZWNvcmF0ZWRKYXZhVHlwZXMocHJvcCk7XG4gICAgICBmb3IgKGNvbnN0IHR5cGUgb2Ygc2V0dGVyVHlwZXMpIHtcbiAgICAgICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICAgICAgdGhpcy5hZGRKYXZhRG9jcyhwcm9wLCB7XG4gICAgICAgICAgYXBpOiAnbWVtYmVyJyxcbiAgICAgICAgICBmcW46IGlmYy5mcW4sXG4gICAgICAgICAgbWVtYmVyTmFtZTogcHJvcC5uYW1lLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHByb3Aub3B0aW9uYWwpIHtcbiAgICAgICAgICBpZiAocHJvcC5vdmVycmlkZXMpIHtcbiAgICAgICAgICAgIHRoaXMuY29kZS5saW5lKCdAT3ZlcnJpZGUnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jb2RlLmxpbmUoJ0Bzb2Z0d2FyZS5hbWF6b24uanNpaS5PcHRpb25hbCcpO1xuICAgICAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICAgICAgICBgZGVmYXVsdCB2b2lkIHNldCR7cHJvcE5hbWV9KGZpbmFsICR7dHlwZX0gdmFsdWUpYCxcbiAgICAgICAgICApO1xuICAgICAgICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgICAgICAgYHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbihcIid2b2lkIFwiICsgZ2V0Q2xhc3MoKS5nZXRDYW5vbmljYWxOYW1lKCkgKyBcIiNzZXQke3Byb3BOYW1lfSgke3R5cGV9KScgaXMgbm90IGltcGxlbWVudGVkIVwiKTtgLFxuICAgICAgICAgICk7XG4gICAgICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmNvZGUubGluZShgdm9pZCBzZXQke3Byb3BOYW1lfShmaW5hbCAke3R5cGV9IHZhbHVlKTtgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFbWl0cyBhIGxvY2FsIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZm9yIG9wdGlvbmFsIHByb3BlcnRpZXMgaW5oZXJpdGVkIGZyb21cbiAgICogbXVsdGlwbGUgZGlzdGluY3QgcGFyZW50IHR5cGVzLiBUaGlzIHJlbXZvZXMgdGhlIGRlZmF1bHQgbWV0aG9kIGRpc3BhdGNoXG4gICAqIGFtYmlndWl0eSB0aGF0IHdvdWxkIG90aGVyd2lzZSBleGlzdC5cbiAgICpcbiAgICogQHBhcmFtIGlmYyAgICAgICAgICAgIHRoZSBpbnRlcmZhY2UgdG8gYmUgcHJvY2Vzc2VkLlxuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2F3cy9qc2lpL2lzc3Vlcy8yMjU2XG4gICAqL1xuICBwcml2YXRlIGVtaXRNdWx0aXBseUluaGVyaXRlZE9wdGlvbmFsUHJvcGVydGllcyhpZmM6IHNwZWMuSW50ZXJmYWNlVHlwZSkge1xuICAgIGlmIChpZmMuaW50ZXJmYWNlcyA9PSBudWxsIHx8IGlmYy5pbnRlcmZhY2VzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAvLyBOb3RoaW5nIHRvIGRvIGlmIHdlIGRvbid0IGhhdmUgcGFyZW50IGludGVyZmFjZXMsIG9yIGlmIHdlIGhhdmUgZXhhY3RseSBvbmVcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgaW5oZXJpdGVkT3B0aW9uYWxQcm9wcyA9IGlmYy5pbnRlcmZhY2VzXG4gICAgICAubWFwKGFsbE9wdGlvbmFsUHJvcHMuYmluZCh0aGlzKSlcbiAgICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSBkaXJlY3QgcGFyZW50cyBicm91Z2h0IGEgZ2l2ZW4gb3B0aW9uYWwgcHJvcGVydHlcbiAgICAgIC5yZWR1Y2UoKGhpc3RvZ3JhbSwgZW50cnkpID0+IHtcbiAgICAgICAgZm9yIChjb25zdCBbbmFtZSwgc3BlY10gb2YgT2JqZWN0LmVudHJpZXMoZW50cnkpKSB7XG4gICAgICAgICAgaGlzdG9ncmFtW25hbWVdID0gaGlzdG9ncmFtW25hbWVdID8/IHsgc3BlYywgY291bnQ6IDAgfTtcbiAgICAgICAgICBoaXN0b2dyYW1bbmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGlzdG9ncmFtO1xuICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgeyByZWFkb25seSBzcGVjOiBzcGVjLlByb3BlcnR5OyBjb3VudDogbnVtYmVyIH0+KTtcblxuICAgIGNvbnN0IGxvY2FsUHJvcHMgPSBuZXcgU2V0KGlmYy5wcm9wZXJ0aWVzPy5tYXAoKHByb3ApID0+IHByb3AubmFtZSkgPz8gW10pO1xuICAgIGZvciAoY29uc3QgeyBzcGVjLCBjb3VudCB9IG9mIE9iamVjdC52YWx1ZXMoaW5oZXJpdGVkT3B0aW9uYWxQcm9wcykpIHtcbiAgICAgIGlmIChjb3VudCA8IDIgfHwgbG9jYWxQcm9wcy5oYXMoc3BlYy5uYW1lKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMub25JbnRlcmZhY2VQcm9wZXJ0eShpZmMsIHNwZWMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFsbE9wdGlvbmFsUHJvcHModGhpczogSmF2YUdlbmVyYXRvciwgZnFuOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLmZpbmRUeXBlKGZxbikgYXMgc3BlYy5JbnRlcmZhY2VUeXBlO1xuICAgICAgY29uc3QgcmVzdWx0OiBSZWNvcmQ8c3RyaW5nLCBzcGVjLlByb3BlcnR5PiA9IHt9O1xuICAgICAgZm9yIChjb25zdCBwcm9wIG9mIHR5cGUucHJvcGVydGllcyA/PyBbXSkge1xuICAgICAgICAvLyBBZGRpbmcgYXJ0aWZpY2FsIFwib3ZlcnJpZGVzXCIgaGVyZSBmb3IgY29kZS1nZW4gcXVhbGl0eSdzIHNha2UuXG4gICAgICAgIHJlc3VsdFtwcm9wLm5hbWVdID0geyAuLi5wcm9wLCBvdmVycmlkZXM6IHR5cGUuZnFuIH07XG4gICAgICB9XG4gICAgICAvLyBJbmNsdWRlIG9wdGlvbmFsIHByb3BlcnRpZXMgb2YgYWxsIHN1cGVyIGludGVyZmFjZXMgaW4gdGhlIHJlc3VsdFxuICAgICAgZm9yIChjb25zdCBiYXNlIG9mIHR5cGUuaW50ZXJmYWNlcyA/PyBbXSkge1xuICAgICAgICBmb3IgKGNvbnN0IFtuYW1lLCBwcm9wXSBvZiBPYmplY3QuZW50cmllcyhcbiAgICAgICAgICBhbGxPcHRpb25hbFByb3BzLmNhbGwodGhpcywgYmFzZSksXG4gICAgICAgICkpIHtcbiAgICAgICAgICBpZiAoIShuYW1lIGluIHJlc3VsdCkpIHtcbiAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IHByb3A7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZW1pdEFzc2VtYmx5UGFja2FnZUluZm8obW9kOiBzcGVjLkFzc2VtYmx5KSB7XG4gICAgaWYgKCFtb2QuZG9jcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHsgcGFja2FnZU5hbWUgfSA9IHRoaXMudG9OYXRpdmVOYW1lKG1vZCk7XG4gICAgY29uc3QgcGFja2FnZUluZm9GaWxlID0gdGhpcy50b0phdmFGaWxlUGF0aChcbiAgICAgIG1vZCxcbiAgICAgIGAke21vZC5uYW1lfS5wYWNrYWdlLWluZm9gLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5GaWxlKHBhY2thZ2VJbmZvRmlsZSk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIGlmIChtb2QucmVhZG1lKSB7XG4gICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbWFya0Rvd25Ub0phdmFEb2MoXG4gICAgICAgIHRoaXMuY29udmVydFNhbXBsZXNJbk1hcmtkb3duKG1vZC5yZWFkbWUubWFya2Rvd24sIHtcbiAgICAgICAgICBhcGk6ICdtb2R1bGVSZWFkbWUnLFxuICAgICAgICAgIG1vZHVsZUZxbjogbW9kLm5hbWUsXG4gICAgICAgIH0pLFxuICAgICAgKS5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgdGhpcy5jb2RlLmxpbmUoYCAqICR7bGluZS5yZXBsYWNlKC9cXCpcXC8vZywgJyp7QGxpdGVyYWwgL30nKX1gKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1vZC5kb2NzLmRlcHJlY2F0ZWQpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKCcgKicpO1xuICAgICAgLy8gSmF2YWMgd29uJ3QgYWxsb3cgQGRlcHJlY2F0ZWQgb24gcGFja2FnZXMsIHdoaWxlIEBEZXByZWNhdGVkIGlzIGFhYWFic29sdXRlbHkgZmluZS4gRHVoLlxuICAgICAgdGhpcy5jb2RlLmxpbmUoYCAqIERlcHJlY2F0ZWQ6ICR7bW9kLmRvY3MuZGVwcmVjYXRlZH1gKTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmxpbmUoJyAqLycpO1xuICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKG1vZCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoYHBhY2thZ2UgJHtwYWNrYWdlTmFtZX07YCk7XG4gICAgdGhpcy5jb2RlLmNsb3NlRmlsZShwYWNrYWdlSW5mb0ZpbGUpO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0U3VibW9kdWxlUGFja2FnZUluZm8oYXNzZW1ibHk6IHNwZWMuQXNzZW1ibHksIG1vZHVsZUZxbjogc3RyaW5nKSB7XG4gICAgY29uc3QgbW9kID0gYXNzZW1ibHkuc3VibW9kdWxlcz8uW21vZHVsZUZxbl07XG4gICAgaWYgKCFtb2Q/LnJlYWRtZT8ubWFya2Rvd24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB7IHBhY2thZ2VOYW1lIH0gPSB0cmFuc2xhdGVGcW4oYXNzZW1ibHksIG1vZHVsZUZxbik7XG4gICAgY29uc3QgcGFja2FnZUluZm9GaWxlID0gdGhpcy50b0phdmFGaWxlUGF0aChcbiAgICAgIGFzc2VtYmx5LFxuICAgICAgYCR7bW9kdWxlRnFufS5wYWNrYWdlLWluZm9gLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5GaWxlKHBhY2thZ2VJbmZvRmlsZSk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIGlmIChtb2QucmVhZG1lKSB7XG4gICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbWFya0Rvd25Ub0phdmFEb2MoXG4gICAgICAgIHRoaXMuY29udmVydFNhbXBsZXNJbk1hcmtkb3duKG1vZC5yZWFkbWUubWFya2Rvd24sIHtcbiAgICAgICAgICBhcGk6ICdtb2R1bGVSZWFkbWUnLFxuICAgICAgICAgIG1vZHVsZUZxbixcbiAgICAgICAgfSksXG4gICAgICApLnNwbGl0KCdcXG4nKSkge1xuICAgICAgICB0aGlzLmNvZGUubGluZShgICogJHtsaW5lLnJlcGxhY2UoL1xcKlxcLy9nLCAnKntAbGl0ZXJhbCAvfScpfWApO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoYHBhY2thZ2UgJHtwYWNrYWdlTmFtZX07YCk7XG4gICAgdGhpcy5jb2RlLmNsb3NlRmlsZShwYWNrYWdlSW5mb0ZpbGUpO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0TWF2ZW5Qb20oYXNzbTogc3BlYy5Bc3NlbWJseSwgZmluZ2VycHJpbnQ6IGJvb2xlYW4pIHtcbiAgICBpZiAoIWFzc20udGFyZ2V0cz8uamF2YSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBBc3NlbWJseSAke2Fzc20ubmFtZX0gZG9lcyBub3QgZGVjbGFyZSBhIGphdmEgdGFyZ2V0YCk7XG4gICAgfVxuXG4gICAgY29uc3QgY29tbWVudCA9IGZpbmdlcnByaW50XG4gICAgICA/IHtcbiAgICAgICAgICAnI2NvbW1lbnQnOiBbXG4gICAgICAgICAgICBgR2VuZXJhdGVkIGJ5IGpzaWktcGFjbWFrQCR7VkVSU0lPTl9ERVNDfSBvbiAke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1gLFxuICAgICAgICAgICAgYEBqc2lpLXBhY21hazptZXRhQCAke0pTT04uc3RyaW5naWZ5KHRoaXMubWV0YWRhdGEpfWAsXG4gICAgICAgICAgXSxcbiAgICAgICAgfVxuICAgICAgOiB7fTtcblxuICAgIHRoaXMuY29kZS5vcGVuRmlsZSgncG9tLnhtbCcpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgeG1sYnVpbGRlclxuICAgICAgICAuY3JlYXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb2plY3Q6IHtcbiAgICAgICAgICAgICAgJ0B4bWxucyc6ICdodHRwOi8vbWF2ZW4uYXBhY2hlLm9yZy9QT00vNC4wLjAnLFxuICAgICAgICAgICAgICAnQHhtbG5zOnhzaSc6ICdodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZScsXG4gICAgICAgICAgICAgICdAeHNpOnNjaGVtYUxvY2F0aW9uJzpcbiAgICAgICAgICAgICAgICAnaHR0cDovL21hdmVuLmFwYWNoZS5vcmcvUE9NLzQuMC4wIGh0dHA6Ly9tYXZlbi5hcGFjaGUub3JnL3hzZC9tYXZlbi00LjAuMC54c2QnLFxuXG4gICAgICAgICAgICAgIC4uLmNvbW1lbnQsXG5cbiAgICAgICAgICAgICAgbW9kZWxWZXJzaW9uOiAnNC4wLjAnLFxuICAgICAgICAgICAgICBuYW1lOiAnJHtwcm9qZWN0Lmdyb3VwSWR9OiR7cHJvamVjdC5hcnRpZmFjdElkfScsXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBhc3NtLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICB1cmw6IGFzc20uaG9tZXBhZ2UsXG5cbiAgICAgICAgICAgICAgbGljZW5zZXM6IHtcbiAgICAgICAgICAgICAgICBsaWNlbnNlOiBnZXRMaWNlbnNlKCksXG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgZGV2ZWxvcGVyczoge1xuICAgICAgICAgICAgICAgIGRldmVsb3BlcjogbWF2ZW5EZXZlbG9wZXJzKCksXG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgc2NtOiB7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbjogYHNjbToke2Fzc20ucmVwb3NpdG9yeS50eXBlfToke2Fzc20ucmVwb3NpdG9yeS51cmx9YCxcbiAgICAgICAgICAgICAgICB1cmw6IGFzc20ucmVwb3NpdG9yeS51cmwsXG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgZ3JvdXBJZDogYXNzbS50YXJnZXRzLmphdmEubWF2ZW4uZ3JvdXBJZCxcbiAgICAgICAgICAgICAgYXJ0aWZhY3RJZDogYXNzbS50YXJnZXRzLmphdmEubWF2ZW4uYXJ0aWZhY3RJZCxcbiAgICAgICAgICAgICAgdmVyc2lvbjogbWFrZVZlcnNpb24oXG4gICAgICAgICAgICAgICAgYXNzbS52ZXJzaW9uLFxuICAgICAgICAgICAgICAgIGFzc20udGFyZ2V0cy5qYXZhLm1hdmVuLnZlcnNpb25TdWZmaXgsXG4gICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgIHBhY2thZ2luZzogJ2phcicsXG5cbiAgICAgICAgICAgICAgcHJvcGVydGllczogeyAncHJvamVjdC5idWlsZC5zb3VyY2VFbmNvZGluZyc6ICdVVEYtOCcgfSxcblxuICAgICAgICAgICAgICBkZXBlbmRlbmNpZXM6IHsgZGVwZW5kZW5jeTogbWF2ZW5EZXBlbmRlbmNpZXMuY2FsbCh0aGlzKSB9LFxuXG4gICAgICAgICAgICAgIGJ1aWxkOiB7XG4gICAgICAgICAgICAgICAgcGx1Z2luczoge1xuICAgICAgICAgICAgICAgICAgcGx1Z2luOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiAnb3JnLmFwYWNoZS5tYXZlbi5wbHVnaW5zJyxcbiAgICAgICAgICAgICAgICAgICAgICBhcnRpZmFjdElkOiAnbWF2ZW4tY29tcGlsZXItcGx1Z2luJyxcbiAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAnMy44LjEnLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IHsgc291cmNlOiAnMS44JywgdGFyZ2V0OiAnMS44JyB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJ29yZy5hcGFjaGUubWF2ZW4ucGx1Z2lucycsXG4gICAgICAgICAgICAgICAgICAgICAgYXJ0aWZhY3RJZDogJ21hdmVuLWphci1wbHVnaW4nLFxuICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246ICczLjIuMCcsXG4gICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJjaGl2ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuaWZlc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGREZWZhdWx0SW1wbGVtZW50YXRpb25FbnRyaWVzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZERlZmF1bHRTcGVjaWZpY2F0aW9uRW50cmllczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIGdyb3VwSWQ6ICdvcmcuYXBhY2hlLm1hdmVuLnBsdWdpbnMnLFxuICAgICAgICAgICAgICAgICAgICAgIGFydGlmYWN0SWQ6ICdtYXZlbi1zb3VyY2UtcGx1Z2luJyxcbiAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAnMy4yLjEnLFxuICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2F0dGFjaC1zb3VyY2VzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbHM6IHsgZ29hbDogJ2phcicgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIGdyb3VwSWQ6ICdvcmcuYXBhY2hlLm1hdmVuLnBsdWdpbnMnLFxuICAgICAgICAgICAgICAgICAgICAgIGFydGlmYWN0SWQ6ICdtYXZlbi1qYXZhZG9jLXBsdWdpbicsXG4gICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJzMuMi4wJyxcbiAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdhdHRhY2gtamF2YWRvY3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBnb2FsczogeyBnb2FsOiAnamFyJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxPbkVycm9yOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6ICdwcm90ZWN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlRmlsZUV4Y2x1ZGVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4Y2x1ZGluZyB0aGUgJE1vZHVsZSBjbGFzc2VzIHNvIHRoZXkgd29uJ3QgcG9sbHV0ZSB0aGUgZG9jc2l0ZS4gVGhleSBvdGhlcndpc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXJlIGFsbCBjb2xsZWN0ZWQgYXQgdGhlIHRvcCBvZiB0aGUgY2xhc3NsaXN0LCBidXJyeWluZyB1c2VmdWwgaW5mb3JtYXRpb24gdW5kZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBsb3Qgb2YgZHJ5IHNjcm9sbGluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZTogWycqKi8kTW9kdWxlLmphdmEnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGRpbmcgdGhlc2UgbWFrZXMgSmF2YURvYyBnZW5lcmF0aW9uIGFib3V0IGEgM3JkIGZhc3RlciAod2hpY2ggaXMgZmFyIGFuZCBhd2F5IHRoZSBtb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleHBlbnNpdmUgcGFydCBvZiB0aGUgYnVpbGQpXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsSk9wdGlvbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnLUotWFg6K1RpZXJlZENvbXBpbGF0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJy1KLVhYOlRpZXJlZFN0b3BBdExldmVsPTEnLFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgZ3JvdXBJZDogJ29yZy5hcGFjaGUubWF2ZW4ucGx1Z2lucycsXG4gICAgICAgICAgICAgICAgICAgICAgYXJ0aWZhY3RJZDogJ21hdmVuLWVuZm9yY2VyLXBsdWdpbicsXG4gICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJzMuMC4wLU0zJyxcbiAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBleGVjdXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdlbmZvcmNlLW1hdmVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZ29hbHM6IHsgZ29hbDogJ2VuZm9yY2UnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZU1hdmVuVmVyc2lvbjogeyB2ZXJzaW9uOiAnMy42JyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBncm91cElkOiAnb3JnLmNvZGVoYXVzLm1vam8nLFxuICAgICAgICAgICAgICAgICAgICAgIGFydGlmYWN0SWQ6ICd2ZXJzaW9ucy1tYXZlbi1wbHVnaW4nLFxuICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb246ICcyLjguMScsXG4gICAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2VuZXJhdGVCYWNrdXBQb21zOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHsgZW5jb2Rpbmc6ICdVVEYtOCcgfSxcbiAgICAgICAgKVxuICAgICAgICAuZW5kKHsgcHJldHR5OiB0cnVlIH0pLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmNsb3NlRmlsZSgncG9tLnhtbCcpO1xuXG4gICAgLyoqXG4gICAgICogQ29tYmluZXMgYSB2ZXJzaW9uIG51bWJlciB3aXRoIGFuIG9wdGlvbmFsIHN1ZmZpeC4gVGhlIHN1ZmZpeCwgd2hlbiBwcmVzZW50LCBtdXN0IGJlZ2luIHdpdGhcbiAgICAgKiAnLScgb3IgJy4nLCBhbmQgd2lsbCBiZSBjb25jYXRlbmF0ZWQgYXMtaXMgdG8gdGhlIHZlcnNpb24gbnVtYmVyLi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2ZXJzaW9uIHRoZSBzZW1hbnRpYyB2ZXJzaW9uIG51bWJlclxuICAgICAqIEBwYXJhbSBzdWZmaXggIHRoZSBzdWZmaXgsIGlmIGFueS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYWtlVmVyc2lvbih2ZXJzaW9uOiBzdHJpbmcsIHN1ZmZpeD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICBpZiAoIXN1ZmZpeCkge1xuICAgICAgICByZXR1cm4gdG9SZWxlYXNlVmVyc2lvbih2ZXJzaW9uLCBUYXJnZXROYW1lLkpBVkEpO1xuICAgICAgfVxuICAgICAgaWYgKCFzdWZmaXguc3RhcnRzV2l0aCgnLScpICYmICFzdWZmaXguc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgdmVyc2lvblN1ZmZpeCBtdXN0IHN0YXJ0IHdpdGggJy0nIG9yICcuJywgYnV0IHJlY2VpdmVkICR7c3VmZml4fWAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYCR7dmVyc2lvbn0ke3N1ZmZpeH1gO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1hdmVuRGVwZW5kZW5jaWVzKHRoaXM6IEphdmFHZW5lcmF0b3IpIHtcbiAgICAgIGNvbnN0IGRlcGVuZGVuY2llcyA9IG5ldyBBcnJheTxNYXZlbkRlcGVuZGVuY3k+KCk7XG4gICAgICBmb3IgKGNvbnN0IFtkZXBOYW1lLCB2ZXJzaW9uXSBvZiBPYmplY3QuZW50cmllcyhcbiAgICAgICAgdGhpcy5hc3NlbWJseS5kZXBlbmRlbmNpZXMgPz8ge30sXG4gICAgICApKSB7XG4gICAgICAgIGNvbnN0IGRlcCA9IHRoaXMuYXNzZW1ibHkuZGVwZW5kZW5jeUNsb3N1cmU/LltkZXBOYW1lXTtcbiAgICAgICAgaWYgKCFkZXA/LnRhcmdldHM/LmphdmEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBgQXNzZW1ibHkgJHthc3NtLm5hbWV9IGRlcGVuZHMgb24gJHtkZXBOYW1lfSwgd2hpY2ggZG9lcyBub3QgZGVjbGFyZSBhIGphdmEgdGFyZ2V0YCxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGRlcGVuZGVuY2llcy5wdXNoKHtcbiAgICAgICAgICBncm91cElkOiBkZXAudGFyZ2V0cy5qYXZhLm1hdmVuLmdyb3VwSWQsXG4gICAgICAgICAgYXJ0aWZhY3RJZDogZGVwLnRhcmdldHMuamF2YS5tYXZlbi5hcnRpZmFjdElkLFxuICAgICAgICAgIHZlcnNpb246IHRvTWF2ZW5WZXJzaW9uUmFuZ2UoXG4gICAgICAgICAgICB2ZXJzaW9uLFxuICAgICAgICAgICAgZGVwLnRhcmdldHMuamF2YS5tYXZlbi52ZXJzaW9uU3VmZml4LFxuICAgICAgICAgICksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gVGhlIEpTSUkgamF2YSBydW50aW1lIGJhc2UgY2xhc3Nlc1xuICAgICAgZGVwZW5kZW5jaWVzLnB1c2goe1xuICAgICAgICBncm91cElkOiAnc29mdHdhcmUuYW1hem9uLmpzaWknLFxuICAgICAgICBhcnRpZmFjdElkOiAnanNpaS1ydW50aW1lJyxcbiAgICAgICAgdmVyc2lvbjogdG9NYXZlblZlcnNpb25SYW5nZShgXiR7VkVSU0lPTn1gKSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBQcm92aWRlcyBAb3JnLmpldGJyYWlucy4qXG4gICAgICBkZXBlbmRlbmNpZXMucHVzaCh7XG4gICAgICAgIGdyb3VwSWQ6ICdvcmcuamV0YnJhaW5zJyxcbiAgICAgICAgYXJ0aWZhY3RJZDogJ2Fubm90YXRpb25zJyxcbiAgICAgICAgdmVyc2lvbjogJ1sxNi4wLjMsMjAuMC4wKScsXG4gICAgICB9KTtcblxuICAgICAgLy8gUHJvdmlkZXMgQGphdmF4LmFubm90YXRpb24uR2VuZXJhdGVkIGZvciBKREtzID49IDlcbiAgICAgIGRlcGVuZGVuY2llcy5wdXNoKHtcbiAgICAgICAgJyNjb21tZW50JzogJ1Byb3ZpZGVzIEBqYXZheC5hbm5vdGF0aW9uLkdlbmVyYXRlZCBmb3IgSkRLcyA+PSA5JyxcbiAgICAgICAgZ3JvdXBJZDogJ2phdmF4LmFubm90YXRpb24nLFxuICAgICAgICBhcnRpZmFjdElkOiAnamF2YXguYW5ub3RhdGlvbi1hcGknLFxuICAgICAgICB2ZXJzaW9uOiAnWzEuMy4yLDEuNC4wKScsXG4gICAgICAgIHNjb3BlOiAnY29tcGlsZScsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGRlcGVuZGVuY2llcztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYXZlbkRldmVsb3BlcnMoKSB7XG4gICAgICByZXR1cm4gW2Fzc20uYXV0aG9yLCAuLi4oYXNzbS5jb250cmlidXRvcnMgPz8gW10pXS5tYXAodG9EZXZlbG9wZXIpO1xuXG4gICAgICBmdW5jdGlvbiB0b0RldmVsb3BlcihwZXJzb246IHNwZWMuUGVyc29uKSB7XG4gICAgICAgIGNvbnN0IGRldmVsb3BlcjogYW55ID0ge1xuICAgICAgICAgIFtwZXJzb24ub3JnYW5pemF0aW9uID8gJ29yZ2FuaXphdGlvbicgOiAnbmFtZSddOiBwZXJzb24ubmFtZSxcbiAgICAgICAgICByb2xlczogeyByb2xlOiBwZXJzb24ucm9sZXMgfSxcbiAgICAgICAgfTtcbiAgICAgICAgLy8gV2UgY2Fubm90IHNldCBcInVuZGVmaW5lZFwiIG9yIFwibnVsbFwiIHRvIGEgZmllbGQgLSB0aGlzIGNhdXNlcyBpbnZhbGlkIFhNTCB0byBiZSBlbWl0dGVkIChwZXIgUE9NIHNjaGVtYSkuXG4gICAgICAgIGlmIChwZXJzb24uZW1haWwpIHtcbiAgICAgICAgICBkZXZlbG9wZXIuZW1haWwgPSBwZXJzb24uZW1haWw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBlcnNvbi51cmwpIHtcbiAgICAgICAgICBkZXZlbG9wZXJbcGVyc29uLm9yZ2FuaXphdGlvbiA/ICdvcmdhbml6YXRpb25VcmwnIDogJ3VybCddID1cbiAgICAgICAgICAgIHBlcnNvbi51cmw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldmVsb3BlcjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIG1hdmVuLXN0eWxlIGxpY2Vuc2UgYmxvY2sgZm9yIGEgdGhlIGFzc2VtYmx5LlxuICAgICAqIEBzZWUgaHR0cHM6Ly9tYXZlbi5hcGFjaGUub3JnL3BvbS5odG1sI0xpY2Vuc2VzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0TGljZW5zZSgpIHtcbiAgICAgIGNvbnN0IHNwZHggPSBzcGR4TGljZW5zZUxpc3RbYXNzbS5saWNlbnNlXTtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIHNwZHggJiYge1xuICAgICAgICAgIG5hbWU6IHNwZHgubmFtZSxcbiAgICAgICAgICB1cmw6IHNwZHgudXJsLFxuICAgICAgICAgIGRpc3RyaWJ1dGlvbjogJ3JlcG8nLFxuICAgICAgICAgIGNvbW1lbnRzOiBzcGR4Lm9zaUFwcHJvdmVkID8gJ0FuIE9TSS1hcHByb3ZlZCBsaWNlbnNlJyA6IHVuZGVmaW5lZCxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGVtaXRTdGF0aWNJbml0aWFsaXplcihjbHM6IHNwZWMuQ2xhc3NUeXBlKSB7XG4gICAgY29uc3QgY29uc3RzID0gKGNscy5wcm9wZXJ0aWVzID8/IFtdKS5maWx0ZXIoKHgpID0+IHguY29uc3QpO1xuICAgIGlmIChjb25zdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgamF2YUNsYXNzID0gdGhpcy50b0phdmFUeXBlKGNscyk7XG5cbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soJ3N0YXRpYycpO1xuXG4gICAgZm9yIChjb25zdCBwcm9wIG9mIGNvbnN0cykge1xuICAgICAgY29uc3QgY29uc3ROYW1lID0gdGhpcy5yZW5kZXJDb25zdE5hbWUocHJvcCk7XG4gICAgICBjb25zdCBwcm9wVHlwZSA9IHRoaXMudG9OYXRpdmVUeXBlKHByb3AudHlwZSwgeyBmb3JNYXJzaGFsbGluZzogdHJ1ZSB9KTtcbiAgICAgIGNvbnN0IHN0YXRlbWVudCA9IGBzb2Z0d2FyZS5hbWF6b24uanNpaS5Kc2lpT2JqZWN0LmpzaWlTdGF0aWNHZXQoJHtqYXZhQ2xhc3N9LmNsYXNzLCBcIiR7cHJvcC5uYW1lfVwiLCAke3Byb3BUeXBlfSlgO1xuICAgICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAgIGAke2NvbnN0TmFtZX0gPSAke3RoaXMud3JhcENvbGxlY3Rpb24oXG4gICAgICAgICAgc3RhdGVtZW50LFxuICAgICAgICAgIHByb3AudHlwZSxcbiAgICAgICAgICBwcm9wLm9wdGlvbmFsLFxuICAgICAgICApfTtgLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJDb25zdE5hbWUocHJvcDogc3BlYy5Qcm9wZXJ0eSkge1xuICAgIHJldHVybiB0aGlzLmNvZGUudG9TbmFrZUNhc2UocHJvcC5uYW1lKS50b0xvY2FsZVVwcGVyQ2FzZSgpOyAvLyBqYXZhIGNvbnN0cyBhcmUgU05BS0VfVVBQRVJfQ0FTRVxuICB9XG5cbiAgcHJpdmF0ZSBlbWl0Q29uc3RQcm9wZXJ0eShwYXJlbnRUeXBlOiBzcGVjLlR5cGUsIHByb3A6IHNwZWMuUHJvcGVydHkpIHtcbiAgICBjb25zdCBwcm9wVHlwZSA9IHRoaXMudG9KYXZhVHlwZShwcm9wLnR5cGUpO1xuICAgIGNvbnN0IHByb3BOYW1lID0gdGhpcy5yZW5kZXJDb25zdE5hbWUocHJvcCk7XG4gICAgY29uc3QgYWNjZXNzID0gdGhpcy5yZW5kZXJBY2Nlc3NMZXZlbChwcm9wKTtcblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5hZGRKYXZhRG9jcyhwcm9wLCB7XG4gICAgICBhcGk6ICdtZW1iZXInLFxuICAgICAgZnFuOiBwYXJlbnRUeXBlLmZxbixcbiAgICAgIG1lbWJlck5hbWU6IHByb3AubmFtZSxcbiAgICB9KTtcbiAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhwcm9wKTtcbiAgICB0aGlzLmNvZGUubGluZShgJHthY2Nlc3N9IGZpbmFsIHN0YXRpYyAke3Byb3BUeXBlfSAke3Byb3BOYW1lfTtgKTtcbiAgfVxuXG4gIHByaXZhdGUgZW1pdFByb3BlcnR5KFxuICAgIGNsczogc3BlYy5UeXBlLFxuICAgIHByb3A6IHNwZWMuUHJvcGVydHksXG4gICAgZGVmaW5pbmdUeXBlOiBzcGVjLlR5cGUsXG4gICAge1xuICAgICAgZGVmYXVsdEltcGwgPSBmYWxzZSxcbiAgICAgIGZpbmFsID0gZmFsc2UsXG4gICAgICBpbmNsdWRlR2V0dGVyID0gdHJ1ZSxcbiAgICAgIG92ZXJyaWRlcyA9ICEhcHJvcC5vdmVycmlkZXMsXG4gICAgfToge1xuICAgICAgZGVmYXVsdEltcGw/OiBib29sZWFuO1xuICAgICAgZmluYWw/OiBib29sZWFuO1xuICAgICAgaW5jbHVkZUdldHRlcj86IGJvb2xlYW47XG4gICAgICBvdmVycmlkZXM/OiBib29sZWFuO1xuICAgIH0gPSB7fSxcbiAgKSB7XG4gICAgY29uc3QgZ2V0dGVyVHlwZSA9IHRoaXMudG9EZWNvcmF0ZWRKYXZhVHlwZShwcm9wKTtcbiAgICBjb25zdCBzZXR0ZXJUeXBlcyA9IHRoaXMudG9EZWNvcmF0ZWRKYXZhVHlwZXMocHJvcCwge1xuICAgICAgY292YXJpYW50OiBwcm9wLnN0YXRpYyxcbiAgICB9KTtcbiAgICBjb25zdCBwcm9wTmFtZSA9IGpzaWlUb1Bhc2NhbENhc2UoXG4gICAgICBKYXZhR2VuZXJhdG9yLnNhZmVKYXZhUHJvcGVydHlOYW1lKHByb3AubmFtZSksXG4gICAgKTtcblxuICAgIGNvbnN0IG1vZGlmaWVycyA9IFtkZWZhdWx0SW1wbCA/ICdkZWZhdWx0JyA6IHRoaXMucmVuZGVyQWNjZXNzTGV2ZWwocHJvcCldO1xuICAgIGlmIChwcm9wLnN0YXRpYykgbW9kaWZpZXJzLnB1c2goJ3N0YXRpYycpO1xuICAgIGlmIChwcm9wLmFic3RyYWN0ICYmICFkZWZhdWx0SW1wbCkgbW9kaWZpZXJzLnB1c2goJ2Fic3RyYWN0Jyk7XG4gICAgaWYgKGZpbmFsICYmICFwcm9wLmFic3RyYWN0ICYmICFkZWZhdWx0SW1wbCkgbW9kaWZpZXJzLnB1c2goJ2ZpbmFsJyk7XG5cbiAgICBjb25zdCBqYXZhQ2xhc3MgPSB0aGlzLnRvSmF2YVR5cGUoY2xzKTtcblxuICAgIC8vIGZvciB1bmlvbnMgd2Ugb25seSBnZW5lcmF0ZSBvdmVybG9hZHMgZm9yIHNldHRlcnMsIG5vdCBnZXR0ZXJzLlxuICAgIGlmIChpbmNsdWRlR2V0dGVyKSB7XG4gICAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgICAgdGhpcy5hZGRKYXZhRG9jcyhwcm9wLCB7XG4gICAgICAgIGFwaTogJ21lbWJlcicsXG4gICAgICAgIGZxbjogZGVmaW5pbmdUeXBlLmZxbixcbiAgICAgICAgbWVtYmVyTmFtZTogcHJvcC5uYW1lLFxuICAgICAgfSk7XG4gICAgICBpZiAob3ZlcnJpZGVzICYmICFwcm9wLnN0YXRpYykge1xuICAgICAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhwcm9wKTtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGAke21vZGlmaWVycy5qb2luKCcgJyl9ICR7Z2V0dGVyVHlwZX0gZ2V0JHtwcm9wTmFtZX0oKWA7XG4gICAgICBpZiAocHJvcC5hYnN0cmFjdCAmJiAhZGVmYXVsdEltcGwpIHtcbiAgICAgICAgdGhpcy5jb2RlLmxpbmUoYCR7c2lnbmF0dXJlfTtgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soc2lnbmF0dXJlKTtcbiAgICAgICAgbGV0IHN0YXRlbWVudDtcbiAgICAgICAgaWYgKHByb3Auc3RhdGljKSB7XG4gICAgICAgICAgc3RhdGVtZW50ID0gYHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlPYmplY3QuanNpaVN0YXRpY0dldCgke3RoaXMudG9KYXZhVHlwZShcbiAgICAgICAgICAgIGNscyxcbiAgICAgICAgICApfS5jbGFzcywgYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzdGF0ZW1lbnQgPSAnc29mdHdhcmUuYW1hem9uLmpzaWkuS2VybmVsLmdldCh0aGlzLCAnO1xuICAgICAgICB9XG5cbiAgICAgICAgc3RhdGVtZW50ICs9IGBcIiR7cHJvcC5uYW1lfVwiLCAke3RoaXMudG9OYXRpdmVUeXBlKHByb3AudHlwZSwge1xuICAgICAgICAgIGZvck1hcnNoYWxsaW5nOiB0cnVlLFxuICAgICAgICB9KX0pYDtcblxuICAgICAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICAgICBgcmV0dXJuICR7dGhpcy53cmFwQ29sbGVjdGlvbihzdGF0ZW1lbnQsIHByb3AudHlwZSwgcHJvcC5vcHRpb25hbCl9O2AsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFwcm9wLmltbXV0YWJsZSkge1xuICAgICAgZm9yIChjb25zdCB0eXBlIG9mIHNldHRlclR5cGVzKSB7XG4gICAgICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgICAgIHRoaXMuYWRkSmF2YURvY3MocHJvcCwge1xuICAgICAgICAgIGFwaTogJ21lbWJlcicsXG4gICAgICAgICAgZnFuOiBjbHMuZnFuLFxuICAgICAgICAgIG1lbWJlck5hbWU6IHByb3AubmFtZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChvdmVycmlkZXMgJiYgIXByb3Auc3RhdGljKSB7XG4gICAgICAgICAgdGhpcy5jb2RlLmxpbmUoJ0BPdmVycmlkZScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKHByb3ApO1xuICAgICAgICBjb25zdCBzaWduYXR1cmUgPSBgJHttb2RpZmllcnMuam9pbihcbiAgICAgICAgICAnICcsXG4gICAgICAgICl9IHZvaWQgc2V0JHtwcm9wTmFtZX0oZmluYWwgJHt0eXBlfSB2YWx1ZSlgO1xuICAgICAgICBpZiAocHJvcC5hYnN0cmFjdCAmJiAhZGVmYXVsdEltcGwpIHtcbiAgICAgICAgICB0aGlzLmNvZGUubGluZShgJHtzaWduYXR1cmV9O2ApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soc2lnbmF0dXJlKTtcbiAgICAgICAgICBsZXQgc3RhdGVtZW50ID0gJyc7XG5cbiAgICAgICAgICBpZiAocHJvcC5zdGF0aWMpIHtcbiAgICAgICAgICAgIHN0YXRlbWVudCArPSBgc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdC5qc2lpU3RhdGljU2V0KCR7amF2YUNsYXNzfS5jbGFzcywgYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdGVtZW50ICs9ICdzb2Z0d2FyZS5hbWF6b24uanNpaS5LZXJuZWwuc2V0KHRoaXMsICc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHZhbHVlID0gcHJvcC5vcHRpb25hbFxuICAgICAgICAgICAgPyAndmFsdWUnXG4gICAgICAgICAgICA6IGBqYXZhLnV0aWwuT2JqZWN0cy5yZXF1aXJlTm9uTnVsbCh2YWx1ZSwgXCIke3Byb3AubmFtZX0gaXMgcmVxdWlyZWRcIilgO1xuICAgICAgICAgIHN0YXRlbWVudCArPSBgXCIke3Byb3AubmFtZX1cIiwgJHt2YWx1ZX0pO2A7XG4gICAgICAgICAgdGhpcy5jb2RlLmxpbmUoc3RhdGVtZW50KTtcbiAgICAgICAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBlbWl0TWV0aG9kKFxuICAgIGNsczogc3BlYy5UeXBlLFxuICAgIG1ldGhvZDogc3BlYy5NZXRob2QsXG4gICAge1xuICAgICAgZGVmYXVsdEltcGwgPSBmYWxzZSxcbiAgICAgIGZpbmFsID0gZmFsc2UsXG4gICAgICBvdmVycmlkZXMgPSAhIW1ldGhvZC5vdmVycmlkZXMsXG4gICAgfTogeyBkZWZhdWx0SW1wbD86IGJvb2xlYW47IGZpbmFsPzogYm9vbGVhbjsgb3ZlcnJpZGVzPzogYm9vbGVhbiB9ID0ge30sXG4gICkge1xuICAgIGNvbnN0IHJldHVyblR5cGUgPSBtZXRob2QucmV0dXJuc1xuICAgICAgPyB0aGlzLnRvRGVjb3JhdGVkSmF2YVR5cGUobWV0aG9kLnJldHVybnMpXG4gICAgICA6ICd2b2lkJztcblxuICAgIGNvbnN0IG1vZGlmaWVycyA9IFtcbiAgICAgIGRlZmF1bHRJbXBsID8gJ2RlZmF1bHQnIDogdGhpcy5yZW5kZXJBY2Nlc3NMZXZlbChtZXRob2QpLFxuICAgIF07XG4gICAgaWYgKG1ldGhvZC5zdGF0aWMpIG1vZGlmaWVycy5wdXNoKCdzdGF0aWMnKTtcbiAgICBpZiAobWV0aG9kLmFic3RyYWN0ICYmICFkZWZhdWx0SW1wbCkgbW9kaWZpZXJzLnB1c2goJ2Fic3RyYWN0Jyk7XG4gICAgaWYgKGZpbmFsICYmICFtZXRob2QuYWJzdHJhY3QgJiYgIWRlZmF1bHRJbXBsKSBtb2RpZmllcnMucHVzaCgnZmluYWwnKTtcblxuICAgIGNvbnN0IGFzeW5jID0gISFtZXRob2QuYXN5bmM7XG4gICAgY29uc3QgbWV0aG9kTmFtZSA9IEphdmFHZW5lcmF0b3Iuc2FmZUphdmFNZXRob2ROYW1lKG1ldGhvZC5uYW1lKTtcbiAgICBjb25zdCBzaWduYXR1cmUgPSBgJHtyZXR1cm5UeXBlfSAke21ldGhvZE5hbWV9KCR7dGhpcy5yZW5kZXJNZXRob2RQYXJhbWV0ZXJzKFxuICAgICAgbWV0aG9kLFxuICAgICl9KWA7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmFkZEphdmFEb2NzKG1ldGhvZCwge1xuICAgICAgYXBpOiAnbWVtYmVyJyxcbiAgICAgIGZxbjogY2xzLmZxbixcbiAgICAgIG1lbWJlck5hbWU6IG1ldGhvZC5uYW1lLFxuICAgIH0pO1xuICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKG1ldGhvZCk7XG4gICAgaWYgKG92ZXJyaWRlcyAmJiAhbWV0aG9kLnN0YXRpYykge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoJ0BPdmVycmlkZScpO1xuICAgIH1cbiAgICBpZiAobWV0aG9kLmFic3RyYWN0ICYmICFkZWZhdWx0SW1wbCkge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoYCR7bW9kaWZpZXJzLmpvaW4oJyAnKX0gJHtzaWduYXR1cmV9O2ApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKGAke21vZGlmaWVycy5qb2luKCcgJyl9ICR7c2lnbmF0dXJlfWApO1xuICAgICAgdGhpcy5jb2RlLmxpbmUodGhpcy5yZW5kZXJNZXRob2RDYWxsKGNscywgbWV0aG9kLCBhc3luYykpO1xuICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV2UgYXJlIG5vdyBnb2luZyB0byBidWlsZCBhIGNsYXNzIHRoYXQgY2FuIGJlIHVzZWQgYXMgYSBwcm94eSBmb3IgdW50eXBlZFxuICAgKiBqYXZhc2NyaXB0IG9iamVjdHMgdGhhdCBpbXBsZW1lbnQgdGhpcyBpbnRlcmZhY2UuIHdlIHdhbnQgamF2YSBjb2RlIHRvIGJlXG4gICAqIGFibGUgdG8gaW50ZXJhY3Qgd2l0aCB0aGVtLCBzbyB3ZSB3aWxsIGNyZWF0ZSBhIHByb3h5IGNsYXNzIHdoaWNoXG4gICAqIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UgYW5kIGhhcyB0aGUgc2FtZSBtZXRob2RzLlxuICAgKlxuICAgKiBUaGVzZSBwcm94aWVzIGFyZSBhbHNvIHVzZWQgdG8gZXh0ZW5kIGFic3RyYWN0IGNsYXNzZXMgdG8gYWxsb3cgdGhlIEpTSUlcbiAgICogZW5naW5lIHRvIGluc3RhbnRpYXRlIGFuIGFic3RyYWN0IGNsYXNzIGluIEphdmEuXG4gICAqL1xuICBwcml2YXRlIGVtaXRQcm94eSh0eXBlOiByZWZsZWN0LkludGVyZmFjZVR5cGUgfCByZWZsZWN0LkNsYXNzVHlwZSkge1xuICAgIGNvbnN0IG5hbWUgPSBJTlRFUkZBQ0VfUFJPWFlfQ0xBU1NfTkFNRTtcblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgJyAqIEEgcHJveHkgY2xhc3Mgd2hpY2ggcmVwcmVzZW50cyBhIGNvbmNyZXRlIGphdmFzY3JpcHQgaW5zdGFuY2Ugb2YgdGhpcyB0eXBlLicsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG5cbiAgICBjb25zdCBiYXNlSW50ZXJmYWNlcyA9IHRoaXMuZGVmYXVsdEludGVyZmFjZXNGb3IodHlwZSwge1xuICAgICAgaW5jbHVkZVRoaXNUeXBlOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgaWYgKHR5cGUuaXNJbnRlcmZhY2VUeXBlKCkgJiYgIWhhc0RlZmF1bHRJbnRlcmZhY2VzKHR5cGUuYXNzZW1ibHkpKSB7XG4gICAgICAvLyBFeHRlbmQgdGhpcyBpbnRlcmZhY2UgZGlyZWN0bHkgc2luY2UgdGhpcyBtb2R1bGUgZG9lcyBub3QgaGF2ZSB0aGUgSnNpaSREZWZhdWx0XG4gICAgICBiYXNlSW50ZXJmYWNlcy5wdXNoKHRoaXMudG9OYXRpdmVGcW4odHlwZS5mcW4pKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdWZmaXggPSB0eXBlLmlzSW50ZXJmYWNlVHlwZSgpXG4gICAgICA/IGBleHRlbmRzIHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlPYmplY3QgaW1wbGVtZW50cyAke2Jhc2VJbnRlcmZhY2VzLmpvaW4oXG4gICAgICAgICAgJywgJyxcbiAgICAgICAgKX1gXG4gICAgICA6IGBleHRlbmRzICR7dGhpcy50b05hdGl2ZUZxbih0eXBlLmZxbil9JHtcbiAgICAgICAgICBiYXNlSW50ZXJmYWNlcy5sZW5ndGggPiAwXG4gICAgICAgICAgICA/IGAgaW1wbGVtZW50cyAke2Jhc2VJbnRlcmZhY2VzLmpvaW4oJywgJyl9YFxuICAgICAgICAgICAgOiAnJ1xuICAgICAgICB9YDtcblxuICAgIGNvbnN0IG1vZGlmaWVycyA9IHR5cGUuaXNJbnRlcmZhY2VUeXBlKCkgPyAnZmluYWwnIDogJ3ByaXZhdGUgc3RhdGljIGZpbmFsJztcblxuICAgIHRoaXMuY29kZS5saW5lKEFOTl9JTlRFUk5BTCk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhgJHttb2RpZmllcnN9IGNsYXNzICR7bmFtZX0gJHtzdWZmaXh9YCk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwcm90ZWN0ZWQgJHtuYW1lfShmaW5hbCBzb2Z0d2FyZS5hbWF6b24uanNpaS5Kc2lpT2JqZWN0UmVmIG9ialJlZilgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ3N1cGVyKG9ialJlZik7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcblxuICAgIC8vIGVtaXQgYWxsIHByb3BlcnRpZXNcbiAgICBmb3IgKGNvbnN0IHJlZmxlY3RQcm9wIG9mIHR5cGUuYWxsUHJvcGVydGllcy5maWx0ZXIoXG4gICAgICAocHJvcCkgPT5cbiAgICAgICAgcHJvcC5hYnN0cmFjdCAmJlxuICAgICAgICAocHJvcC5wYXJlbnRUeXBlLmZxbiA9PT0gdHlwZS5mcW4gfHxcbiAgICAgICAgICBwcm9wLnBhcmVudFR5cGUuaXNDbGFzc1R5cGUoKSB8fFxuICAgICAgICAgICFoYXNEZWZhdWx0SW50ZXJmYWNlcyhwcm9wLmFzc2VtYmx5KSksXG4gICAgKSkge1xuICAgICAgY29uc3QgcHJvcCA9IGNsb25lKHJlZmxlY3RQcm9wLnNwZWMpO1xuICAgICAgcHJvcC5hYnN0cmFjdCA9IGZhbHNlO1xuICAgICAgLy8gRW1pdHRpbmcgXCJmaW5hbFwiIHNpbmNlIHRoaXMgaXMgYSBwcm94eSBhbmQgbm90aGluZyB3aWxsL3Nob3VsZCBvdmVycmlkZSB0aGlzXG4gICAgICB0aGlzLmVtaXRQcm9wZXJ0eSh0eXBlLnNwZWMsIHByb3AsIHJlZmxlY3RQcm9wLmRlZmluaW5nVHlwZS5zcGVjLCB7XG4gICAgICAgIGZpbmFsOiB0cnVlLFxuICAgICAgICBvdmVycmlkZXM6IHRydWUsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBlbWl0IGFsbCB0aGUgbWV0aG9kc1xuICAgIGZvciAoY29uc3QgcmVmbGVjdE1ldGhvZCBvZiB0eXBlLmFsbE1ldGhvZHMuZmlsdGVyKFxuICAgICAgKG1ldGhvZCkgPT5cbiAgICAgICAgbWV0aG9kLmFic3RyYWN0ICYmXG4gICAgICAgIChtZXRob2QucGFyZW50VHlwZS5mcW4gPT09IHR5cGUuZnFuIHx8XG4gICAgICAgICAgbWV0aG9kLnBhcmVudFR5cGUuaXNDbGFzc1R5cGUoKSB8fFxuICAgICAgICAgICFoYXNEZWZhdWx0SW50ZXJmYWNlcyhtZXRob2QuYXNzZW1ibHkpKSxcbiAgICApKSB7XG4gICAgICBjb25zdCBtZXRob2QgPSBjbG9uZShyZWZsZWN0TWV0aG9kLnNwZWMpO1xuICAgICAgbWV0aG9kLmFic3RyYWN0ID0gZmFsc2U7XG4gICAgICAvLyBFbWl0dGluZyBcImZpbmFsXCIgc2luY2UgdGhpcyBpcyBhIHByb3h5IGFuZCBub3RoaW5nIHdpbGwvc2hvdWxkIG92ZXJyaWRlIHRoaXNcbiAgICAgIHRoaXMuZW1pdE1ldGhvZCh0eXBlLnNwZWMsIG1ldGhvZCwgeyBmaW5hbDogdHJ1ZSwgb3ZlcnJpZGVzOiB0cnVlIH0pO1xuXG4gICAgICBmb3IgKGNvbnN0IG92ZXJsb2FkZWRNZXRob2Qgb2YgdGhpcy5jcmVhdGVPdmVybG9hZHNGb3JPcHRpb25hbHMobWV0aG9kKSkge1xuICAgICAgICBvdmVybG9hZGVkTWV0aG9kLmFic3RyYWN0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZW1pdE1ldGhvZCh0eXBlLnNwZWMsIG92ZXJsb2FkZWRNZXRob2QsIHtcbiAgICAgICAgICBmaW5hbDogdHJ1ZSxcbiAgICAgICAgICBvdmVycmlkZXM6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gIH1cblxuICBwcml2YXRlIGVtaXREZWZhdWx0SW1wbGVtZW50YXRpb24odHlwZTogcmVmbGVjdC5JbnRlcmZhY2VUeXBlKSB7XG4gICAgY29uc3QgYmFzZUludGVyZmFjZXMgPSBbdHlwZS5uYW1lLCAuLi50aGlzLmRlZmF1bHRJbnRlcmZhY2VzRm9yKHR5cGUpXTtcblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYCAqIEludGVybmFsIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gZm9yIHtAbGluayAke3R5cGUubmFtZX19LmAsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoQU5OX0lOVEVSTkFMKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgYGludGVyZmFjZSAke0lOVEVSRkFDRV9ERUZBVUxUX0NMQVNTX05BTUV9IGV4dGVuZHMgJHtiYXNlSW50ZXJmYWNlc1xuICAgICAgICAuc29ydCgpXG4gICAgICAgIC5qb2luKCcsICcpfWAsXG4gICAgKTtcblxuICAgIGZvciAoY29uc3QgcHJvcGVydHkgb2YgdHlwZS5hbGxQcm9wZXJ0aWVzLmZpbHRlcihcbiAgICAgIChwcm9wKSA9PlxuICAgICAgICBwcm9wLmFic3RyYWN0ICYmXG4gICAgICAgIC8vIE9ubHkgY2hlY2tpbmcgdGhlIGdldHRlciAtIGphdmEubGFuZy5PYmplY3QgaGFzIG5vIHNldHRlcnMuXG4gICAgICAgICFpc0phdmFMYW5nT2JqZWN0TWV0aG9kTmFtZShgZ2V0JHtqc2lpVG9QYXNjYWxDYXNlKHByb3AubmFtZSl9YCkgJiZcbiAgICAgICAgKHByb3AucGFyZW50VHlwZS5mcW4gPT09IHR5cGUuZnFuIHx8XG4gICAgICAgICAgIWhhc0RlZmF1bHRJbnRlcmZhY2VzKHByb3AuYXNzZW1ibHkpKSxcbiAgICApKSB7XG4gICAgICB0aGlzLmVtaXRQcm9wZXJ0eSh0eXBlLnNwZWMsIHByb3BlcnR5LnNwZWMsIHByb3BlcnR5LmRlZmluaW5nVHlwZS5zcGVjLCB7XG4gICAgICAgIGRlZmF1bHRJbXBsOiB0cnVlLFxuICAgICAgICBvdmVycmlkZXM6IHR5cGUuaXNJbnRlcmZhY2VUeXBlKCksXG4gICAgICB9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBtZXRob2Qgb2YgdHlwZS5hbGxNZXRob2RzLmZpbHRlcihcbiAgICAgIChtZXRob2QpID0+XG4gICAgICAgIG1ldGhvZC5hYnN0cmFjdCAmJlxuICAgICAgICAhaXNKYXZhTGFuZ09iamVjdE1ldGhvZE5hbWUobWV0aG9kLm5hbWUpICYmXG4gICAgICAgIChtZXRob2QucGFyZW50VHlwZS5mcW4gPT09IHR5cGUuZnFuIHx8XG4gICAgICAgICAgIWhhc0RlZmF1bHRJbnRlcmZhY2VzKG1ldGhvZC5hc3NlbWJseSkpLFxuICAgICkpIHtcbiAgICAgIHRoaXMuZW1pdE1ldGhvZCh0eXBlLnNwZWMsIG1ldGhvZC5zcGVjLCB7XG4gICAgICAgIGRlZmF1bHRJbXBsOiB0cnVlLFxuICAgICAgICBvdmVycmlkZXM6IHR5cGUuaXNJbnRlcmZhY2VUeXBlKCksXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgfVxuXG4gIHByaXZhdGUgZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKGVudGl0eTogc3BlYy5Eb2N1bWVudGFibGUpIHtcbiAgICBpZiAoIWVudGl0eS5kb2NzKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChlbnRpdHkuZG9jcy5zdGFiaWxpdHkpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgICBgQHNvZnR3YXJlLmFtYXpvbi5qc2lpLlN0YWJpbGl0eShzb2Z0d2FyZS5hbWF6b24uanNpaS5TdGFiaWxpdHkuTGV2ZWwuJHtfbGV2ZWwoXG4gICAgICAgICAgZW50aXR5LmRvY3Muc3RhYmlsaXR5LFxuICAgICAgICApfSlgLFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgZW50aXR5LmRvY3Muc3RhYmlsaXR5ID09PSBzcGVjLlN0YWJpbGl0eS5EZXByZWNhdGVkIHx8XG4gICAgICBlbnRpdHkuZG9jcy5kZXByZWNhdGVkXG4gICAgKSB7XG4gICAgICB0aGlzLmNvZGUubGluZSgnQERlcHJlY2F0ZWQnKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfbGV2ZWwoc3RhYmlsaXR5OiBzcGVjLlN0YWJpbGl0eSk6IHN0cmluZyB7XG4gICAgICBzd2l0Y2ggKHN0YWJpbGl0eSkge1xuICAgICAgICBjYXNlIHNwZWMuU3RhYmlsaXR5LkRlcHJlY2F0ZWQ6XG4gICAgICAgICAgcmV0dXJuICdEZXByZWNhdGVkJztcbiAgICAgICAgY2FzZSBzcGVjLlN0YWJpbGl0eS5FeHBlcmltZW50YWw6XG4gICAgICAgICAgcmV0dXJuICdFeHBlcmltZW50YWwnO1xuICAgICAgICBjYXNlIHNwZWMuU3RhYmlsaXR5LkV4dGVybmFsOlxuICAgICAgICAgIC8vIFJlbmRlcmluZyAnRXh0ZXJuYWwnIG91dCBhcyBwdWJsaWNseSB2aXNpYmxlIHN0YXRlIGlzIGNvbmZ1c2luZy4gQXMgZmFyXG4gICAgICAgICAgLy8gYXMgdXNlcnMgYXJlIGNvbmNlcm5lZCB3ZSBqdXN0IGFkdmVydGlzZSB0aGlzIGFzIHN0YWJsZS5cbiAgICAgICAgICByZXR1cm4gJ1N0YWJsZSc7XG4gICAgICAgIGNhc2Ugc3BlYy5TdGFiaWxpdHkuU3RhYmxlOlxuICAgICAgICAgIHJldHVybiAnU3RhYmxlJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgc3RhYmlsaXR5OiAke3N0YWJpbGl0eSBhcyBhbnl9YCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB0b0phdmFQcm9wKFxuICAgIHByb3BlcnR5OiBzcGVjLlByb3BlcnR5LFxuICAgIGRlZmluaW5nVHlwZTogc3BlYy5UeXBlLFxuICAgIGluaGVyaXRlZDogYm9vbGVhbixcbiAgKTogSmF2YVByb3Age1xuICAgIGNvbnN0IHNhZmVOYW1lID0gSmF2YUdlbmVyYXRvci5zYWZlSmF2YVByb3BlcnR5TmFtZShwcm9wZXJ0eS5uYW1lKTtcbiAgICBjb25zdCBwcm9wTmFtZSA9IGpzaWlUb1Bhc2NhbENhc2Uoc2FmZU5hbWUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRvY3M6IHByb3BlcnR5LmRvY3MsXG4gICAgICBzcGVjOiBwcm9wZXJ0eSxcbiAgICAgIGRlZmluaW5nVHlwZSxcbiAgICAgIHByb3BOYW1lLFxuICAgICAganNpaU5hbWU6IHByb3BlcnR5Lm5hbWUsXG4gICAgICBudWxsYWJsZTogISFwcm9wZXJ0eS5vcHRpb25hbCxcbiAgICAgIGZpZWxkTmFtZTogdGhpcy5jb2RlLnRvQ2FtZWxDYXNlKHNhZmVOYW1lKSxcbiAgICAgIGZpZWxkSmF2YVR5cGU6IHRoaXMudG9KYXZhVHlwZShwcm9wZXJ0eS50eXBlKSxcbiAgICAgIHBhcmFtSmF2YVR5cGU6IHRoaXMudG9KYXZhVHlwZShwcm9wZXJ0eS50eXBlLCB7IGNvdmFyaWFudDogdHJ1ZSB9KSxcbiAgICAgIGZpZWxkTmF0aXZlVHlwZTogdGhpcy50b05hdGl2ZVR5cGUocHJvcGVydHkudHlwZSksXG4gICAgICBmaWVsZEphdmFDbGFzczogYCR7dGhpcy50b0phdmFUeXBlKHByb3BlcnR5LnR5cGUsIHtcbiAgICAgICAgZm9yTWFyc2hhbGxpbmc6IHRydWUsXG4gICAgICB9KX0uY2xhc3NgLFxuICAgICAgamF2YVR5cGVzOiB0aGlzLnRvSmF2YVR5cGVzKHByb3BlcnR5LnR5cGUsIHsgY292YXJpYW50OiB0cnVlIH0pLFxuICAgICAgaW1tdXRhYmxlOiBwcm9wZXJ0eS5pbW11dGFibGUgPz8gZmFsc2UsXG4gICAgICBpbmhlcml0ZWQsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgZW1pdENsYXNzQnVpbGRlcihjbHM6IHNwZWMuQ2xhc3NUeXBlKSB7XG4gICAgLy8gTm90IHJlbmRlcmluZyBpZiB0aGVyZSBpcyBubyBpbml0aWFsaXplciwgb3IgaWYgdGhlIGluaXRpYWxpemVyIGlzIHByb3RlY3RlZCBvciB2YXJpYWRpY1xuICAgIGlmIChjbHMuaW5pdGlhbGl6ZXIgPT0gbnVsbCB8fCBjbHMuaW5pdGlhbGl6ZXIucHJvdGVjdGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIE5vdCByZW5kZXJpbmcgaWYgdGhlIGluaXRpYWxpemVyIGhhcyBubyBwYXJhbWV0ZXJzXG4gICAgaWYgKGNscy5pbml0aWFsaXplci5wYXJhbWV0ZXJzID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gTm90IHJlbmRlcmluZyBpZiB0aGVyZSBpcyBhIG5lc3RlZCBcIkJ1aWxkZXJcIiBjbGFzc1xuICAgIGlmIChcbiAgICAgIHRoaXMucmVmbGVjdEFzc2VtYmx5LnRyeUZpbmRUeXBlKGAke2Nscy5mcW59LiR7QlVJTERFUl9DTEFTU19OQU1FfWApICE9XG4gICAgICBudWxsXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRmluZCB0aGUgZmlyc3Qgc3RydWN0IHBhcmFtZXRlciBvZiB0aGUgY29uc3RydWN0b3IgKGlmIGFueSlcbiAgICBjb25zdCBmaXJzdFN0cnVjdCA9IGNscy5pbml0aWFsaXplci5wYXJhbWV0ZXJzLmZpbmQoKHBhcmFtKSA9PiB7XG4gICAgICBpZiAoIXNwZWMuaXNOYW1lZFR5cGVSZWZlcmVuY2UocGFyYW0udHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFyYW1UeXBlID0gdGhpcy5yZWZsZWN0QXNzZW1ibHkudHJ5RmluZFR5cGUocGFyYW0udHlwZS5mcW4pO1xuICAgICAgcmV0dXJuIHBhcmFtVHlwZT8uaXNEYXRhVHlwZSgpO1xuICAgIH0pO1xuXG4gICAgLy8gTm90IHJlbmRlcmluZyBpZiB0aGVyZSBpcyBubyBzdHJ1Y3QgcGFyYW1ldGVyXG4gICAgaWYgKGZpcnN0U3RydWN0ID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBzdHJ1Y3RUeXBlID0gdGhpcy5yZWZsZWN0QXNzZW1ibHkuZmluZFR5cGUoXG4gICAgICAoZmlyc3RTdHJ1Y3QudHlwZSBhcyBzcGVjLk5hbWVkVHlwZVJlZmVyZW5jZSkuZnFuLFxuICAgICkgYXMgcmVmbGVjdC5JbnRlcmZhY2VUeXBlO1xuICAgIGNvbnN0IHN0cnVjdFBhcmFtTmFtZSA9IHRoaXMuY29kZS50b0NhbWVsQ2FzZShcbiAgICAgIEphdmFHZW5lcmF0b3Iuc2FmZUphdmFQcm9wZXJ0eU5hbWUoZmlyc3RTdHJ1Y3QubmFtZSksXG4gICAgKTtcbiAgICBjb25zdCBzdHJ1Y3RCdWlsZGVyID0gYCR7dGhpcy50b0phdmFUeXBlKFxuICAgICAgZmlyc3RTdHJ1Y3QudHlwZSxcbiAgICApfS4ke0JVSUxERVJfQ0xBU1NfTkFNRX1gO1xuXG4gICAgY29uc3QgcG9zaXRpb25hbFBhcmFtcyA9IGNscy5pbml0aWFsaXplci5wYXJhbWV0ZXJzXG4gICAgICAuZmlsdGVyKChwKSA9PiBwICE9PSBmaXJzdFN0cnVjdClcbiAgICAgIC5tYXAoKHBhcmFtKSA9PiAoe1xuICAgICAgICBwYXJhbSxcbiAgICAgICAgZmllbGROYW1lOiB0aGlzLmNvZGUudG9DYW1lbENhc2UoXG4gICAgICAgICAgSmF2YUdlbmVyYXRvci5zYWZlSmF2YVByb3BlcnR5TmFtZShwYXJhbS5uYW1lKSxcbiAgICAgICAgKSxcbiAgICAgICAgamF2YVR5cGU6IHRoaXMudG9KYXZhVHlwZShwYXJhbS50eXBlKSxcbiAgICAgIH0pKTtcblxuICAgIGNvbnN0IGJ1aWx0VHlwZSA9IHRoaXMudG9KYXZhVHlwZShjbHMpO1xuXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnLyoqJyk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZXR0aWVyL3ByZXR0aWVyXG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgICogJHtzdGFiaWxpdHlQcmVmaXhGb3IoXG4gICAgICAgIGNscy5pbml0aWFsaXplcixcbiAgICAgICl9QSBmbHVlbnQgYnVpbGRlciBmb3Ige0BsaW5rICR7YnVpbHRUeXBlfX0uYCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKCcgKi8nKTtcbiAgICB0aGlzLmVtaXRTdGFiaWxpdHlBbm5vdGF0aW9ucyhjbHMuaW5pdGlhbGl6ZXIpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICBgcHVibGljIHN0YXRpYyBmaW5hbCBjbGFzcyAke0JVSUxERVJfQ0xBU1NfTkFNRX0gaW1wbGVtZW50cyBzb2Z0d2FyZS5hbWF6b24uanNpaS5CdWlsZGVyPCR7YnVpbHRUeXBlfT5gLFxuICAgICk7XG5cbiAgICAvLyBTdGF0aWMgZmFjdG9yeSBtZXRob2QocylcbiAgICBmb3IgKGNvbnN0IHBhcmFtcyBvZiBjb21wdXRlT3ZlcnJpZGVzKHBvc2l0aW9uYWxQYXJhbXMpKSB7XG4gICAgICBjb25zdCBkdW1teU1ldGhvZDogc3BlYy5NZXRob2QgPSB7XG4gICAgICAgIGRvY3M6IHtcbiAgICAgICAgICBzdGFiaWxpdHk6IGNscy5pbml0aWFsaXplci5kb2NzPy5zdGFiaWxpdHkgPz8gY2xzLmRvY3M/LnN0YWJpbGl0eSxcbiAgICAgICAgICByZXR1cm5zOiBgYSBuZXcgaW5zdGFuY2Ugb2Yge0BsaW5rICR7QlVJTERFUl9DTEFTU19OQU1FfX0uYCxcbiAgICAgICAgfSxcbiAgICAgICAgbmFtZTogJ2NyZWF0ZScsXG4gICAgICAgIHBhcmFtZXRlcnM6IHBhcmFtcy5tYXAoKHBhcmFtKSA9PiBwYXJhbS5wYXJhbSksXG4gICAgICB9O1xuICAgICAgdGhpcy5hZGRKYXZhRG9jcyhkdW1teU1ldGhvZCwge1xuICAgICAgICBhcGk6ICdtZW1iZXInLFxuICAgICAgICBmcW46IGNscy5mcW4sXG4gICAgICAgIG1lbWJlck5hbWU6IGR1bW15TWV0aG9kLm5hbWUsXG4gICAgICB9KTtcbiAgICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKGNscy5pbml0aWFsaXplcik7XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgICBgcHVibGljIHN0YXRpYyAke0JVSUxERVJfQ0xBU1NfTkFNRX0gY3JlYXRlKCR7cGFyYW1zXG4gICAgICAgICAgLm1hcChcbiAgICAgICAgICAgIChwYXJhbSkgPT5cbiAgICAgICAgICAgICAgYGZpbmFsICR7cGFyYW0uamF2YVR5cGV9JHtwYXJhbS5wYXJhbS52YXJpYWRpYyA/ICcuLi4nIDogJyd9ICR7XG4gICAgICAgICAgICAgICAgcGFyYW0uZmllbGROYW1lXG4gICAgICAgICAgICAgIH1gLFxuICAgICAgICAgIClcbiAgICAgICAgICAuam9pbignLCAnKX0pYCxcbiAgICAgICk7XG4gICAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICAgYHJldHVybiBuZXcgJHtCVUlMREVSX0NMQVNTX05BTUV9KCR7cG9zaXRpb25hbFBhcmFtc1xuICAgICAgICAgIC5tYXAoKHBhcmFtLCBpZHgpID0+IChpZHggPCBwYXJhbXMubGVuZ3RoID8gcGFyYW0uZmllbGROYW1lIDogJ251bGwnKSlcbiAgICAgICAgICAuam9pbignLCAnKX0pO2AsXG4gICAgICApO1xuICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB9XG5cbiAgICAvLyBQcml2YXRlIHByb3BlcnRpZXNcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIGZvciAoY29uc3QgcGFyYW0gb2YgcG9zaXRpb25hbFBhcmFtcykge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAgIGBwcml2YXRlIGZpbmFsICR7cGFyYW0uamF2YVR5cGV9JHtwYXJhbS5wYXJhbS52YXJpYWRpYyA/ICdbXScgOiAnJ30gJHtcbiAgICAgICAgICBwYXJhbS5maWVsZE5hbWVcbiAgICAgICAgfTtgLFxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgcHJpdmF0ZSAke1xuICAgICAgICBmaXJzdFN0cnVjdC5vcHRpb25hbCA/ICcnIDogJ2ZpbmFsICdcbiAgICAgIH0ke3N0cnVjdEJ1aWxkZXJ9ICR7c3RydWN0UGFyYW1OYW1lfTtgLFxuICAgICk7XG5cbiAgICAvLyBQcml2YXRlIGNvbnN0cnVjdG9yXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgYHByaXZhdGUgJHtCVUlMREVSX0NMQVNTX05BTUV9KCR7cG9zaXRpb25hbFBhcmFtc1xuICAgICAgICAubWFwKFxuICAgICAgICAgIChwYXJhbSkgPT5cbiAgICAgICAgICAgIGBmaW5hbCAke3BhcmFtLmphdmFUeXBlfSR7cGFyYW0ucGFyYW0udmFyaWFkaWMgPyAnLi4uJyA6ICcnfSAke1xuICAgICAgICAgICAgICBwYXJhbS5maWVsZE5hbWVcbiAgICAgICAgICAgIH1gLFxuICAgICAgICApXG4gICAgICAgIC5qb2luKCcsICcpfSlgLFxuICAgICk7XG4gICAgZm9yIChjb25zdCBwYXJhbSBvZiBwb3NpdGlvbmFsUGFyYW1zKSB7XG4gICAgICB0aGlzLmNvZGUubGluZShgdGhpcy4ke3BhcmFtLmZpZWxkTmFtZX0gPSAke3BhcmFtLmZpZWxkTmFtZX07YCk7XG4gICAgfVxuICAgIGlmICghZmlyc3RTdHJ1Y3Qub3B0aW9uYWwpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKGB0aGlzLiR7c3RydWN0UGFyYW1OYW1lfSA9IG5ldyAke3N0cnVjdEJ1aWxkZXJ9KCk7YCk7XG4gICAgfVxuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG5cbiAgICAvLyBGaWVsZHNcbiAgICBmb3IgKGNvbnN0IHByb3Agb2Ygc3RydWN0VHlwZS5hbGxQcm9wZXJ0aWVzKSB7XG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSB0aGlzLmNvZGUudG9DYW1lbENhc2UoXG4gICAgICAgIEphdmFHZW5lcmF0b3Iuc2FmZUphdmFQcm9wZXJ0eU5hbWUocHJvcC5uYW1lKSxcbiAgICAgICk7XG4gICAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgICAgY29uc3Qgc2V0dGVyOiBzcGVjLk1ldGhvZCA9IHtcbiAgICAgICAgbmFtZTogZmllbGROYW1lLFxuICAgICAgICBkb2NzOiB7XG4gICAgICAgICAgLi4ucHJvcC5zcGVjLmRvY3MsXG4gICAgICAgICAgc3RhYmlsaXR5OiBwcm9wLnNwZWMuZG9jcz8uc3RhYmlsaXR5LFxuICAgICAgICAgIHJldHVybnM6ICd7QGNvZGUgdGhpc30nLFxuICAgICAgICB9LFxuICAgICAgICBwYXJhbWV0ZXJzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogZmllbGROYW1lLFxuICAgICAgICAgICAgdHlwZTogc3BlYy5DQU5PTklDQUxfQU5ZLCAvLyBXZSBkb24ndCBxdWl0ZSBjYXJlIGluIHRoaXMgY29udGV4dCFcbiAgICAgICAgICAgIGRvY3M6IHByb3Auc3BlYy5kb2NzLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9O1xuICAgICAgZm9yIChjb25zdCBqYXZhVHlwZSBvZiB0aGlzLnRvSmF2YVR5cGVzKHByb3AudHlwZS5zcGVjISwge1xuICAgICAgICBjb3ZhcmlhbnQ6IHRydWUsXG4gICAgICB9KSkge1xuICAgICAgICB0aGlzLmFkZEphdmFEb2NzKHNldHRlciwge1xuICAgICAgICAgIGFwaTogJ21lbWJlcicsXG4gICAgICAgICAgZnFuOiBwcm9wLmRlZmluaW5nVHlwZS5mcW4sIC8vIENvdWxkIGJlIGluaGVyaXRlZFxuICAgICAgICAgIG1lbWJlck5hbWU6IHByb3AubmFtZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKHByb3Auc3BlYyk7XG4gICAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICAgICAgYHB1YmxpYyAke0JVSUxERVJfQ0xBU1NfTkFNRX0gJHtmaWVsZE5hbWV9KGZpbmFsICR7amF2YVR5cGV9ICR7ZmllbGROYW1lfSlgLFxuICAgICAgICApO1xuICAgICAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICAgICBgdGhpcy4ke3N0cnVjdFBhcmFtTmFtZX0ke1xuICAgICAgICAgICAgZmlyc3RTdHJ1Y3Qub3B0aW9uYWwgPyAnKCknIDogJydcbiAgICAgICAgICB9LiR7ZmllbGROYW1lfSgke2ZpZWxkTmFtZX0pO2AsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY29kZS5saW5lKCdyZXR1cm4gdGhpczsnKTtcbiAgICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaW5hbCBidWlsZCBtZXRob2RcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGAgKiBAcmV0dXJucyBhIG5ld2x5IGJ1aWx0IGluc3RhbmNlIG9mIHtAbGluayAke2J1aWx0VHlwZX19LmAsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMoY2xzLmluaXRpYWxpemVyKTtcbiAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhgcHVibGljICR7YnVpbHRUeXBlfSBidWlsZCgpYCk7XG4gICAgY29uc3QgcGFyYW1zID0gY2xzLmluaXRpYWxpemVyLnBhcmFtZXRlcnMubWFwKChwYXJhbSkgPT4ge1xuICAgICAgaWYgKHBhcmFtID09PSBmaXJzdFN0cnVjdCkge1xuICAgICAgICByZXR1cm4gZmlyc3RTdHJ1Y3Qub3B0aW9uYWxcbiAgICAgICAgICA/IGB0aGlzLiR7c3RydWN0UGFyYW1OYW1lfSAhPSBudWxsID8gdGhpcy4ke3N0cnVjdFBhcmFtTmFtZX0uYnVpbGQoKSA6IG51bGxgXG4gICAgICAgICAgOiBgdGhpcy4ke3N0cnVjdFBhcmFtTmFtZX0uYnVpbGQoKWA7XG4gICAgICB9XG4gICAgICByZXR1cm4gYHRoaXMuJHtcbiAgICAgICAgcG9zaXRpb25hbFBhcmFtcy5maW5kKChwKSA9PiBwYXJhbSA9PT0gcC5wYXJhbSkhLmZpZWxkTmFtZVxuICAgICAgfWA7XG4gICAgfSk7XG4gICAgdGhpcy5jb2RlLmluZGVudChgcmV0dXJuIG5ldyAke2J1aWx0VHlwZX0oYCk7XG4gICAgcGFyYW1zLmZvckVhY2goKHBhcmFtLCBpZHgpID0+XG4gICAgICB0aGlzLmNvZGUubGluZShgJHtwYXJhbX0ke2lkeCA8IHBhcmFtcy5sZW5ndGggLSAxID8gJywnIDogJyd9YCksXG4gICAgKTtcbiAgICB0aGlzLmNvZGUudW5pbmRlbnQoJyk7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcblxuICAgIC8vIE9wdGlvbmFsIGJ1aWxkZXIgaW5pdGlhbGl6YXRpb25cbiAgICBpZiAoZmlyc3RTdHJ1Y3Qub3B0aW9uYWwpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKGBwcml2YXRlICR7c3RydWN0QnVpbGRlcn0gJHtzdHJ1Y3RQYXJhbU5hbWV9KClgKTtcbiAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soYGlmICh0aGlzLiR7c3RydWN0UGFyYW1OYW1lfSA9PSBudWxsKWApO1xuICAgICAgdGhpcy5jb2RlLmxpbmUoYHRoaXMuJHtzdHJ1Y3RQYXJhbU5hbWV9ID0gbmV3ICR7c3RydWN0QnVpbGRlcn0oKTtgKTtcbiAgICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgICB0aGlzLmNvZGUubGluZShgcmV0dXJuIHRoaXMuJHtzdHJ1Y3RQYXJhbU5hbWV9O2ApO1xuICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgfVxuXG4gIHByaXZhdGUgZW1pdEJ1aWxkZXJTZXR0ZXIoXG4gICAgcHJvcDogSmF2YVByb3AsXG4gICAgYnVpbGRlck5hbWU6IHN0cmluZyxcbiAgICBwYXJlbnRUeXBlOiBzcGVjLkludGVyZmFjZVR5cGUsXG4gICkge1xuICAgIGZvciAoY29uc3QgdHlwZSBvZiBwcm9wLmphdmFUeXBlcykge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgICBgICogU2V0cyB0aGUgdmFsdWUgb2Yge0BsaW5rICR7cGFyZW50VHlwZS5uYW1lfSMke2dldHRlckZvcihcbiAgICAgICAgICBwcm9wLmZpZWxkTmFtZSxcbiAgICAgICAgKX19YCxcbiAgICAgICk7XG4gICAgICBjb25zdCBzdW1tYXJ5ID0gcHJvcC5kb2NzPy5zdW1tYXJ5ID8/ICd0aGUgdmFsdWUgdG8gYmUgc2V0JztcbiAgICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgICBgICogJHtwYXJhbUphdmFkb2MocHJvcC5maWVsZE5hbWUsIHByb3AubnVsbGFibGUsIHN1bW1hcnkpfWAsXG4gICAgICApO1xuICAgICAgaWYgKHByb3AuZG9jcz8ucmVtYXJrcyAhPSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGluZGVudCA9ICcgJy5yZXBlYXQoNyArIHByb3AuZmllbGROYW1lLmxlbmd0aCk7XG4gICAgICAgIGNvbnN0IHJlbWFya3MgPSBtYXJrRG93blRvSmF2YURvYyhcbiAgICAgICAgICB0aGlzLmNvbnZlcnRTYW1wbGVzSW5NYXJrZG93bihwcm9wLmRvY3MucmVtYXJrcywge1xuICAgICAgICAgICAgYXBpOiAnbWVtYmVyJyxcbiAgICAgICAgICAgIGZxbjogcHJvcC5kZWZpbmluZ1R5cGUuZnFuLFxuICAgICAgICAgICAgbWVtYmVyTmFtZTogcHJvcC5qc2lpTmFtZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKS50cmltUmlnaHQoKTtcbiAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIHJlbWFya3Muc3BsaXQoJ1xcbicpKSB7XG4gICAgICAgICAgdGhpcy5jb2RlLmxpbmUoYCAqICR7aW5kZW50fSAke2xpbmV9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuY29kZS5saW5lKCcgKiBAcmV0dXJuIHtAY29kZSB0aGlzfScpO1xuICAgICAgaWYgKHByb3AuZG9jcz8uZGVwcmVjYXRlZCkge1xuICAgICAgICB0aGlzLmNvZGUubGluZShgICogQGRlcHJlY2F0ZWQgJHtwcm9wLmRvY3MuZGVwcmVjYXRlZH1gKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY29kZS5saW5lKCcgKi8nKTtcbiAgICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKHByb3Auc3BlYyk7XG4gICAgICAvLyBXZSBhZGQgYW4gZXhwbGljaXQgY2FzdCBpZiBib3RoIHR5cGVzIGFyZSBnZW5lcmljIGJ1dCB0aGV5IGFyZSBub3QgaWRlbnRpY2FsIChvbmUgaXMgY292YXJpYW50LCB0aGUgb3RoZXIgaXNuJ3QpXG4gICAgICBjb25zdCBleHBsaWNpdENhc3QgPVxuICAgICAgICB0eXBlLmluY2x1ZGVzKCc8JykgJiZcbiAgICAgICAgcHJvcC5maWVsZEphdmFUeXBlLmluY2x1ZGVzKCc8JykgJiZcbiAgICAgICAgdHlwZSAhPT0gcHJvcC5maWVsZEphdmFUeXBlXG4gICAgICAgICAgPyBgKCR7cHJvcC5maWVsZEphdmFUeXBlfSlgXG4gICAgICAgICAgOiAnJztcbiAgICAgIGlmIChleHBsaWNpdENhc3QgIT09ICcnKSB7XG4gICAgICAgIC8vIFdlJ2xsIGJlIGRvaW5nIGEgc2FmZSwgYnV0IHVuY2hlY2tlZCBjYXN0LCBzbyBzdXBwcmVzcyB0aGF0IHdhcm5pbmdcbiAgICAgICAgdGhpcy5jb2RlLmxpbmUoJ0BTdXBwcmVzc1dhcm5pbmdzKFwidW5jaGVja2VkXCIpJyk7XG4gICAgICB9XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgICBgcHVibGljICR7YnVpbGRlck5hbWV9ICR7cHJvcC5maWVsZE5hbWV9KCR7dHlwZX0gJHtwcm9wLmZpZWxkTmFtZX0pYCxcbiAgICAgICk7XG4gICAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICAgYHRoaXMuJHtwcm9wLmZpZWxkTmFtZX0gPSAke2V4cGxpY2l0Q2FzdH0ke3Byb3AuZmllbGROYW1lfTtgLFxuICAgICAgKTtcbiAgICAgIHRoaXMuY29kZS5saW5lKCdyZXR1cm4gdGhpczsnKTtcbiAgICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0dGVyRm9yKGZpZWxkTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgIGNvbnN0IFtmaXJzdCwgLi4ucmVzdF0gPSBmaWVsZE5hbWU7XG4gICAgICByZXR1cm4gYGdldCR7Zmlyc3QudG9VcHBlckNhc2UoKX0ke3Jlc3Quam9pbignJyl9YDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGVtaXRJbnRlcmZhY2VCdWlsZGVyKFxuICAgIGNsYXNzU3BlYzogc3BlYy5JbnRlcmZhY2VUeXBlLFxuICAgIGNvbnN0cnVjdG9yTmFtZTogc3RyaW5nLFxuICAgIHByb3BzOiBKYXZhUHJvcFtdLFxuICApIHtcbiAgICAvLyBTdGFydCBidWlsZGVyKClcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGAgKiBAcmV0dXJuIGEge0BsaW5rICR7QlVJTERFUl9DTEFTU19OQU1FfX0gb2Yge0BsaW5rICR7Y2xhc3NTcGVjLm5hbWV9fWAsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMoY2xhc3NTcGVjKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKGBzdGF0aWMgJHtCVUlMREVSX0NMQVNTX05BTUV9IGJ1aWxkZXIoKWApO1xuICAgIHRoaXMuY29kZS5saW5lKGByZXR1cm4gbmV3ICR7QlVJTERFUl9DTEFTU19OQU1FfSgpO2ApO1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgLy8gRW5kIGJ1aWxkZXIoKVxuXG4gICAgLy8gU3RhcnQgQnVpbGRlclxuICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICB0aGlzLmNvZGUubGluZShgICogQSBidWlsZGVyIGZvciB7QGxpbmsgJHtjbGFzc1NwZWMubmFtZX19YCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJyAqLycpO1xuICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKGNsYXNzU3BlYyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwdWJsaWMgc3RhdGljIGZpbmFsIGNsYXNzICR7QlVJTERFUl9DTEFTU19OQU1FfSBpbXBsZW1lbnRzIHNvZnR3YXJlLmFtYXpvbi5qc2lpLkJ1aWxkZXI8JHtjbGFzc1NwZWMubmFtZX0+YCxcbiAgICApO1xuXG4gICAgcHJvcHMuZm9yRWFjaCgocHJvcCkgPT5cbiAgICAgIHRoaXMuY29kZS5saW5lKGAke3Byb3AuZmllbGRKYXZhVHlwZX0gJHtwcm9wLmZpZWxkTmFtZX07YCksXG4gICAgKTtcbiAgICBwcm9wcy5mb3JFYWNoKChwcm9wKSA9PlxuICAgICAgdGhpcy5lbWl0QnVpbGRlclNldHRlcihwcm9wLCBCVUlMREVSX0NMQVNTX05BTUUsIGNsYXNzU3BlYyksXG4gICAgKTtcblxuICAgIC8vIFN0YXJ0IGJ1aWxkKClcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICogQnVpbGRzIHRoZSBjb25maWd1cmVkIGluc3RhbmNlLicpO1xuICAgIHRoaXMuY29kZS5saW5lKGAgKiBAcmV0dXJuIGEgbmV3IGluc3RhbmNlIG9mIHtAbGluayAke2NsYXNzU3BlYy5uYW1lfX1gKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICcgKiBAdGhyb3dzIE51bGxQb2ludGVyRXhjZXB0aW9uIGlmIGFueSByZXF1aXJlZCBhdHRyaWJ1dGUgd2FzIG5vdCBwcm92aWRlZCcsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5lbWl0U3RhYmlsaXR5QW5ub3RhdGlvbnMoY2xhc3NTcGVjKTtcbiAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhgcHVibGljICR7Y2xhc3NTcGVjLm5hbWV9IGJ1aWxkKClgKTtcblxuICAgIHRoaXMuY29kZS5saW5lKGByZXR1cm4gbmV3ICR7Y29uc3RydWN0b3JOYW1lfSh0aGlzKTtgKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIC8vIEVuZCBidWlsZCgpXG5cbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIC8vIEVuZCBCdWlsZGVyXG4gIH1cblxuICBwcml2YXRlIGVtaXREYXRhVHlwZShpZmM6IHNwZWMuSW50ZXJmYWNlVHlwZSkge1xuICAgIC8vIGNvbGxlY3QgYWxsIHByb3BlcnRpZXMgZnJvbSBhbGwgYmFzZSBzdHJ1Y3RzIGFuZCBkZWR1cGUgYnkgbmFtZS4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZSBnZW5lcmF0aW9uIG9mIHRoZVxuICAgIC8vIGFzc2VtYmx5IHdpbGwgbm90IHBlcm1pdCBtdWx0aXBsZSBvdmVybG9hZGVkIGluaGVyaXRlZCBwcm9wZXJ0aWVzIHdpdGggdGhlIHNhbWUgbmFtZSBhbmQgdGhhdCB0aGlzIHdpbGwgYmVcbiAgICAvLyBlbmZvcmNlZCBieSBUeXBlc2NyaXB0IGNvbnN0cmFpbnRzLlxuICAgIGNvbnN0IHByb3BzQnlOYW1lOiB7IFtuYW1lOiBzdHJpbmddOiBKYXZhUHJvcCB9ID0ge307XG5cbiAgICBmdW5jdGlvbiBjb2xsZWN0UHJvcHMoXG4gICAgICB0aGlzOiBKYXZhR2VuZXJhdG9yLFxuICAgICAgY3VycmVudElmYzogc3BlYy5JbnRlcmZhY2VUeXBlLFxuICAgICAgaXNCYXNlQ2xhc3MgPSBmYWxzZSxcbiAgICApIHtcbiAgICAgIGZvciAoY29uc3QgcHJvcGVydHkgb2YgY3VycmVudElmYy5wcm9wZXJ0aWVzID8/IFtdKSB7XG4gICAgICAgIGNvbnN0IGphdmFQcm9wID0gdGhpcy50b0phdmFQcm9wKHByb3BlcnR5LCBjdXJyZW50SWZjLCBpc0Jhc2VDbGFzcyk7XG4gICAgICAgIHByb3BzQnlOYW1lW2phdmFQcm9wLnByb3BOYW1lXSA9IGphdmFQcm9wO1xuICAgICAgfVxuXG4gICAgICAvLyBhZGQgcHJvcHMgb2YgYmFzZSBzdHJ1Y3RcbiAgICAgIGZvciAoY29uc3QgYmFzZSBvZiBjdXJyZW50SWZjLmludGVyZmFjZXMgPz8gW10pIHtcbiAgICAgICAgY29sbGVjdFByb3BzLmNhbGwoXG4gICAgICAgICAgdGhpcyxcbiAgICAgICAgICB0aGlzLmZpbmRUeXBlKGJhc2UpIGFzIHNwZWMuSW50ZXJmYWNlVHlwZSxcbiAgICAgICAgICB0cnVlLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbGxlY3RQcm9wcy5jYWxsKHRoaXMsIGlmYyk7XG4gICAgY29uc3QgcHJvcHMgPSBPYmplY3QudmFsdWVzKHByb3BzQnlOYW1lKTtcbiAgICB0aGlzLmVtaXRJbnRlcmZhY2VCdWlsZGVyKGlmYywgSU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUUsIHByb3BzKTtcblxuICAgIC8vIFN0YXJ0IGltcGxlbWVudGF0aW9uIGNsYXNzXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnLyoqJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoYCAqIEFuIGltcGxlbWVudGF0aW9uIGZvciB7QGxpbmsgJHtpZmMubmFtZX19YCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJyAqLycpO1xuICAgIHRoaXMuZW1pdFN0YWJpbGl0eUFubm90YXRpb25zKGlmYyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoQU5OX0lOVEVSTkFMKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgYGZpbmFsIGNsYXNzICR7SU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUV9IGV4dGVuZHMgc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdCBpbXBsZW1lbnRzICR7aWZjLm5hbWV9YCxcbiAgICApO1xuXG4gICAgLy8gSW1tdXRhYmxlIHByb3BlcnRpZXNcbiAgICBwcm9wcy5mb3JFYWNoKChwcm9wKSA9PlxuICAgICAgdGhpcy5jb2RlLmxpbmUoYHByaXZhdGUgZmluYWwgJHtwcm9wLmZpZWxkSmF2YVR5cGV9ICR7cHJvcC5maWVsZE5hbWV9O2ApLFxuICAgICk7XG5cbiAgICAvLyBTdGFydCBKU0lJIHJlZmVyZW5jZSBjb25zdHJ1Y3RvclxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgJyAqIENvbnN0cnVjdG9yIHRoYXQgaW5pdGlhbGl6ZXMgdGhlIG9iamVjdCBiYXNlZCBvbiB2YWx1ZXMgcmV0cmlldmVkIGZyb20gdGhlIEpzaWlPYmplY3QuJyxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKCcgKiBAcGFyYW0gb2JqUmVmIFJlZmVyZW5jZSB0byB0aGUgSlNJSSBtYW5hZ2VkIG9iamVjdC4nKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICovJyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwcm90ZWN0ZWQgJHtJTlRFUkZBQ0VfUFJPWFlfQ0xBU1NfTkFNRX0oZmluYWwgc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdFJlZiBvYmpSZWYpYCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKCdzdXBlcihvYmpSZWYpOycpO1xuICAgIHByb3BzLmZvckVhY2goKHByb3ApID0+XG4gICAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICAgYHRoaXMuJHtwcm9wLmZpZWxkTmFtZX0gPSBzb2Z0d2FyZS5hbWF6b24uanNpaS5LZXJuZWwuZ2V0KHRoaXMsIFwiJHtwcm9wLmpzaWlOYW1lfVwiLCAke3Byb3AuZmllbGROYXRpdmVUeXBlfSk7YCxcbiAgICAgICksXG4gICAgKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIC8vIEVuZCBKU0lJIHJlZmVyZW5jZSBjb25zdHJ1Y3RvclxuXG4gICAgLy8gU3RhcnQgYnVpbGRlciBjb25zdHJ1Y3RvclxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJy8qKicpO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgJyAqIENvbnN0cnVjdG9yIHRoYXQgaW5pdGlhbGl6ZXMgdGhlIG9iamVjdCBiYXNlZCBvbiBsaXRlcmFsIHByb3BlcnR5IHZhbHVlcyBwYXNzZWQgYnkgdGhlIHtAbGluayBCdWlsZGVyfS4nLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJyAqLycpO1xuICAgIGlmIChwcm9wcy5zb21lKChwcm9wKSA9PiBwcm9wLmZpZWxkSmF2YVR5cGUgIT09IHByb3AucGFyYW1KYXZhVHlwZSkpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKCdAU3VwcHJlc3NXYXJuaW5ncyhcInVuY2hlY2tlZFwiKScpO1xuICAgIH1cbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgYHByb3RlY3RlZCAke0lOVEVSRkFDRV9QUk9YWV9DTEFTU19OQU1FfShmaW5hbCAke0JVSUxERVJfQ0xBU1NfTkFNRX0gYnVpbGRlcilgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnc3VwZXIoc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdC5Jbml0aWFsaXphdGlvbk1vZGUuSlNJSSk7JyxcbiAgICApO1xuICAgIHByb3BzLmZvckVhY2goKHByb3ApID0+IHtcbiAgICAgIGNvbnN0IGV4cGxpY2l0Q2FzdCA9XG4gICAgICAgIHByb3AuZmllbGRKYXZhVHlwZSAhPT0gcHJvcC5wYXJhbUphdmFUeXBlXG4gICAgICAgICAgPyBgKCR7cHJvcC5maWVsZEphdmFUeXBlfSlgXG4gICAgICAgICAgOiAnJztcbiAgICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgICBgdGhpcy4ke3Byb3AuZmllbGROYW1lfSA9ICR7ZXhwbGljaXRDYXN0fSR7X3ZhbGlkYXRlSWZOb25PcHRpb25hbChcbiAgICAgICAgICBgYnVpbGRlci4ke3Byb3AuZmllbGROYW1lfWAsXG4gICAgICAgICAgcHJvcCxcbiAgICAgICAgKX07YCxcbiAgICAgICk7XG4gICAgfSk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICAvLyBFbmQgbGl0ZXJhbCBjb25zdHJ1Y3RvclxuXG4gICAgLy8gR2V0dGVyc1xuICAgIHByb3BzLmZvckVhY2goKHByb3ApID0+IHtcbiAgICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgICBgcHVibGljIGZpbmFsICR7cHJvcC5maWVsZEphdmFUeXBlfSBnZXQke3Byb3AucHJvcE5hbWV9KClgLFxuICAgICAgKTtcbiAgICAgIHRoaXMuY29kZS5saW5lKGByZXR1cm4gdGhpcy4ke3Byb3AuZmllbGROYW1lfTtgKTtcbiAgICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgfSk7XG5cbiAgICAvLyBlbWl0ICRqc2lpJHRvSnNvbiB3aGljaCB3aWxsIGJlIGNhbGxlZCB0byBzZXJpYWxpemUgdGhpcyBvYmplY3Qgd2hlbiBzZW50IHRvIEpTXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoQU5OX0lOVEVSTkFMKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgJ3B1YmxpYyBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQuSnNvbk5vZGUgJGpzaWkkdG9Kc29uKCknLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnZmluYWwgY29tLmZhc3RlcnhtbC5qYWNrc29uLmRhdGFiaW5kLk9iamVjdE1hcHBlciBvbSA9IHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlPYmplY3RNYXBwZXIuSU5TVEFOQ0U7JyxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYGZpbmFsIGNvbS5mYXN0ZXJ4bWwuamFja3Nvbi5kYXRhYmluZC5ub2RlLk9iamVjdE5vZGUgZGF0YSA9IGNvbS5mYXN0ZXJ4bWwuamFja3Nvbi5kYXRhYmluZC5ub2RlLkpzb25Ob2RlRmFjdG9yeS5pbnN0YW5jZS5vYmplY3ROb2RlKCk7YCxcbiAgICApO1xuXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcHMpIHtcbiAgICAgIGlmIChwcm9wLm51bGxhYmxlKSB7XG4gICAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soYGlmICh0aGlzLmdldCR7cHJvcC5wcm9wTmFtZX0oKSAhPSBudWxsKWApO1xuICAgICAgfVxuICAgICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAgIGBkYXRhLnNldChcIiR7cHJvcC5zcGVjLm5hbWV9XCIsIG9tLnZhbHVlVG9UcmVlKHRoaXMuZ2V0JHtwcm9wLnByb3BOYW1lfSgpKSk7YCxcbiAgICAgICk7XG4gICAgICBpZiAocHJvcC5udWxsYWJsZSkge1xuICAgICAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnZmluYWwgY29tLmZhc3RlcnhtbC5qYWNrc29uLmRhdGFiaW5kLm5vZGUuT2JqZWN0Tm9kZSBzdHJ1Y3QgPSBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5Kc29uTm9kZUZhY3RvcnkuaW5zdGFuY2Uub2JqZWN0Tm9kZSgpOycsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZShgc3RydWN0LnNldChcImZxblwiLCBvbS52YWx1ZVRvVHJlZShcIiR7aWZjLmZxbn1cIikpO2ApO1xuICAgIHRoaXMuY29kZS5saW5lKCdzdHJ1Y3Quc2V0KFwiZGF0YVwiLCBkYXRhKTsnKTtcblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnZmluYWwgY29tLmZhc3RlcnhtbC5qYWNrc29uLmRhdGFiaW5kLm5vZGUuT2JqZWN0Tm9kZSBvYmogPSBjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5Kc29uTm9kZUZhY3RvcnkuaW5zdGFuY2Uub2JqZWN0Tm9kZSgpOycsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgnb2JqLnNldChcIiRqc2lpLnN0cnVjdFwiLCBzdHJ1Y3QpOycpO1xuXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgncmV0dXJuIG9iajsnKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIC8vIEVuZCAkanNpaSR0b0pzb25cblxuICAgIC8vIEdlbmVyYXRlIGVxdWFscygpIG92ZXJyaWRlXG4gICAgdGhpcy5lbWl0RXF1YWxzT3ZlcnJpZGUoaWZjLm5hbWUsIHByb3BzKTtcblxuICAgIC8vIEdlbmVyYXRlIGhhc2hDb2RlKCkgb3ZlcnJpZGVcbiAgICB0aGlzLmVtaXRIYXNoQ29kZU92ZXJyaWRlKHByb3BzKTtcblxuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgLy8gRW5kIGltcGxlbWVudGF0aW9uIGNsYXNzXG5cbiAgICBmdW5jdGlvbiBfdmFsaWRhdGVJZk5vbk9wdGlvbmFsKHZhcmlhYmxlOiBzdHJpbmcsIHByb3A6IEphdmFQcm9wKTogc3RyaW5nIHtcbiAgICAgIGlmIChwcm9wLm51bGxhYmxlKSB7XG4gICAgICAgIHJldHVybiB2YXJpYWJsZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBgamF2YS51dGlsLk9iamVjdHMucmVxdWlyZU5vbk51bGwoJHt2YXJpYWJsZX0sIFwiJHtwcm9wLmZpZWxkTmFtZX0gaXMgcmVxdWlyZWRcIilgO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZW1pdEVxdWFsc092ZXJyaWRlKGNsYXNzTmFtZTogc3RyaW5nLCBwcm9wczogSmF2YVByb3BbXSkge1xuICAgIC8vIEEgY2xhc3Mgd2l0aG91dCBwcm9wZXJ0aWVzIGRvZXMgbm90IG5lZWQgdG8gb3ZlcnJpZGUgZXF1YWxzKClcbiAgICBpZiAocHJvcHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnQE92ZXJyaWRlJyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jaygncHVibGljIGZpbmFsIGJvb2xlYW4gZXF1YWxzKGZpbmFsIE9iamVjdCBvKScpO1xuICAgIHRoaXMuY29kZS5saW5lKCdpZiAodGhpcyA9PSBvKSByZXR1cm4gdHJ1ZTsnKTtcblxuICAgIC8vIFRoaXMgd2FzIGFscmVhZHkgY2hlY2tlZCBieSBgc3VwZXIuZXF1YWxzKG8pYCwgc28gd2Ugc2tpcCBpdCBoZXJlLi4uXG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICAnaWYgKG8gPT0gbnVsbCB8fCBnZXRDbGFzcygpICE9IG8uZ2V0Q2xhc3MoKSkgcmV0dXJuIGZhbHNlOycsXG4gICAgKTtcblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgJHtjbGFzc05hbWV9LiR7SU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUV9IHRoYXQgPSAoJHtjbGFzc05hbWV9LiR7SU5URVJGQUNFX1BST1hZX0NMQVNTX05BTUV9KSBvO2AsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuXG4gICAgY29uc3QgaW5pdGlhbFByb3BzID0gcHJvcHMuc2xpY2UoMCwgcHJvcHMubGVuZ3RoIC0gMSk7XG4gICAgY29uc3QgZmluYWxQcm9wID0gcHJvcHNbcHJvcHMubGVuZ3RoIC0gMV07XG5cbiAgICBpbml0aWFsUHJvcHMuZm9yRWFjaCgocHJvcCkgPT4ge1xuICAgICAgY29uc3QgcHJlZGljYXRlID0gcHJvcC5udWxsYWJsZVxuICAgICAgICA/IGB0aGlzLiR7cHJvcC5maWVsZE5hbWV9ICE9IG51bGwgPyAhdGhpcy4ke3Byb3AuZmllbGROYW1lfS5lcXVhbHModGhhdC4ke3Byb3AuZmllbGROYW1lfSkgOiB0aGF0LiR7cHJvcC5maWVsZE5hbWV9ICE9IG51bGxgXG4gICAgICAgIDogYCEke3Byb3AuZmllbGROYW1lfS5lcXVhbHModGhhdC4ke3Byb3AuZmllbGROYW1lfSlgO1xuXG4gICAgICB0aGlzLmNvZGUubGluZShgaWYgKCR7cHJlZGljYXRlfSkgcmV0dXJuIGZhbHNlO2ApO1xuICAgIH0pO1xuXG4gICAgLy8gVGhlIGZpbmFsIChyZXR1cm5lZCBwcmVkaWNhdGUpIGlzIHRoZSBpbnZlcnNlIG9mIHRoZSBvdGhlciBvbmVzXG4gICAgY29uc3QgZmluYWxQcmVkaWNhdGUgPSBmaW5hbFByb3AubnVsbGFibGVcbiAgICAgID8gYHRoaXMuJHtmaW5hbFByb3AuZmllbGROYW1lfSAhPSBudWxsID8gdGhpcy4ke2ZpbmFsUHJvcC5maWVsZE5hbWV9LmVxdWFscyh0aGF0LiR7ZmluYWxQcm9wLmZpZWxkTmFtZX0pIDogYCArXG4gICAgICAgIGB0aGF0LiR7ZmluYWxQcm9wLmZpZWxkTmFtZX0gPT0gbnVsbGBcbiAgICAgIDogYHRoaXMuJHtmaW5hbFByb3AuZmllbGROYW1lfS5lcXVhbHModGhhdC4ke2ZpbmFsUHJvcC5maWVsZE5hbWV9KWA7XG4gICAgdGhpcy5jb2RlLmxpbmUoYHJldHVybiAke2ZpbmFsUHJlZGljYXRlfTtgKTtcblxuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gIH1cblxuICBwcml2YXRlIGVtaXRIYXNoQ29kZU92ZXJyaWRlKHByb3BzOiBKYXZhUHJvcFtdKSB7XG4gICAgLy8gQSBjbGFzcyB3aXRob3V0IHByb3BlcnRpZXMgZG9lcyBub3QgbmVlZCB0byBvdmVycmlkZSBoYXNoQ29kZSgpXG4gICAgaWYgKHByb3BzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ0BPdmVycmlkZScpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soJ3B1YmxpYyBmaW5hbCBpbnQgaGFzaENvZGUoKScpO1xuXG4gICAgY29uc3QgZmlyc3RQcm9wID0gcHJvcHNbMF07XG4gICAgY29uc3QgcmVtYWluaW5nUHJvcHMgPSBwcm9wcy5zbGljZSgxKTtcblxuICAgIHRoaXMuY29kZS5saW5lKGBpbnQgcmVzdWx0ID0gJHtfaGFzaENvZGVGb3JQcm9wKGZpcnN0UHJvcCl9O2ApO1xuICAgIHJlbWFpbmluZ1Byb3BzLmZvckVhY2goKHByb3ApID0+XG4gICAgICB0aGlzLmNvZGUubGluZShgcmVzdWx0ID0gMzEgKiByZXN1bHQgKyAoJHtfaGFzaENvZGVGb3JQcm9wKHByb3ApfSk7YCksXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgncmV0dXJuIHJlc3VsdDsnKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuXG4gICAgZnVuY3Rpb24gX2hhc2hDb2RlRm9yUHJvcChwcm9wOiBKYXZhUHJvcCkge1xuICAgICAgcmV0dXJuIHByb3AubnVsbGFibGVcbiAgICAgICAgPyBgdGhpcy4ke3Byb3AuZmllbGROYW1lfSAhPSBudWxsID8gdGhpcy4ke3Byb3AuZmllbGROYW1lfS5oYXNoQ29kZSgpIDogMGBcbiAgICAgICAgOiBgdGhpcy4ke3Byb3AuZmllbGROYW1lfS5oYXNoQ29kZSgpYDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG9wZW5GaWxlSWZOZWVkZWQodHlwZTogc3BlYy5UeXBlKSB7XG4gICAgaWYgKHRoaXMuaXNOZXN0ZWQodHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmNvZGUub3BlbkZpbGUodGhpcy50b0phdmFGaWxlUGF0aCh0aGlzLmFzc2VtYmx5LCB0eXBlKSk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgcGFja2FnZSAke3RoaXMudG9OYXRpdmVOYW1lKHRoaXMuYXNzZW1ibHksIHR5cGUpLnBhY2thZ2VOYW1lfTtgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgfVxuXG4gIHByaXZhdGUgY2xvc2VGaWxlSWZOZWVkZWQodHlwZTogc3BlYy5UeXBlKSB7XG4gICAgaWYgKHRoaXMuaXNOZXN0ZWQodHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmNsb3NlRmlsZSh0aGlzLnRvSmF2YUZpbGVQYXRoKHRoaXMuYXNzZW1ibHksIHR5cGUpKTtcbiAgfVxuXG4gIHByaXZhdGUgaXNOZXN0ZWQodHlwZTogc3BlYy5UeXBlKSB7XG4gICAgaWYgKCF0aGlzLmFzc2VtYmx5LnR5cGVzIHx8ICF0eXBlLm5hbWVzcGFjZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjb25zdCBwYXJlbnQgPSBgJHt0eXBlLmFzc2VtYmx5fS4ke3R5cGUubmFtZXNwYWNlfWA7XG4gICAgcmV0dXJuIHBhcmVudCBpbiB0aGlzLmFzc2VtYmx5LnR5cGVzO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0phdmFGaWxlUGF0aChhc3NtOiBzcGVjLkFzc2VtYmx5LCBmcW46IHN0cmluZyk6IHN0cmluZztcbiAgcHJpdmF0ZSB0b0phdmFGaWxlUGF0aChhc3NtOiBzcGVjLkFzc2VtYmx5LCB0eXBlOiBzcGVjLlR5cGUpOiBzdHJpbmc7XG4gIHByaXZhdGUgdG9KYXZhRmlsZVBhdGgoYXNzbTogc3BlYy5Bc3NlbWJseSwgd2hhdDogc3BlYy5UeXBlIHwgc3RyaW5nKSB7XG4gICAgY29uc3QgZnFuID0gdHlwZW9mIHdoYXQgPT09ICdzdHJpbmcnID8gd2hhdCA6IHdoYXQuZnFuO1xuICAgIGNvbnN0IHsgcGFja2FnZU5hbWUsIHR5cGVOYW1lcyB9ID0gdHJhbnNsYXRlRnFuKGFzc20sIGZxbik7XG5cbiAgICBpZiAodHlwZU5hbWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgdG9KYXZhRmlsZVBhdGg6ICR7ZnFufSBtdXN0IGluZGljYXRlIGEgdHlwZSwgYnV0IGRvZXNuJ3Q6ICR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgeyBwYWNrYWdlTmFtZSwgdHlwZU5hbWVzIH0sXG4gICAgICAgICl9YCxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGAke3BhdGguam9pbihcbiAgICAgICdzcmMnLFxuICAgICAgJ21haW4nLFxuICAgICAgJ2phdmEnLFxuICAgICAgLi4ucGFja2FnZU5hbWUuc3BsaXQoJy4nKSxcbiAgICAgIHR5cGVOYW1lc1swXSxcbiAgICApfS5qYXZhYDtcbiAgfVxuXG4gIHByaXZhdGUgdG9KYXZhUmVzb3VyY2VQYXRoKGFzc206IHNwZWMuQXNzZW1ibHksIGZxbjogc3RyaW5nLCBleHQgPSAnLnR4dCcpIHtcbiAgICBjb25zdCB7IHBhY2thZ2VOYW1lLCB0eXBlTmFtZSB9ID0gdGhpcy50b05hdGl2ZU5hbWUoYXNzbSwge1xuICAgICAgZnFuLFxuICAgICAga2luZDogc3BlYy5UeXBlS2luZC5DbGFzcyxcbiAgICAgIGFzc2VtYmx5OiBhc3NtLm5hbWUsXG4gICAgICBuYW1lOiBmcW4ucmVwbGFjZSgvLipcXC4oW14uXSspJC8sICckMScpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcGFydHMgPSBbXG4gICAgICAuLi5wYWNrYWdlTmFtZS5zcGxpdCgnLicpLFxuICAgICAgYCR7dHlwZU5hbWUuc3BsaXQoJy4nKVswXX0ke2V4dH1gLFxuICAgIF07XG4gICAgLy8gUmVzb3VyY2UgbmFtZXMgYXJlIC8tZGVsaW1pdGVkIHBhdGhzIChldmVuIG9uIFdpbmRvd3MgKndpbmsgd2luayopXG4gICAgY29uc3QgbmFtZSA9IHBhcnRzLmpvaW4oJy8nKTtcbiAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbignc3JjJywgJ21haW4nLCAncmVzb3VyY2VzJywgLi4ucGFydHMpO1xuXG4gICAgcmV0dXJuIHsgZmlsZVBhdGgsIG5hbWUgfTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21wbGV4aXR5XG4gIHByaXZhdGUgYWRkSmF2YURvY3MoXG4gICAgZG9jOiBzcGVjLkRvY3VtZW50YWJsZSxcbiAgICBhcGlMb2M6IEFwaUxvY2F0aW9uLFxuICAgIGRlZmF1bHRUZXh0Pzogc3RyaW5nLFxuICApIHtcbiAgICBpZiAoXG4gICAgICAhZGVmYXVsdFRleHQgJiZcbiAgICAgIE9iamVjdC5rZXlzKGRvYy5kb2NzID8/IHt9KS5sZW5ndGggPT09IDAgJiZcbiAgICAgICEoKGRvYyBhcyBzcGVjLk1ldGhvZCkucGFyYW1ldGVycyA/PyBbXSkuc29tZShcbiAgICAgICAgKHApID0+IE9iamVjdC5rZXlzKHAuZG9jcyA/PyB7fSkubGVuZ3RoICE9PSAwLFxuICAgICAgKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGRvY3MgPSAoZG9jLmRvY3MgPSBkb2MuZG9jcyA/PyB7fSk7XG5cbiAgICBjb25zdCBwYXJhcyA9IFtdO1xuXG4gICAgaWYgKGRvY3Muc3VtbWFyeSkge1xuICAgICAgcGFyYXMucHVzaChyZW5kZXJTdW1tYXJ5KGRvY3MpKTtcbiAgICB9IGVsc2UgaWYgKGRlZmF1bHRUZXh0KSB7XG4gICAgICBwYXJhcy5wdXNoKGRlZmF1bHRUZXh0KTtcbiAgICB9XG5cbiAgICBpZiAoZG9jcy5yZW1hcmtzKSB7XG4gICAgICBwYXJhcy5wdXNoKFxuICAgICAgICBtYXJrRG93blRvSmF2YURvYyhcbiAgICAgICAgICB0aGlzLmNvbnZlcnRTYW1wbGVzSW5NYXJrZG93bihkb2NzLnJlbWFya3MsIGFwaUxvYyksXG4gICAgICAgICkudHJpbVJpZ2h0KCksXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChkb2NzLmRlZmF1bHQpIHtcbiAgICAgIHBhcmFzLnB1c2goYERlZmF1bHQ6ICR7ZG9jcy5kZWZhdWx0fWApOyAvLyBOT1RFOiB0aGVyZSBpcyBubyBhbm5vdGF0aW9uIGluIEphdmFEb2MgZm9yIHRoaXNcbiAgICB9XG5cbiAgICBpZiAoZG9jcy5leGFtcGxlKSB7XG4gICAgICBwYXJhcy5wdXNoKCdFeGFtcGxlOicpO1xuXG4gICAgICBjb25zdCBjb252ZXJ0ZWRFeGFtcGxlID0gdGhpcy5jb252ZXJ0RXhhbXBsZShkb2NzLmV4YW1wbGUsIGFwaUxvYyk7XG5cbiAgICAgIC8vIFdlIHVzZWQgdG8gdXNlIHRoZSBzbGlnaHRseSBuaWNlciBgPHByZT57QGNvZGUgLi4ufTwvcHJlPmAsIHdoaWNoIGRvZXNuJ3RcbiAgICAgIC8vIHJlcXVpcmUgKGFuZCB0aGVyZWZvcmUgYWxzbyBkb2Vzbid0IGFsbG93KSBlc2NhcGluZyBzcGVjaWFsIGNoYXJhY3RlcnMuXG4gICAgICAvL1xuICAgICAgLy8gSG93ZXZlciwgY29kZSBzYW1wbGVzIG1heSBjb250YWluIGJsb2NrIHF1b3RlcyBvZiB0aGVpciBvd24gKCcqLycpIHRoYXRcbiAgICAgIC8vIHdvdWxkIHRlcm1pbmF0ZSB0aGUgYmxvY2sgY29tbWVudCBmcm9tIHRoZSBQb1Ygb2YgdGhlIEphdmEgdG9rZW5pemVyLCBhbmRcbiAgICAgIC8vIHNpbmNlIGB7QGNvZGUgLi4uIH1gIGRvZXNuJ3QgYWxsb3cgYW55IGVzY2FwaW5nLCB0aGVyZSdzIGFsc28gbm8gd2F5IHRvIGVuY29kZVxuICAgICAgLy8gJyovJyBpbiBhIHdheSB0aGF0IHdvdWxkIChhKSBoaWRlIGl0IGZyb20gdGhlIHRva2VuaXplciBhbmQgKGIpIGdpdmUgJyovJyBiYWNrXG4gICAgICAvLyBhZnRlciBwcm9jZXNzaW5nIEphdmFEb2NzLlxuICAgICAgLy9cbiAgICAgIC8vIEhlbmNlLCB3ZSBqdXN0IHJlc29ydCB0byBIVE1MLWVuY29kaW5nIGV2ZXJ5dGhpbmcgKHNhbWUgYXMgd2UgZG8gZm9yIGNvZGVcbiAgICAgIC8vIGV4YW1wbGVzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zbGF0ZWQgZnJvbSBNYXJrRG93bikuXG4gICAgICBwYXJhcy5wdXNoKFxuICAgICAgICBtYXJrRG93blRvSmF2YURvYyhbJ2BgYCcsIGNvbnZlcnRlZEV4YW1wbGUsICdgYGAnXS5qb2luKCdcXG4nKSksXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHRhZ0xpbmVzID0gW107XG5cbiAgICBpZiAoZG9jcy5yZXR1cm5zKSB7XG4gICAgICB0YWdMaW5lcy5wdXNoKGBAcmV0dXJuICR7ZG9jcy5yZXR1cm5zfWApO1xuICAgIH1cbiAgICBpZiAoZG9jcy5zZWUpIHtcbiAgICAgIHRhZ0xpbmVzLnB1c2goYEBzZWUgJHtkb2NzLnNlZX1gKTtcbiAgICB9XG4gICAgaWYgKGRvY3MuZGVwcmVjYXRlZCkge1xuICAgICAgdGFnTGluZXMucHVzaChgQGRlcHJlY2F0ZWQgJHtkb2NzLmRlcHJlY2F0ZWR9YCk7XG4gICAgfVxuXG4gICAgLy8gUGFyYW1zXG4gICAgaWYgKChkb2MgYXMgc3BlYy5NZXRob2QpLnBhcmFtZXRlcnMpIHtcbiAgICAgIGNvbnN0IG1ldGhvZCA9IGRvYyBhcyBzcGVjLk1ldGhvZDtcbiAgICAgIGlmIChtZXRob2QucGFyYW1ldGVycykge1xuICAgICAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIG1ldGhvZC5wYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgY29uc3Qgc3VtbWFyeSA9IHBhcmFtLmRvY3M/LnN1bW1hcnk7XG4gICAgICAgICAgdGFnTGluZXMucHVzaChwYXJhbUphdmFkb2MocGFyYW0ubmFtZSwgcGFyYW0ub3B0aW9uYWwsIHN1bW1hcnkpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0YWdMaW5lcy5sZW5ndGggPiAwKSB7XG4gICAgICBwYXJhcy5wdXNoKHRhZ0xpbmVzLmpvaW4oJ1xcbicpKTtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5lcyA9IG5ldyBBcnJheTxzdHJpbmc+KCk7XG4gICAgZm9yIChjb25zdCBwYXJhIG9mIHBhcmFzKSB7XG4gICAgICBpZiAobGluZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBsaW5lcy5wdXNoKCc8cD4nKTtcbiAgICAgIH1cbiAgICAgIGxpbmVzLnB1c2goLi4ucGFyYS5zcGxpdCgnXFxuJykuZmlsdGVyKChsKSA9PiBsICE9PSAnJykpO1xuICAgIH1cblxuICAgIHRoaXMuY29kZS5saW5lKCcvKionKTtcbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKGAgKiAke2xpbmV9YCk7XG4gICAgfVxuICAgIHRoaXMuY29kZS5saW5lKCcgKi8nKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2xhc3NCYXNlKGNsczogc3BlYy5DbGFzc1R5cGUpIHtcbiAgICBpZiAoIWNscy5iYXNlKSB7XG4gICAgICByZXR1cm4gJ3NvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlPYmplY3QnO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnRvSmF2YVR5cGUoeyBmcW46IGNscy5iYXNlIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0RlY29yYXRlZEphdmFUeXBlKFxuICAgIG9wdGlvbmFsVmFsdWU6IHNwZWMuT3B0aW9uYWxWYWx1ZSxcbiAgICB7IGNvdmFyaWFudCA9IGZhbHNlIH0gPSB7fSxcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLnRvRGVjb3JhdGVkSmF2YVR5cGVzKG9wdGlvbmFsVmFsdWUsIHsgY292YXJpYW50IH0pO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMSkge1xuICAgICAgcmV0dXJuIGAke1xuICAgICAgICBvcHRpb25hbFZhbHVlLm9wdGlvbmFsID8gQU5OX05VTExBQkxFIDogQU5OX05PVF9OVUxMXG4gICAgICB9IGphdmEubGFuZy5PYmplY3RgO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0WzBdO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0RlY29yYXRlZEphdmFUeXBlcyhcbiAgICBvcHRpb25hbFZhbHVlOiBzcGVjLk9wdGlvbmFsVmFsdWUsXG4gICAgeyBjb3ZhcmlhbnQgPSBmYWxzZSB9ID0ge30sXG4gICk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy50b0phdmFUeXBlcyhvcHRpb25hbFZhbHVlLnR5cGUsIHsgY292YXJpYW50IH0pLm1hcChcbiAgICAgIChuYWtlZFR5cGUpID0+XG4gICAgICAgIGAke29wdGlvbmFsVmFsdWUub3B0aW9uYWwgPyBBTk5fTlVMTEFCTEUgOiBBTk5fTk9UX05VTEx9ICR7bmFrZWRUeXBlfWAsXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9KYXZhVHlwZShcbiAgICB0eXBlOiBzcGVjLlR5cGVSZWZlcmVuY2UsXG4gICAgb3B0cz86IHsgZm9yTWFyc2hhbGxpbmc/OiBib29sZWFuOyBjb3ZhcmlhbnQ/OiBib29sZWFuIH0sXG4gICk6IHN0cmluZyB7XG4gICAgY29uc3QgdHlwZXMgPSB0aGlzLnRvSmF2YVR5cGVzKHR5cGUsIG9wdHMpO1xuICAgIGlmICh0eXBlcy5sZW5ndGggPiAxKSB7XG4gICAgICByZXR1cm4gJ2phdmEubGFuZy5PYmplY3QnO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZXNbMF07XG4gIH1cblxuICBwcml2YXRlIHRvTmF0aXZlVHlwZShcbiAgICB0eXBlOiBzcGVjLlR5cGVSZWZlcmVuY2UsXG4gICAgeyBmb3JNYXJzaGFsbGluZyA9IGZhbHNlLCBjb3ZhcmlhbnQgPSBmYWxzZSB9ID0ge30sXG4gICk6IHN0cmluZyB7XG4gICAgaWYgKHNwZWMuaXNDb2xsZWN0aW9uVHlwZVJlZmVyZW5jZSh0eXBlKSkge1xuICAgICAgY29uc3QgbmF0aXZlRWxlbWVudFR5cGUgPSB0aGlzLnRvTmF0aXZlVHlwZSh0eXBlLmNvbGxlY3Rpb24uZWxlbWVudHR5cGUsIHtcbiAgICAgICAgZm9yTWFyc2hhbGxpbmcsXG4gICAgICAgIGNvdmFyaWFudCxcbiAgICAgIH0pO1xuICAgICAgc3dpdGNoICh0eXBlLmNvbGxlY3Rpb24ua2luZCkge1xuICAgICAgICBjYXNlIHNwZWMuQ29sbGVjdGlvbktpbmQuQXJyYXk6XG4gICAgICAgICAgcmV0dXJuIGBzb2Z0d2FyZS5hbWF6b24uanNpaS5OYXRpdmVUeXBlLmxpc3RPZigke25hdGl2ZUVsZW1lbnRUeXBlfSlgO1xuICAgICAgICBjYXNlIHNwZWMuQ29sbGVjdGlvbktpbmQuTWFwOlxuICAgICAgICAgIHJldHVybiBgc29mdHdhcmUuYW1hem9uLmpzaWkuTmF0aXZlVHlwZS5tYXBPZigke25hdGl2ZUVsZW1lbnRUeXBlfSlgO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIGBVbnN1cHBvcnRlZCBjb2xsZWN0aW9uIGtpbmQ6ICR7dHlwZS5jb2xsZWN0aW9uLmtpbmQgYXMgYW55fWAsXG4gICAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGBzb2Z0d2FyZS5hbWF6b24uanNpaS5OYXRpdmVUeXBlLmZvckNsYXNzKCR7dGhpcy50b0phdmFUeXBlKHR5cGUsIHtcbiAgICAgIGZvck1hcnNoYWxsaW5nLFxuICAgICAgY292YXJpYW50LFxuICAgIH0pfS5jbGFzcylgO1xuICB9XG5cbiAgcHJpdmF0ZSB0b0phdmFUeXBlcyhcbiAgICB0eXBlcmVmOiBzcGVjLlR5cGVSZWZlcmVuY2UsXG4gICAgeyBmb3JNYXJzaGFsbGluZyA9IGZhbHNlLCBjb3ZhcmlhbnQgPSBmYWxzZSB9ID0ge30sXG4gICk6IHN0cmluZ1tdIHtcbiAgICBpZiAoc3BlYy5pc1ByaW1pdGl2ZVR5cGVSZWZlcmVuY2UodHlwZXJlZikpIHtcbiAgICAgIHJldHVybiBbdGhpcy50b0phdmFQcmltaXRpdmUodHlwZXJlZi5wcmltaXRpdmUpXTtcbiAgICB9IGVsc2UgaWYgKHNwZWMuaXNDb2xsZWN0aW9uVHlwZVJlZmVyZW5jZSh0eXBlcmVmKSkge1xuICAgICAgcmV0dXJuIFt0aGlzLnRvSmF2YUNvbGxlY3Rpb24odHlwZXJlZiwgeyBmb3JNYXJzaGFsbGluZywgY292YXJpYW50IH0pXTtcbiAgICB9IGVsc2UgaWYgKHNwZWMuaXNOYW1lZFR5cGVSZWZlcmVuY2UodHlwZXJlZikpIHtcbiAgICAgIHJldHVybiBbdGhpcy50b05hdGl2ZUZxbih0eXBlcmVmLmZxbildO1xuICAgIH0gZWxzZSBpZiAodHlwZXJlZi51bmlvbikge1xuICAgICAgY29uc3QgdHlwZXMgPSBuZXcgQXJyYXk8c3RyaW5nPigpO1xuICAgICAgZm9yIChjb25zdCBzdWJ0eXBlIG9mIHR5cGVyZWYudW5pb24udHlwZXMpIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMudG9KYXZhVHlwZXMoc3VidHlwZSwge1xuICAgICAgICAgIGZvck1hcnNoYWxsaW5nLFxuICAgICAgICAgIGNvdmFyaWFudCxcbiAgICAgICAgfSkpIHtcbiAgICAgICAgICB0eXBlcy5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHlwZXM7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0eXBlIHJlZmVyZW5jZTogJHtKU09OLnN0cmluZ2lmeSh0eXBlcmVmKX1gKTtcbiAgfVxuXG4gIHByaXZhdGUgdG9KYXZhQ29sbGVjdGlvbihcbiAgICByZWY6IHNwZWMuQ29sbGVjdGlvblR5cGVSZWZlcmVuY2UsXG4gICAge1xuICAgICAgZm9yTWFyc2hhbGxpbmcsXG4gICAgICBjb3ZhcmlhbnQsXG4gICAgfTogeyBmb3JNYXJzaGFsbGluZzogYm9vbGVhbjsgY292YXJpYW50OiBib29sZWFuIH0sXG4gICkge1xuICAgIGNvbnN0IGVsZW1lbnRKYXZhVHlwZSA9IHRoaXMudG9KYXZhVHlwZShyZWYuY29sbGVjdGlvbi5lbGVtZW50dHlwZSwge1xuICAgICAgY292YXJpYW50LFxuICAgIH0pO1xuICAgIGNvbnN0IHR5cGVDb25zdHJhaW50ID0gY292YXJpYW50XG4gICAgICA/IG1ha2VDb3ZhcmlhbnQoZWxlbWVudEphdmFUeXBlKVxuICAgICAgOiBlbGVtZW50SmF2YVR5cGU7XG4gICAgc3dpdGNoIChyZWYuY29sbGVjdGlvbi5raW5kKSB7XG4gICAgICBjYXNlIHNwZWMuQ29sbGVjdGlvbktpbmQuQXJyYXk6XG4gICAgICAgIHJldHVybiBmb3JNYXJzaGFsbGluZ1xuICAgICAgICAgID8gJ2phdmEudXRpbC5MaXN0J1xuICAgICAgICAgIDogYGphdmEudXRpbC5MaXN0PCR7dHlwZUNvbnN0cmFpbnR9PmA7XG4gICAgICBjYXNlIHNwZWMuQ29sbGVjdGlvbktpbmQuTWFwOlxuICAgICAgICByZXR1cm4gZm9yTWFyc2hhbGxpbmdcbiAgICAgICAgICA/ICdqYXZhLnV0aWwuTWFwJ1xuICAgICAgICAgIDogYGphdmEudXRpbC5NYXA8amF2YS5sYW5nLlN0cmluZywgJHt0eXBlQ29uc3RyYWludH0+YDtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgVW5zdXBwb3J0ZWQgY29sbGVjdGlvbiBraW5kOiAke3JlZi5jb2xsZWN0aW9uLmtpbmQgYXMgYW55fWAsXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFrZUNvdmFyaWFudChqYXZhVHlwZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgIC8vIERvbid0IGVtaXQgYSBjb3ZhcmlhbnQgZXhwcmVzc2lvbiBmb3IgU3RyaW5nIChpdCdzIGBmaW5hbGAgaW4gSmF2YSlcbiAgICAgIGlmIChqYXZhVHlwZSA9PT0gJ2phdmEubGFuZy5TdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBqYXZhVHlwZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBgPyBleHRlbmRzICR7amF2YVR5cGV9YDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHRvSmF2YVByaW1pdGl2ZShwcmltaXRpdmU6IHNwZWMuUHJpbWl0aXZlVHlwZSkge1xuICAgIHN3aXRjaCAocHJpbWl0aXZlKSB7XG4gICAgICBjYXNlIHNwZWMuUHJpbWl0aXZlVHlwZS5Cb29sZWFuOlxuICAgICAgICByZXR1cm4gJ2phdmEubGFuZy5Cb29sZWFuJztcbiAgICAgIGNhc2Ugc3BlYy5QcmltaXRpdmVUeXBlLkRhdGU6XG4gICAgICAgIHJldHVybiAnamF2YS50aW1lLkluc3RhbnQnO1xuICAgICAgY2FzZSBzcGVjLlByaW1pdGl2ZVR5cGUuSnNvbjpcbiAgICAgICAgcmV0dXJuICdjb20uZmFzdGVyeG1sLmphY2tzb24uZGF0YWJpbmQubm9kZS5PYmplY3ROb2RlJztcbiAgICAgIGNhc2Ugc3BlYy5QcmltaXRpdmVUeXBlLk51bWJlcjpcbiAgICAgICAgcmV0dXJuICdqYXZhLmxhbmcuTnVtYmVyJztcbiAgICAgIGNhc2Ugc3BlYy5QcmltaXRpdmVUeXBlLlN0cmluZzpcbiAgICAgICAgcmV0dXJuICdqYXZhLmxhbmcuU3RyaW5nJztcbiAgICAgIGNhc2Ugc3BlYy5QcmltaXRpdmVUeXBlLkFueTpcbiAgICAgICAgcmV0dXJuICdqYXZhLmxhbmcuT2JqZWN0JztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBwcmltaXRpdmUgdHlwZTogJHtwcmltaXRpdmUgYXMgYW55fWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyTWV0aG9kQ2FsbEFyZ3VtZW50cyhtZXRob2Q6IHNwZWMuQ2FsbGFibGUpIHtcbiAgICBpZiAoIW1ldGhvZC5wYXJhbWV0ZXJzIHx8IG1ldGhvZC5wYXJhbWV0ZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICBjb25zdCByZWd1bGFyUGFyYW1zID0gbWV0aG9kLnBhcmFtZXRlcnMuZmlsdGVyKChwKSA9PiAhcC52YXJpYWRpYyk7XG4gICAgY29uc3QgdmFsdWVzID0gcmVndWxhclBhcmFtcy5tYXAoX3JlbmRlclBhcmFtZXRlcik7XG4gICAgY29uc3QgdmFsdWVTdHIgPSBgbmV3IE9iamVjdFtdIHsgJHt2YWx1ZXMuam9pbignLCAnKX0gfWA7XG4gICAgaWYgKG1ldGhvZC52YXJpYWRpYykge1xuICAgICAgY29uc3QgdmFsdWVzU3RyZWFtID0gYGphdmEudXRpbC5BcnJheXMuPE9iamVjdD5zdHJlYW0oJHt2YWx1ZVN0cn0pYDtcblxuICAgICAgY29uc3QgbGFzdFBhcmFtID0gbWV0aG9kLnBhcmFtZXRlcnNbbWV0aG9kLnBhcmFtZXRlcnMubGVuZ3RoIC0gMV07XG4gICAgICBjb25zdCByZXN0U3RyZWFtID0gYGphdmEudXRpbC5BcnJheXMuPE9iamVjdD5zdHJlYW0oJHtsYXN0UGFyYW0ubmFtZX0pYDtcblxuICAgICAgY29uc3QgZnVsbFN0cmVhbSA9XG4gICAgICAgIHJlZ3VsYXJQYXJhbXMubGVuZ3RoID4gMFxuICAgICAgICAgID8gYGphdmEudXRpbC5zdHJlYW0uU3RyZWFtLmNvbmNhdCgke3ZhbHVlc1N0cmVhbX0sICR7cmVzdFN0cmVhbX0pYFxuICAgICAgICAgIDogcmVzdFN0cmVhbTtcbiAgICAgIHJldHVybiBgLCAke2Z1bGxTdHJlYW19LnRvQXJyYXkoT2JqZWN0W106Om5ldylgO1xuICAgIH1cbiAgICByZXR1cm4gYCwgJHt2YWx1ZVN0cn1gO1xuXG4gICAgZnVuY3Rpb24gX3JlbmRlclBhcmFtZXRlcihwYXJhbTogc3BlYy5QYXJhbWV0ZXIpIHtcbiAgICAgIGNvbnN0IHNhZmVOYW1lID0gSmF2YUdlbmVyYXRvci5zYWZlSmF2YVByb3BlcnR5TmFtZShwYXJhbS5uYW1lKTtcbiAgICAgIHJldHVybiBpc051bGxhYmxlKHBhcmFtKVxuICAgICAgICA/IHNhZmVOYW1lXG4gICAgICAgIDogYGphdmEudXRpbC5PYmplY3RzLnJlcXVpcmVOb25OdWxsKCR7c2FmZU5hbWV9LCBcIiR7c2FmZU5hbWV9IGlzIHJlcXVpcmVkXCIpYDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJlbmRlck1ldGhvZENhbGwoXG4gICAgY2xzOiBzcGVjLlR5cGVSZWZlcmVuY2UsXG4gICAgbWV0aG9kOiBzcGVjLk1ldGhvZCxcbiAgICBhc3luYzogYm9vbGVhbixcbiAgKSB7XG4gICAgbGV0IHN0YXRlbWVudCA9ICcnO1xuXG4gICAgaWYgKG1ldGhvZC5zdGF0aWMpIHtcbiAgICAgIGNvbnN0IGphdmFDbGFzcyA9IHRoaXMudG9KYXZhVHlwZShjbHMpO1xuICAgICAgc3RhdGVtZW50ICs9IGBzb2Z0d2FyZS5hbWF6b24uanNpaS5Kc2lpT2JqZWN0LmpzaWlTdGF0aWNDYWxsKCR7amF2YUNsYXNzfS5jbGFzcywgYDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdGVtZW50ICs9IGBzb2Z0d2FyZS5hbWF6b24uanNpaS5LZXJuZWwuJHtcbiAgICAgICAgYXN5bmMgPyAnYXN5bmNDYWxsJyA6ICdjYWxsJ1xuICAgICAgfSh0aGlzLCBgO1xuICAgIH1cblxuICAgIHN0YXRlbWVudCArPSBgXCIke21ldGhvZC5uYW1lfVwiYDtcblxuICAgIGlmIChtZXRob2QucmV0dXJucykge1xuICAgICAgc3RhdGVtZW50ICs9IGAsICR7dGhpcy50b05hdGl2ZVR5cGUobWV0aG9kLnJldHVybnMudHlwZSwge1xuICAgICAgICBmb3JNYXJzaGFsbGluZzogdHJ1ZSxcbiAgICAgIH0pfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXRlbWVudCArPSAnLCBzb2Z0d2FyZS5hbWF6b24uanNpaS5OYXRpdmVUeXBlLlZPSUQnO1xuICAgIH1cbiAgICBzdGF0ZW1lbnQgKz0gYCR7dGhpcy5yZW5kZXJNZXRob2RDYWxsQXJndW1lbnRzKG1ldGhvZCl9KWA7XG5cbiAgICBpZiAobWV0aG9kLnJldHVybnMpIHtcbiAgICAgIHN0YXRlbWVudCA9IHRoaXMud3JhcENvbGxlY3Rpb24oXG4gICAgICAgIHN0YXRlbWVudCxcbiAgICAgICAgbWV0aG9kLnJldHVybnMudHlwZSxcbiAgICAgICAgbWV0aG9kLnJldHVybnMub3B0aW9uYWwsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChtZXRob2QucmV0dXJucykge1xuICAgICAgcmV0dXJuIGByZXR1cm4gJHtzdGF0ZW1lbnR9O2A7XG4gICAgfVxuICAgIHJldHVybiBgJHtzdGF0ZW1lbnR9O2A7XG4gIH1cblxuICAvKipcbiAgICogV3JhcHMgYSBjb2xsZWN0aW9uIGludG8gYW4gdW5tb2RpZmlhYmxlIGNvbGxlY3Rpb24gZWxzZSByZXR1cm5zIHRoZSBleGlzdGluZyBzdGF0ZW1lbnQuXG4gICAqIEBwYXJhbSBzdGF0ZW1lbnQgVGhlIHN0YXRlbWVudCB0byB3cmFwIGlmIG5lY2Vzc2FyeS5cbiAgICogQHBhcmFtIHR5cGUgVGhlIHR5cGUgb2YgdGhlIG9iamVjdCB0byB3cmFwLlxuICAgKiBAcGFyYW0gb3B0aW9uYWwgV2hldGhlciB0aGUgdmFsdWUgaXMgb3B0aW9uYWwgKGNhbiBiZSBudWxsL3VuZGVmaW5lZCkgb3Igbm90LlxuICAgKiBAcmV0dXJucyBUaGUgbW9kaWZpZWQgb3Igb3JpZ2luYWwgc3RhdGVtZW50LlxuICAgKi9cbiAgcHJpdmF0ZSB3cmFwQ29sbGVjdGlvbihcbiAgICBzdGF0ZW1lbnQ6IHN0cmluZyxcbiAgICB0eXBlOiBzcGVjLlR5cGVSZWZlcmVuY2UsXG4gICAgb3B0aW9uYWw/OiBib29sZWFuLFxuICApOiBzdHJpbmcge1xuICAgIGlmIChzcGVjLmlzQ29sbGVjdGlvblR5cGVSZWZlcmVuY2UodHlwZSkpIHtcbiAgICAgIGxldCB3cmFwcGVyOiBzdHJpbmc7XG4gICAgICBzd2l0Y2ggKHR5cGUuY29sbGVjdGlvbi5raW5kKSB7XG4gICAgICAgIGNhc2Ugc3BlYy5Db2xsZWN0aW9uS2luZC5BcnJheTpcbiAgICAgICAgICB3cmFwcGVyID0gJ3VubW9kaWZpYWJsZUxpc3QnO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIHNwZWMuQ29sbGVjdGlvbktpbmQuTWFwOlxuICAgICAgICAgIHdyYXBwZXIgPSAndW5tb2RpZmlhYmxlTWFwJztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBgVW5zdXBwb3J0ZWQgY29sbGVjdGlvbiBraW5kOiAke3R5cGUuY29sbGVjdGlvbi5raW5kIGFzIGFueX1gLFxuICAgICAgICAgICk7XG4gICAgICB9XG4gICAgICAvLyBJbiB0aGUgY2FzZSBvZiBcIm9wdGlvbmFsXCIsIHRoZSB2YWx1ZSBuZWVkcyBvdCBiZSBleHBsaWNpdGx5IGNhc3QgdG8gYWxsb3cgZm9yIGNhc2VzIHdoZXJlIHRoZSByYXcgdHlwZSB3YXMgcmV0dXJuZWQuXG4gICAgICByZXR1cm4gb3B0aW9uYWxcbiAgICAgICAgPyBgamF2YS51dGlsLk9wdGlvbmFsLm9mTnVsbGFibGUoKCR7dGhpcy50b0phdmFUeXBlKFxuICAgICAgICAgICAgdHlwZSxcbiAgICAgICAgICApfSkoJHtzdGF0ZW1lbnR9KSkubWFwKGphdmEudXRpbC5Db2xsZWN0aW9uczo6JHt3cmFwcGVyfSkub3JFbHNlKG51bGwpYFxuICAgICAgICA6IGBqYXZhLnV0aWwuQ29sbGVjdGlvbnMuJHt3cmFwcGVyfSgke3N0YXRlbWVudH0pYDtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdGVtZW50O1xuICB9XG5cbiAgcHJpdmF0ZSByZW5kZXJNZXRob2RQYXJhbWV0ZXJzKG1ldGhvZDogc3BlYy5DYWxsYWJsZSkge1xuICAgIGNvbnN0IHBhcmFtcyA9IFtdO1xuICAgIGlmIChtZXRob2QucGFyYW1ldGVycykge1xuICAgICAgZm9yIChjb25zdCBwIG9mIG1ldGhvZC5wYXJhbWV0ZXJzKSB7XG4gICAgICAgIC8vIFdlIGNhbiByZW5kZXIgY292YXJpYW50IHBhcmFtZXRlcnMgb25seSBmb3IgbWV0aG9kcyB0aGF0IGFyZW4ndCBvdmVycmlkYWJsZS4uLiBzbyBvbmx5IGZvciBzdGF0aWMgbWV0aG9kcyBjdXJyZW50bHkuXG4gICAgICAgIHBhcmFtcy5wdXNoKFxuICAgICAgICAgIGBmaW5hbCAke3RoaXMudG9EZWNvcmF0ZWRKYXZhVHlwZShwLCB7XG4gICAgICAgICAgICBjb3ZhcmlhbnQ6IChtZXRob2QgYXMgc3BlYy5NZXRob2QpLnN0YXRpYyxcbiAgICAgICAgICB9KX0ke3AudmFyaWFkaWMgPyAnLi4uJyA6ICcnfSAke0phdmFHZW5lcmF0b3Iuc2FmZUphdmFQcm9wZXJ0eU5hbWUoXG4gICAgICAgICAgICBwLm5hbWUsXG4gICAgICAgICAgKX1gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcGFyYW1zLmpvaW4oJywgJyk7XG4gIH1cblxuICBwcml2YXRlIHJlbmRlckFjY2Vzc0xldmVsKG1ldGhvZDogc3BlYy5DYWxsYWJsZSB8IHNwZWMuUHJvcGVydHkpIHtcbiAgICByZXR1cm4gbWV0aG9kLnByb3RlY3RlZCA/ICdwcm90ZWN0ZWQnIDogJ3B1YmxpYyc7XG4gIH1cblxuICBwcml2YXRlIG1ha2VNb2R1bGVDbGFzcyhtb2R1bGVOYW1lOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYCR7dGhpcy50b05hdGl2ZUZxbihtb2R1bGVOYW1lKX0uJHtNT0RVTEVfQ0xBU1NfTkFNRX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBlbWl0TW9kdWxlRmlsZShtb2Q6IHNwZWMuQXNzZW1ibHkpIHtcbiAgICBjb25zdCBtb2R1bGVOYW1lID0gbW9kLm5hbWU7XG4gICAgY29uc3QgbW9kdWxlQ2xhc3MgPSB0aGlzLm1ha2VNb2R1bGVDbGFzcyhtb2R1bGVOYW1lKTtcblxuICAgIGNvbnN0IHsgZmlsZVBhdGg6IG1vZHVsZVJlc0ZpbGUsIG5hbWU6IG1vZHVsZVJlc05hbWUgfSA9XG4gICAgICB0aGlzLnRvSmF2YVJlc291cmNlUGF0aChtb2QsIGAke21vZC5uYW1lfS4ke01PRFVMRV9DTEFTU19OQU1FfWApO1xuICAgIHRoaXMuY29kZS5vcGVuRmlsZShtb2R1bGVSZXNGaWxlKTtcbiAgICBmb3IgKGNvbnN0IGZxbiBvZiBPYmplY3Qua2V5cyh0aGlzLmFzc2VtYmx5LnR5cGVzID8/IHt9KSkge1xuICAgICAgdGhpcy5jb2RlLmxpbmUoYCR7ZnFufT0ke3RoaXMudG9OYXRpdmVGcW4oZnFuLCB7IGJpbmFyeU5hbWU6IHRydWUgfSl9YCk7XG4gICAgfVxuICAgIHRoaXMuY29kZS5jbG9zZUZpbGUobW9kdWxlUmVzRmlsZSk7XG5cbiAgICBjb25zdCBtb2R1bGVGaWxlID0gdGhpcy50b0phdmFGaWxlUGF0aChtb2QsIHtcbiAgICAgIGFzc2VtYmx5OiBtb2QubmFtZSxcbiAgICAgIGZxbjogYCR7bW9kLm5hbWV9LiR7TU9EVUxFX0NMQVNTX05BTUV9YCxcbiAgICAgIGtpbmQ6IHNwZWMuVHlwZUtpbmQuQ2xhc3MsXG4gICAgICBuYW1lOiBNT0RVTEVfQ0xBU1NfTkFNRSxcbiAgICB9KTtcblxuICAgIHRoaXMuY29kZS5vcGVuRmlsZShtb2R1bGVGaWxlKTtcbiAgICB0aGlzLmNvZGUubGluZShgcGFja2FnZSAke3RoaXMudG9OYXRpdmVOYW1lKG1vZCkucGFja2FnZU5hbWV9O2ApO1xuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgaWYgKE9iamVjdC5rZXlzKG1vZC5kZXBlbmRlbmNpZXMgPz8ge30pLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuY29kZS5saW5lKCdpbXBvcnQgc3RhdGljIGphdmEudXRpbC5BcnJheXMuYXNMaXN0OycpO1xuICAgICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB9XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ltcG9ydCBqYXZhLmlvLkJ1ZmZlcmVkUmVhZGVyOycpO1xuICAgIHRoaXMuY29kZS5saW5lKCdpbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbTsnKTtcbiAgICB0aGlzLmNvZGUubGluZSgnaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW1SZWFkZXI7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOycpO1xuICAgIHRoaXMuY29kZS5saW5lKCdpbXBvcnQgamF2YS5pby5SZWFkZXI7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ltcG9ydCBqYXZhLmlvLlVuY2hlY2tlZElPRXhjZXB0aW9uOycpO1xuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ltcG9ydCBqYXZhLm5pby5jaGFyc2V0LlN0YW5kYXJkQ2hhcnNldHM7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOycpO1xuICAgIGlmIChPYmplY3Qua2V5cyhtb2QuZGVwZW5kZW5jaWVzID8/IHt9KS5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmNvZGUubGluZSgnaW1wb3J0IGphdmEudXRpbC5MaXN0OycpO1xuICAgIH1cbiAgICB0aGlzLmNvZGUubGluZSgnaW1wb3J0IGphdmEudXRpbC5NYXA7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICB0aGlzLmNvZGUubGluZSgnaW1wb3J0IHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlNb2R1bGU7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcblxuICAgIHRoaXMuY29kZS5saW5lKEFOTl9JTlRFUk5BTCk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwdWJsaWMgZmluYWwgY2xhc3MgJHtNT0RVTEVfQ0xBU1NfTkFNRX0gZXh0ZW5kcyBKc2lpTW9kdWxlYCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgJ3ByaXZhdGUgc3RhdGljIGZpbmFsIE1hcDxTdHJpbmcsIFN0cmluZz4gTU9EVUxFX1RZUEVTID0gbG9hZCgpOycsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuXG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jaygncHJpdmF0ZSBzdGF0aWMgTWFwPFN0cmluZywgU3RyaW5nPiBsb2FkKCknKTtcbiAgICB0aGlzLmNvZGUubGluZSgnZmluYWwgTWFwPFN0cmluZywgU3RyaW5nPiByZXN1bHQgPSBuZXcgSGFzaE1hcDw+KCk7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoXG4gICAgICBgZmluYWwgQ2xhc3NMb2FkZXIgY2wgPSAke01PRFVMRV9DTEFTU19OQU1FfS5jbGFzcy5nZXRDbGFzc0xvYWRlcigpO2AsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGB0cnkgKGZpbmFsIElucHV0U3RyZWFtIGlzID0gY2wuZ2V0UmVzb3VyY2VBc1N0cmVhbShcIiR7bW9kdWxlUmVzTmFtZX1cIik7YCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgJyAgICAgZmluYWwgUmVhZGVyIHJkID0gbmV3IElucHV0U3RyZWFtUmVhZGVyKGlzLCBTdGFuZGFyZENoYXJzZXRzLlVURl84KTsnLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgICcgICAgIGZpbmFsIEJ1ZmZlcmVkUmVhZGVyIGJyID0gbmV3IEJ1ZmZlcmVkUmVhZGVyKHJkKSknLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2JyLmxpbmVzKCknKTtcbiAgICB0aGlzLmNvZGUubGluZSgnICAuZmlsdGVyKGxpbmUgLT4gIWxpbmUudHJpbSgpLmlzRW1wdHkoKSknKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKCcgIC5mb3JFYWNoKGxpbmUgLT4gJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ZpbmFsIFN0cmluZ1tdIHBhcnRzID0gbGluZS5zcGxpdChcIj1cIiwgMik7Jyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ2ZpbmFsIFN0cmluZyBmcW4gPSBwYXJ0c1swXTsnKTtcbiAgICB0aGlzLmNvZGUubGluZSgnZmluYWwgU3RyaW5nIGNsYXNzTmFtZSA9IHBhcnRzWzFdOycpO1xuICAgIHRoaXMuY29kZS5saW5lKCdyZXN1bHQucHV0KGZxbiwgY2xhc3NOYW1lKTsnKTtcbiAgICB0aGlzLmNvZGUudW5pbmRlbnQoJ30pOycpOyAvLyBQcm94eSBmb3IgY2xvc2VCbG9ja1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jaygnY2F0Y2ggKGZpbmFsIElPRXhjZXB0aW9uIGV4Y2VwdGlvbiknKTtcbiAgICB0aGlzLmNvZGUubGluZSgndGhyb3cgbmV3IFVuY2hlY2tlZElPRXhjZXB0aW9uKGV4Y2VwdGlvbik7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB0aGlzLmNvZGUubGluZSgncmV0dXJuIHJlc3VsdDsnKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIHRoaXMuY29kZS5saW5lKCk7XG5cbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICdwcml2YXRlIGZpbmFsIE1hcDxTdHJpbmcsIENsYXNzPD8+PiBjYWNoZSA9IG5ldyBIYXNoTWFwPD4oKTsnLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoKTtcblxuICAgIC8vIGN0b3JcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKGBwdWJsaWMgJHtNT0RVTEVfQ0xBU1NfTkFNRX0oKWApO1xuICAgIHRoaXMuY29kZS5saW5lKFxuICAgICAgYHN1cGVyKFwiJHttb2R1bGVOYW1lfVwiLCBcIiR7XG4gICAgICAgIG1vZC52ZXJzaW9uXG4gICAgICB9XCIsICR7TU9EVUxFX0NMQVNTX05BTUV9LmNsYXNzLCBcIiR7dGhpcy5nZXRBc3NlbWJseUZpbGVOYW1lKCl9XCIpO2AsXG4gICAgKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpOyAvLyBjdG9yXG5cbiAgICAvLyBkZXBlbmRlbmNpZXNcbiAgICBpZiAobW9kLmRlcGVuZGVuY2llcyAmJiBPYmplY3Qua2V5cyhtb2QuZGVwZW5kZW5jaWVzKS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBkZXBzID0gW107XG4gICAgICBmb3IgKGNvbnN0IGRlcCBvZiBPYmplY3Qua2V5cyhtb2QuZGVwZW5kZW5jaWVzKSkge1xuICAgICAgICBkZXBzLnB1c2goYCR7dGhpcy5tYWtlTW9kdWxlQ2xhc3MoZGVwKX0uY2xhc3NgKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jb2RlLmxpbmUoKTtcbiAgICAgIHRoaXMuY29kZS5saW5lKCdAT3ZlcnJpZGUnKTtcbiAgICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICAgICdwdWJsaWMgTGlzdDxDbGFzczw/IGV4dGVuZHMgSnNpaU1vZHVsZT4+IGdldERlcGVuZGVuY2llcygpJyxcbiAgICAgICk7XG4gICAgICB0aGlzLmNvZGUubGluZShgcmV0dXJuIGFzTGlzdCgke2RlcHMuam9pbignLCAnKX0pO2ApO1xuICAgICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5saW5lKCdAT3ZlcnJpZGUnKTtcbiAgICB0aGlzLmNvZGUub3BlbkJsb2NrKFxuICAgICAgJ3Byb3RlY3RlZCBDbGFzczw/PiByZXNvbHZlQ2xhc3MoZmluYWwgU3RyaW5nIGZxbikgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNlcHRpb24nLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jaygnaWYgKCFNT0RVTEVfVFlQRVMuY29udGFpbnNLZXkoZnFuKSknKTtcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgICd0aHJvdyBuZXcgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbihcIlVua25vd24gSlNJSSB0eXBlOiBcIiArIGZxbik7JyxcbiAgICApO1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ1N0cmluZyBjbGFzc05hbWUgPSBNT0RVTEVfVFlQRVMuZ2V0KGZxbik7Jyk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jaygnaWYgKCF0aGlzLmNhY2hlLmNvbnRhaW5zS2V5KGNsYXNzTmFtZSkpJyk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ3RoaXMuY2FjaGUucHV0KGNsYXNzTmFtZSwgdGhpcy5maW5kQ2xhc3MoY2xhc3NOYW1lKSk7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB0aGlzLmNvZGUubGluZSgncmV0dXJuIHRoaXMuY2FjaGUuZ2V0KGNsYXNzTmFtZSk7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soJ3ByaXZhdGUgQ2xhc3M8Pz4gZmluZENsYXNzKGZpbmFsIFN0cmluZyBiaW5hcnlOYW1lKScpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soJ3RyeScpO1xuICAgIHRoaXMuY29kZS5saW5lKCdyZXR1cm4gQ2xhc3MuZm9yTmFtZShiaW5hcnlOYW1lKTsnKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soJ2NhdGNoIChmaW5hbCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIGV4Y2VwdGlvbiknKTtcbiAgICB0aGlzLmNvZGUubGluZSgndGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXhjZXB0aW9uKTsnKTtcbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG5cbiAgICB0aGlzLmNvZGUuY2xvc2VCbG9jaygpO1xuXG4gICAgdGhpcy5jb2RlLmNsb3NlRmlsZShtb2R1bGVGaWxlKTtcblxuICAgIHJldHVybiBtb2R1bGVDbGFzcztcbiAgfVxuXG4gIHByaXZhdGUgZW1pdEpzaWlJbml0aWFsaXplcnMoY2xzOiBzcGVjLkNsYXNzVHlwZSkge1xuICAgIHRoaXMuY29kZS5saW5lKCk7XG4gICAgdGhpcy5jb2RlLm9wZW5CbG9jayhcbiAgICAgIGBwcm90ZWN0ZWQgJHtjbHMubmFtZX0oZmluYWwgc29mdHdhcmUuYW1hem9uLmpzaWkuSnNpaU9iamVjdFJlZiBvYmpSZWYpYCxcbiAgICApO1xuICAgIHRoaXMuY29kZS5saW5lKCdzdXBlcihvYmpSZWYpOycpO1xuICAgIHRoaXMuY29kZS5jbG9zZUJsb2NrKCk7XG5cbiAgICB0aGlzLmNvZGUubGluZSgpO1xuICAgIHRoaXMuY29kZS5vcGVuQmxvY2soXG4gICAgICBgcHJvdGVjdGVkICR7Y2xzLm5hbWV9KGZpbmFsIHNvZnR3YXJlLmFtYXpvbi5qc2lpLkpzaWlPYmplY3QuSW5pdGlhbGl6YXRpb25Nb2RlIGluaXRpYWxpemF0aW9uTW9kZSlgLFxuICAgICk7XG4gICAgdGhpcy5jb2RlLmxpbmUoJ3N1cGVyKGluaXRpYWxpemF0aW9uTW9kZSk7Jyk7XG4gICAgdGhpcy5jb2RlLmNsb3NlQmxvY2soKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlcyB0aGUgamF2YSBGUU4gZm9yIGEgSlNJSSBGUU46XG4gICAqIDEuIERldGVybWluZSB3aGljaCBhc3NlbWJseSB0aGUgRlFOIGJlbG9uZ3MgdG8gKGZpcnN0IGNvbXBvbmVudCBvZiB0aGUgRlFOKVxuICAgKiAyLiBMb2NhdGUgdGhlIGB0YXJnZXRzLmphdmEucGFja2FnZWAgdmFsdWUgZm9yIHRoYXQgYXNzZW1ibHkgKHRoaXMgYXNzZW1ibHksIG9yIG9uZSBvZiB0aGUgZGVwZW5kZW5jaWVzKVxuICAgKiAzLiBSZXR1cm4gdGhlIGphdmEgRlFOOiBgYDxtb2R1bGUudGFyZ2V0cy5qYXZhLnBhY2thZ2U+LjxGUU4gc3RpcHBlZCBvZiBmaXJzdCBjb21wb25lbnQ+YGBcbiAgICpcbiAgICogUmVjb3JkcyBhbiBhc3NlbWJseSByZWZlcmVuY2UgaWYgdGhlIHJlZmVyZW5jZWQgRlFOIGNvbWVzIGZyb20gYSBkaWZmZXJlbnQgYXNzZW1ibHkuXG4gICAqXG4gICAqIEBwYXJhbSBmcW4gdGhlIEpTSUkgRlFOIHRvIGJlIHVzZWQuXG4gICAqXG4gICAqIEByZXR1cm5zIHRoZSBjb3JyZXNwb25kaW5nIEphdmEgRlFOLlxuICAgKlxuICAgKiBAdGhyb3dzIGlmIHRoZSBhc3NlbWJseSB0aGUgRlFOIGJlbG9uZ3MgdG8gZG9lcyBub3QgaGF2ZSBhIGB0YXJnZXRzLmphdmEucGFja2FnZWAgc2V0LlxuICAgKi9cbiAgcHJpdmF0ZSB0b05hdGl2ZUZxbihcbiAgICBmcW46IHN0cmluZyxcbiAgICB7IGJpbmFyeU5hbWUgfTogeyBiaW5hcnlOYW1lOiBib29sZWFuIH0gPSB7IGJpbmFyeU5hbWU6IGZhbHNlIH0sXG4gICk6IHN0cmluZyB7XG4gICAgY29uc3QgW21vZF0gPSBmcW4uc3BsaXQoJy4nKTtcbiAgICBjb25zdCBkZXBNb2QgPSB0aGlzLmZpbmRNb2R1bGUobW9kKTtcbiAgICAvLyBNYWtlIHN1cmUgYW55IGRlcGVuZGVuY3kgKGRpcmVjdCBvciB0cmFuc2l0aXZlKSBvZiB3aGljaCBhbnkgdHlwZSBpcyBleHBsaWNpdGx5IHJlZmVyZW5jZWQgYnkgdGhlIGdlbmVyYXRlZFxuICAgIC8vIGNvZGUgaXMgaW5jbHVkZWQgaW4gdGhlIGdlbmVyYXRlZCBQT00ncyBkZXBlbmRlbmNpZXMgc2VjdGlvbiAocHJvdGVjdGluZyB0aGUgYXJ0aWZhY3QgZnJvbSBjaGFuZ2VzIGluIHRoZVxuICAgIC8vIGRlcGVuZGVuY2llcycgZGVwZW5kZW5jeSBzdHJ1Y3R1cmUpLlxuICAgIGlmIChtb2QgIT09IHRoaXMuYXNzZW1ibHkubmFtZSkge1xuICAgICAgdGhpcy5yZWZlcmVuY2VkTW9kdWxlc1ttb2RdID0gZGVwTW9kO1xuXG4gICAgICBjb25zdCB0cmFuc2xhdGVkID0gdHJhbnNsYXRlRnFuKHsgLi4uZGVwTW9kLCBuYW1lOiBtb2QgfSwgZnFuKTtcbiAgICAgIHJldHVybiBbdHJhbnNsYXRlZC5wYWNrYWdlTmFtZSwgLi4udHJhbnNsYXRlZC50eXBlTmFtZXNdLmpvaW4oJy4nKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHBhY2thZ2VOYW1lLCB0eXBlTmFtZSB9ID1cbiAgICAgIGZxbiA9PT0gdGhpcy5hc3NlbWJseS5uYW1lXG4gICAgICAgID8gdGhpcy50b05hdGl2ZU5hbWUodGhpcy5hc3NlbWJseSlcbiAgICAgICAgOiB0aGlzLnRvTmF0aXZlTmFtZSh0aGlzLmFzc2VtYmx5LCB0aGlzLmFzc2VtYmx5LnR5cGVzIVtmcW5dKTtcbiAgICBjb25zdCBjbGFzc05hbWUgPVxuICAgICAgdHlwZU5hbWUgJiYgYmluYXJ5TmFtZSA/IHR5cGVOYW1lLnJlcGxhY2UoJy4nLCAnJCcpIDogdHlwZU5hbWU7XG4gICAgcmV0dXJuIGAke3BhY2thZ2VOYW1lfSR7Y2xhc3NOYW1lID8gYC4ke2NsYXNzTmFtZX1gIDogJyd9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlcyBKYXZhIG5hbWUgZm9yIGEganNpaSBhc3NlbWJseSBvciB0eXBlLlxuICAgKlxuICAgKiBAcGFyYW0gYXNzbSBUaGUgYXNzZW1ibHkgdGhhdCBjb250YWlucyB0aGUgdHlwZVxuICAgKiBAcGFyYW0gdHlwZSBUaGUgdHlwZSB3ZSB3YW50IHRoZSBuYW1lIG9mXG4gICAqL1xuICBwcml2YXRlIHRvTmF0aXZlTmFtZShhc3NtOiBzcGVjLkFzc2VtYmx5KToge1xuICAgIHBhY2thZ2VOYW1lOiBzdHJpbmc7XG4gICAgdHlwZU5hbWU6IHVuZGVmaW5lZDtcbiAgfTtcbiAgcHJpdmF0ZSB0b05hdGl2ZU5hbWUoXG4gICAgYXNzbTogc3BlYy5Bc3NlbWJseSxcbiAgICB0eXBlOiBzcGVjLlR5cGUsXG4gICk6IHsgcGFja2FnZU5hbWU6IHN0cmluZzsgdHlwZU5hbWU6IHN0cmluZyB9O1xuICBwcml2YXRlIHRvTmF0aXZlTmFtZShcbiAgICBhc3NtOiBzcGVjLkFzc2VtYmx5LFxuICAgIHR5cGU/OiBzcGVjLlR5cGUsXG4gICk6IHsgcGFja2FnZU5hbWU6IHN0cmluZzsgdHlwZU5hbWU/OiBzdHJpbmcgfSB7XG4gICAgaWYgKCF0eXBlKSB7XG4gICAgICByZXR1cm4geyBwYWNrYWdlTmFtZTogcGFja2FnZU5hbWVGcm9tQXNzZW1ibHkoYXNzbSkgfTtcbiAgICB9XG5cbiAgICBjb25zdCB0cmFuc2xhdGVkID0gdHJhbnNsYXRlRnFuKGFzc20sIHR5cGUuZnFuKTtcbiAgICByZXR1cm4ge1xuICAgICAgcGFja2FnZU5hbWU6IHRyYW5zbGF0ZWQucGFja2FnZU5hbWUsXG4gICAgICB0eXBlTmFtZTogdHJhbnNsYXRlZC50eXBlTmFtZXMuam9pbignLicpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRW1pdHMgYW4gYGBAR2VuZXJhdGVkYGAgYW5ub3RhdGlvbiBob25vcmluZyB0aGUgYGB0aGlzLmVtaXRGdWxsR2VuZXJhdG9ySW5mb2BgIHNldHRpbmcuXG4gICAqL1xuICBwcml2YXRlIGVtaXRHZW5lcmF0ZWRBbm5vdGF0aW9uKCkge1xuICAgIGNvbnN0IGRhdGUgPSB0aGlzLmVtaXRGdWxsR2VuZXJhdG9ySW5mb1xuICAgICAgPyBgLCBkYXRlID0gXCIke25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1cImBcbiAgICAgIDogJyc7XG4gICAgY29uc3QgZ2VuZXJhdG9yID0gdGhpcy5lbWl0RnVsbEdlbmVyYXRvckluZm9cbiAgICAgID8gYGpzaWktcGFjbWFrLyR7VkVSU0lPTl9ERVNDfWBcbiAgICAgIDogJ2pzaWktcGFjbWFrJztcbiAgICB0aGlzLmNvZGUubGluZShcbiAgICAgIGBAamF2YXguYW5ub3RhdGlvbi5HZW5lcmF0ZWQodmFsdWUgPSBcIiR7Z2VuZXJhdG9yfVwiJHtkYXRlfSlgLFxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGNvbnZlcnRFeGFtcGxlKGV4YW1wbGU6IHN0cmluZywgYXBpOiBBcGlMb2NhdGlvbik6IHN0cmluZyB7XG4gICAgY29uc3QgdHJhbnNsYXRlZCA9IHRoaXMucm9zZXR0YS50cmFuc2xhdGVFeGFtcGxlKFxuICAgICAgYXBpLFxuICAgICAgZXhhbXBsZSxcbiAgICAgIFRhcmdldExhbmd1YWdlLkpBVkEsXG4gICAgICBlbmZvcmNlc1N0cmljdE1vZGUodGhpcy5hc3NlbWJseSksXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5wcmVmaXhEaXNjbGFpbWVyKHRyYW5zbGF0ZWQpO1xuICB9XG5cbiAgcHJpdmF0ZSBjb252ZXJ0U2FtcGxlc0luTWFya2Rvd24obWFya2Rvd246IHN0cmluZywgYXBpOiBBcGlMb2NhdGlvbik6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucm9zZXR0YS50cmFuc2xhdGVTbmlwcGV0c0luTWFya2Rvd24oXG4gICAgICBhcGksXG4gICAgICBtYXJrZG93bixcbiAgICAgIFRhcmdldExhbmd1YWdlLkpBVkEsXG4gICAgICBlbmZvcmNlc1N0cmljdE1vZGUodGhpcy5hc3NlbWJseSksXG4gICAgICAodHJhbnMpID0+ICh7XG4gICAgICAgIGxhbmd1YWdlOiB0cmFucy5sYW5ndWFnZSxcbiAgICAgICAgc291cmNlOiB0aGlzLnByZWZpeERpc2NsYWltZXIodHJhbnMpLFxuICAgICAgfSksXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgcHJlZml4RGlzY2xhaW1lcih0cmFuc2xhdGVkOiBUcmFuc2xhdGlvbikge1xuICAgIGlmICghdHJhbnNsYXRlZC5kaWRDb21waWxlICYmIElOQ09NUExFVEVfRElTQ0xBSU1FUl9OT05DT01QSUxJTkcpIHtcbiAgICAgIHJldHVybiBgLy8gJHtJTkNPTVBMRVRFX0RJU0NMQUlNRVJfTk9OQ09NUElMSU5HfVxcbiR7dHJhbnNsYXRlZC5zb3VyY2V9YDtcbiAgICB9XG4gICAgcmV0dXJuIHRyYW5zbGF0ZWQuc291cmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbnMgdGhlIEphdmEgRlFOIG9mIHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGludGVyZmFjZXMgdGhhdCBzaG91bGQgYmUgaW1wbGVtZW50ZWQgd2hlbiBhIG5ld1xuICAgKiBkZWZhdWx0IGludGVyZmFjZSBvciBwcm94eSBjbGFzcyBpcyBiZWluZyBlbWl0dGVkLlxuICAgKlxuICAgKiBAcGFyYW0gdHlwZSB0aGUgdHlwZSBmb3Igd2hpY2ggYSBkZWZhdWx0IGludGVyZmFjZSBvciBwcm94eSBpcyBlbWl0dGVkLlxuICAgKiBAcGFyYW0gaW5jbHVkZVRoaXNUeXBlIHdoZXRoZXIgdGhpcyBjbGFzcydzIGRlZmF1bHQgaW50ZXJmYWNlIHNob3VsZCBiZSBpbmNsdWRlZCBvciBub3QuXG4gICAqXG4gICAqIEByZXR1cm5zIGEgbGlzdCBvZiBKYXZhIGZ1bGx5IHF1YWxpZmllZCBjbGFzcyBuYW1lcy5cbiAgICovXG4gIHByaXZhdGUgZGVmYXVsdEludGVyZmFjZXNGb3IoXG4gICAgdHlwZTogcmVmbGVjdC5DbGFzc1R5cGUgfCByZWZsZWN0LkludGVyZmFjZVR5cGUsXG4gICAgeyBpbmNsdWRlVGhpc1R5cGUgPSBmYWxzZSB9OiB7IGluY2x1ZGVUaGlzVHlwZT86IGJvb2xlYW4gfSA9IHt9LFxuICApOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICBpZiAoXG4gICAgICBpbmNsdWRlVGhpc1R5cGUgJiZcbiAgICAgIGhhc0RlZmF1bHRJbnRlcmZhY2VzKHR5cGUuYXNzZW1ibHkpICYmXG4gICAgICB0eXBlLmlzSW50ZXJmYWNlVHlwZSgpXG4gICAgKSB7XG4gICAgICByZXN1bHQuYWRkKFxuICAgICAgICBgJHt0aGlzLnRvTmF0aXZlRnFuKHR5cGUuZnFuKX0uJHtJTlRFUkZBQ0VfREVGQVVMVF9DTEFTU19OQU1FfWAsXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IGlmYWNlIG9mIHR5cGUuaW50ZXJmYWNlcykge1xuICAgICAgICBpZiAoaGFzRGVmYXVsdEludGVyZmFjZXMoaWZhY2UuYXNzZW1ibHkpKSB7XG4gICAgICAgICAgcmVzdWx0LmFkZChcbiAgICAgICAgICAgIGAke3RoaXMudG9OYXRpdmVGcW4oaWZhY2UuZnFuKX0uJHtJTlRFUkZBQ0VfREVGQVVMVF9DTEFTU19OQU1FfWAsXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5kZWZhdWx0SW50ZXJmYWNlc0ZvcihpZmFjZSkpIHtcbiAgICAgICAgICAgIHJlc3VsdC5hZGQoaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodHlwZS5pc0NsYXNzVHlwZSgpICYmIHR5cGUuYmFzZSAhPSBudWxsKSB7XG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLmRlZmF1bHRJbnRlcmZhY2VzRm9yKHR5cGUuYmFzZSkpIHtcbiAgICAgICAgICByZXN1bHQuYWRkKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIEFycmF5LmZyb20ocmVzdWx0KTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgbW9kZWxzIHRoZSBQT00gc2NoZW1hIGZvciBhIDxkZXBlbmRlbmN5PiBlbnRpdHlcbiAqIEBzZWUgaHR0cHM6Ly9tYXZlbi5hcGFjaGUub3JnL3BvbS5odG1sI0RlcGVuZGVuY2llc1xuICovXG5pbnRlcmZhY2UgTWF2ZW5EZXBlbmRlbmN5IHtcbiAgZ3JvdXBJZDogc3RyaW5nO1xuICBhcnRpZmFjdElkOiBzdHJpbmc7XG4gIHZlcnNpb246IHN0cmluZztcblxuICB0eXBlPzogc3RyaW5nO1xuICBzY29wZT86ICdjb21waWxlJyB8ICdwcm92aWRlZCcgfCAncnVudGltZScgfCAndGVzdCcgfCAnc3lzdGVtJztcbiAgc3lzdGVtUGF0aD86IHN0cmluZztcbiAgb3B0aW9uYWw/OiBib29sZWFuO1xuXG4gICcjY29tbWVudCc/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogTG9va3MgdXAgdGhlIGBAanNpaS9qYXZhLXJ1bnRpbWVgIHBhY2thZ2UgZnJvbSB0aGUgbG9jYWwgcmVwb3NpdG9yeS5cbiAqIElmIGl0IGNvbnRhaW5zIGEgXCJtYXZlbi1yZXBvXCIgZGlyZWN0b3J5LCBpdCB3aWxsIGJlIGFkZGVkIGFzIGEgbG9jYWwgbWF2ZW4gcmVwb1xuICogc28gd2hlbiB3ZSBidWlsZCBsb2NhbGx5LCB3ZSBidWlsZCBhZ2FpbnN0IGl0IGFuZCBub3QgYWdhaW5zdCB0aGUgb25lIHB1Ymxpc2hlZFxuICogdG8gTWF2ZW4gQ2VudHJhbC5cbiAqL1xuZnVuY3Rpb24gZmluZEphdmFSdW50aW1lTG9jYWxSZXBvc2l0b3J5KCkge1xuICB0cnkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdmFyLXJlcXVpcmVzLEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsaW1wb3J0L25vLWV4dHJhbmVvdXMtZGVwZW5kZW5jaWVzXG4gICAgY29uc3QgamF2YVJ1bnRpbWUgPSByZXF1aXJlKCdAanNpaS9qYXZhLXJ1bnRpbWUnKTtcbiAgICBsb2dnaW5nLmluZm8oXG4gICAgICBgVXNpbmcgbG9jYWwgdmVyc2lvbiBvZiB0aGUgSmF2YSBqc2lpIHJ1bnRpbWUgcGFja2FnZSBhdDogJHtqYXZhUnVudGltZS5yZXBvc2l0b3J5fWAsXG4gICAgKTtcbiAgICByZXR1cm4gamF2YVJ1bnRpbWUucmVwb3NpdG9yeTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc051bGxhYmxlKG9wdGlvbmFsVmFsdWU6IHNwZWMuT3B0aW9uYWxWYWx1ZSB8IHVuZGVmaW5lZCk6IGJvb2xlYW4ge1xuICBpZiAoIW9wdGlvbmFsVmFsdWUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIChcbiAgICBvcHRpb25hbFZhbHVlLm9wdGlvbmFsIHx8XG4gICAgKHNwZWMuaXNQcmltaXRpdmVUeXBlUmVmZXJlbmNlKG9wdGlvbmFsVmFsdWUudHlwZSkgJiZcbiAgICAgIG9wdGlvbmFsVmFsdWUudHlwZS5wcmltaXRpdmUgPT09IHNwZWMuUHJpbWl0aXZlVHlwZS5BbnkpXG4gICk7XG59XG5cbmZ1bmN0aW9uIHBhcmFtSmF2YWRvYyhcbiAgbmFtZTogc3RyaW5nLFxuICBvcHRpb25hbD86IGJvb2xlYW4sXG4gIHN1bW1hcnk/OiBzdHJpbmcsXG4pOiBzdHJpbmcge1xuICBjb25zdCBwYXJ0cyA9IFsnQHBhcmFtJywgbmFtZV07XG4gIGlmIChzdW1tYXJ5KSB7XG4gICAgcGFydHMucHVzaChlbmRXaXRoUGVyaW9kKHN1bW1hcnkpKTtcbiAgfVxuICBpZiAoIW9wdGlvbmFsKSB7XG4gICAgcGFydHMucHVzaCgnVGhpcyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuJyk7XG4gIH1cblxuICByZXR1cm4gcGFydHMuam9pbignICcpO1xufVxuXG5mdW5jdGlvbiBlbmRXaXRoUGVyaW9kKHM6IHN0cmluZyk6IHN0cmluZyB7XG4gIHMgPSBzLnRyaW1SaWdodCgpO1xuICBpZiAoIXMuZW5kc1dpdGgoJy4nKSkge1xuICAgIHJldHVybiBgJHtzfS5gO1xuICB9XG4gIHJldHVybiBzO1xufVxuXG5mdW5jdGlvbiBjb21wdXRlT3ZlcnJpZGVzPFQgZXh0ZW5kcyB7IHBhcmFtOiBzcGVjLlBhcmFtZXRlciB9PihcbiAgYWxsUGFyYW1zOiBUW10sXG4pOiBJdGVyYWJsZTxUW10+IHtcbiAgcmV0dXJuIHtcbiAgICBbU3ltYm9sLml0ZXJhdG9yXTogZnVuY3Rpb24qICgpIHtcbiAgICAgIHlpZWxkIGFsbFBhcmFtcztcbiAgICAgIHdoaWxlIChhbGxQYXJhbXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBsYXN0UGFyYW0gPSBhbGxQYXJhbXNbYWxsUGFyYW1zLmxlbmd0aCAtIDFdO1xuICAgICAgICBpZiAoIWxhc3RQYXJhbS5wYXJhbS52YXJpYWRpYyAmJiAhbGFzdFBhcmFtLnBhcmFtLm9wdGlvbmFsKSB7XG4gICAgICAgICAgLy8gTmVpdGhlciB2YXJpYWRpYyBub3Igb3B0aW9uYWwgLS0gd2UncmUgZG9uZSBoZXJlIVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBhbGxQYXJhbXMgPSBhbGxQYXJhbXMuc2xpY2UoMCwgYWxsUGFyYW1zLmxlbmd0aCAtIDEpO1xuICAgICAgICAvLyBJZiB0aGUgbGFzdFBhcmFtIHdhcyB2YXJpYWRpYywgd2Ugc2hvdWxkbid0IGdlbmVyYXRlIGFuIG92ZXJyaWRlIHdpdGhvdXQgaXQgb25seS5cbiAgICAgICAgaWYgKGxhc3RQYXJhbS5wYXJhbS5vcHRpb25hbCkge1xuICAgICAgICAgIHlpZWxkIGFsbFBhcmFtcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gIH07XG59XG5cbnR5cGUgQXNzZW1ibHlMaWtlID0gc3BlYy5Bc3NlbWJseUNvbmZpZ3VyYXRpb24gJiB7IG5hbWU6IHN0cmluZyB9O1xuXG4vKipcbiAqIFJldHVybiB0aGUgbmF0aXZlIHBhY2thZ2UgbmFtZSBmcm9tIGFuIGFzc2VtYmx5XG4gKi9cbmZ1bmN0aW9uIHBhY2thZ2VOYW1lRnJvbUFzc2VtYmx5KGFzc206IEFzc2VtYmx5TGlrZSkge1xuICBjb25zdCBqYXZhUGFja2FnZSA9IGFzc20udGFyZ2V0cz8uamF2YT8ucGFja2FnZTtcbiAgaWYgKCFqYXZhUGFja2FnZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBUaGUgbW9kdWxlICR7YXNzbS5uYW1lfSBkb2VzIG5vdCBoYXZlIGEgamF2YS5wYWNrYWdlIHNldHRpbmdgLFxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGphdmFQYWNrYWdlO1xufVxuXG4vKipcbiAqIEFuYWx5emVzIGFuZCB0cmFuc2xhdGVzIGEganNpaSBGUU4gdG8gSmF2YSBjb21wb25lbnRzXG4gKlxuICogVGhlIEZRTiBjYW4gYmUgb2YgdGhlIGFzc2VtYmx5LCBhIHN1Ym1vZHVsZSwgb3IgYSB0eXBlLlxuICpcbiAqIEFueSB0eXBlIGNhbiBoYXZlIHRoZSBmb2xsb3dpbmcgY2hhcmFjdGVyaXN0aWNzOlxuICpcbiAqIC0gTG9jYXRlZCBpbiB6ZXJvIG9yIG1vcmUgbmVzdGVkIHN1Ym1vZHVsZXMuIEFueSBvZiB0aGVzZSBjYW4gaGF2ZSBhIEphdmFcbiAqICAgcGFja2FnZSBuYW1lIGFzc2lnbmVkLS1pZiBub25lLCB0aGUgbmFtZSBpcyBhdXRvbWF0aWNhbGx5IGRldGVybWluZWQgYnlcbiAqICAgc25ha2UgY2FzaW5nLiBBdCBsZWFzdCB0aGUgYXNzZW1ibHkgbXVzdCBoYXZlIGEgSmF2YSBwYWNrYWdlIG5hbWUgYXNzaWduZWQuXG4gKiAtIExvY2F0ZWQgaW4gemVybyBvciBtb3JlIG5lc3RlZCB0eXBlcyAoY2xhc3NlcykuXG4gKlxuICogRmluZCB1cCB0aGUgc2V0IG9mIG5hbWVzcGFjZXMgdW50aWwgd2UgZmluZCBhIHN1Ym1vZHVsZSAob3IgdGhlIGFzc2VtYmx5XG4gKiBpdHNlbGYpIHRoYXQgaGFzIGFuIGV4cGxpY2l0IEphdmEgcGFja2FnZSBuYW1lIGRlZmluZWQuXG4gKlxuICogQXBwZW5kIGFsbCB0aGUgbmFtZXNwYWNlcyB0aGF0IHdlIGNyb3NzZWQgdGhhdCBkaWRuJ3QgaGF2ZSBhIHBhY2thZ2UgbmFtZSBkZWZpbmVkLlxuICpcbiAqIFJldHVybnMgdGhlIEphdmEgcGFja2FnZSBuYW1lIGRldGVybWluZWQgdGhpcyB3YXksIGFzIHdlbGwgYXMgdGhlIGhpZXJhcmNoeSBvZiB0eXBlXG4gKiBuYW1lcyBpbnNpZGUgdGhlIHBhY2thZ2UuIGB0eXBlTmFtZXNgIG1heSBiZSBtaXNzaW5nIG9yIGVtcHR5IGlmIHRoZSBGUU4gaW5kaWNhdGVkXG4gKiB0aGUgYXNzZW1ibHkgb3IgYSBzdWJtb2R1bGUsIGNvbnRhaW5zIDEgZWxlbWVudCBpZiB0aGUgRlFOIGluZGljYXRlZCBhIHRvcC1sZXZlbCB0eXBlLFxuICogbXVsdGlwbGUgZWxlbWVudHMgaWYgdGhlIEZRTiBpbmRpY2F0ZWQgYSBuZXN0ZWQgdHlwZS5cbiAqL1xuZnVuY3Rpb24gdHJhbnNsYXRlRnFuKFxuICBhc3NtOiBBc3NlbWJseUxpa2UsXG4gIG9yaWdpbmFsRnFuOiBzdHJpbmcsXG4pOiB7IHBhY2thZ2VOYW1lOiBzdHJpbmc7IHR5cGVOYW1lczogc3RyaW5nW10gfSB7XG4gIGNvbnN0IGltcGxpY2l0UGFja2FnZU5hbWVzID0gbmV3IEFycmF5PHN0cmluZz4oKTtcbiAgY29uc3QgdHlwZU5hbWVzID0gbmV3IEFycmF5PHN0cmluZz4oKTtcblxuICAvLyBXZSB3b3JrIG91cnNlbHZlcyB1cHdhcmQgdGhyb3VnaCB0aGUgRlFOIHVudGlsIHdlJ3ZlIGZvdW5kIGFuIGV4cGxpY2l0IHBhY2thZ2VcbiAgbGV0IHBhY2thZ2VOYW1lID0gcGFja2FnZU5hbWVGcm9tQXNzZW1ibHkoYXNzbSk7XG4gIGxldCBmcW4gPSBvcmlnaW5hbEZxbjtcbiAgd2hpbGUgKGZxbiAhPT0gJycgJiYgZnFuICE9PSBhc3NtLm5hbWUpIHtcbiAgICBjb25zdCBbcGFyZW50RnFuLCBsYXN0UGFydF0gPSBzcGxpdE5hbWVzcGFjZShmcW4pO1xuXG4gICAgY29uc3Qgc3VibW9kdWxlID0gYXNzbS5zdWJtb2R1bGVzPy5bZnFuXTtcbiAgICBpZiAoc3VibW9kdWxlKSB7XG4gICAgICBjb25zdCBleHBsaWNpdFBhY2thZ2UgPSBzdWJtb2R1bGUudGFyZ2V0cz8uamF2YT8ucGFja2FnZTtcbiAgICAgIGlmIChleHBsaWNpdFBhY2thZ2UpIHtcbiAgICAgICAgcGFja2FnZU5hbWUgPSBleHBsaWNpdFBhY2thZ2U7XG4gICAgICAgIC8vIFdlIGNhbiBzdG9wIHJlY3Vyc2luZywgdHlwZXMgY2Fubm90IGJlIHRoZSBwYXJlbnQgb2YgYSBtb2R1bGUgYW5kIG5vdGhpbmcgdXB3YXJkcyBjYW4gY2hhbmdlXG4gICAgICAgIC8vIHRoZSBwYWNrYWdlIG5hbWUgYW55bW9yZVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGltcGxpY2l0UGFja2FnZU5hbWVzLnVuc2hpZnQoYC4ke3RvU25ha2VDYXNlKGxhc3RQYXJ0KX1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgaXQncyBub3QgYSBzdWJtb2R1bGUsIGl0IG11c3QgYmUgYSB0eXBlLlxuICAgICAgdHlwZU5hbWVzLnVuc2hpZnQobGFzdFBhcnQpO1xuICAgIH1cblxuICAgIGZxbiA9IHBhcmVudEZxbjtcbiAgfVxuICBpZiAoZnFuID09PSAnJykge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgJyR7b3JpZ2luYWxGcW59JyBpbnNpZGUgJyR7YXNzbS5uYW1lfSdgKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHBhY2thZ2VOYW1lOiBgJHtwYWNrYWdlTmFtZX0ke2ltcGxpY2l0UGFja2FnZU5hbWVzLmpvaW4oJycpfWAsXG4gICAgdHlwZU5hbWVzLFxuICB9O1xufVxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciB0aGUgcHJvdmlkZWQgYXNzZW1ibHkgZXhwb3NlcyB0aGUgXCJoYXNEZWZhdWx0SW50ZXJmYWNlc1wiXG4gKiBqc2lpLXBhY21hayBmZWF0dXJlIGZsYWcuXG4gKlxuICogQHBhcmFtIGFzc2VtYmx5IHRoZSBhc3NlbWJseSB0aGF0IGlzIHRlc3RlZFxuICpcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIEpzaWkkRGVmYXVsdCBpbnRlcmZhY2VzIGNhbiBiZSB1c2VkXG4gKi9cbmZ1bmN0aW9uIGhhc0RlZmF1bHRJbnRlcmZhY2VzKGFzc2VtYmx5OiByZWZsZWN0LkFzc2VtYmx5KTogYm9vbGVhbiB7XG4gIHJldHVybiAhIWFzc2VtYmx5Lm1ldGFkYXRhPy5qc2lpPy5wYWNtYWs/Lmhhc0RlZmF1bHRJbnRlcmZhY2VzO1xufVxuXG4vKipcbiAqIFdoZWNrcyB3aGV0aGVyIGEgbmFtZSBjb3JyZXNwb25kcyB0byBhIG1ldGhvZCBvbiBgamF2YS5sYW5nLk9iamVjdGAuIEl0IGlzIG5vdFxuICogcG9zc2libGUgdG8gZW1pdCBkZWZhdWx0IGludGVyZmFjZSBpbXBsZW1lbnRhdGlvbiBmb3IgdGhvc2UgbmFtZXMgYmVjYXVzZVxuICogdGhlc2Ugd291bGQgYWx3YXlzIGJlIHJlcGxhY2VkIGJ5IHRoZSBpbXBsZW1lbnRhdGlvbnMgb24gYE9iamVjdGAuXG4gKlxuICogQHBhcmFtIG5hbWUgdGhlIGNoZWNrZWQgbmFtZVxuICpcbiAqIEByZXR1cm5zIGB0cnVlYCBpZiBhIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gY2Fubm90IGJlIGdlbmVyYXRlZCBmb3IgdGhpcyBuYW1lLlxuICovXG5mdW5jdGlvbiBpc0phdmFMYW5nT2JqZWN0TWV0aG9kTmFtZShuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIEpBVkFfTEFOR19PQkpFQ1RfTUVUSE9EX05BTUVTLmhhcyhuYW1lKTtcbn1cbmNvbnN0IEpBVkFfTEFOR19PQkpFQ1RfTUVUSE9EX05BTUVTID0gbmV3IFNldChbXG4gICdjbG9uZScsXG4gICdlcXVhbHMnLFxuICAnZmluYWxpemUnLFxuICAnZ2V0Q2xhc3MnLFxuICAnaGFzaENvZGUnLFxuICAnbm90aWZ5JyxcbiAgJ25vdGlmeUFsbCcsXG4gICd0b1N0cmluZycsXG4gICd3YWl0Jyxcbl0pO1xuXG4vKipcbiAqIEluIGEgZG90dGVkIHN0cmluZywgc3RyaXAgb2ZmIHRoZSBsYXN0IGRvdHRlZCBjb21wb25lbnRcbiAqL1xuZnVuY3Rpb24gc3BsaXROYW1lc3BhY2UobnM6IHN0cmluZyk6IFtzdHJpbmcsIHN0cmluZ10ge1xuICBjb25zdCBkb3QgPSBucy5sYXN0SW5kZXhPZignLicpO1xuICBpZiAoZG90ID09PSAtMSkge1xuICAgIHJldHVybiBbJycsIG5zXTtcbiAgfVxuICByZXR1cm4gW25zLnN1YnN0cigwLCBkb3QpLCBucy5zdWJzdHIoZG90ICsgMSldO1xufVxuIl19